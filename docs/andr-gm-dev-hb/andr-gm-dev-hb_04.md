# 第四章。行业中的 Android 开发风格和标准

在 Android 中没有书面规则或指导来编写代码，除了语法语法。然而，全球大多数开发人员都遵循一些基本的编写 Android 代码的风格和标准。Android 基于 Java，因此大多数样式遵循 Java 标准。

在 Android 游戏开发方面，应遵循一些设计风格。它们不涵盖游戏设计，而更多是技术设计。这些样式和标准指示了适当的项目结构，类结构和文件夹/文件管理。

典型的游戏设计还涉及在 Android 平台上工作时遵循一些规则。在行业中，游戏设计方面遵循了一些风格。

在本章中，我们将通过以下主题查看这些风格和标准：

+   Android 编程结构

+   游戏编程规范

+   技术设计标准

+   游戏设计标准

+   其他风格和标准

+   不同的开发引擎有不同的风格

+   行业最佳实践

# Android 编程结构

Android 风格或建议并不是明确的编程规则。然而，良好的编程实践总是包括一套规则。在 Android 中编码，代码结构遵循 Android 基本结构和层次结构。

Android 通常遵循 Java 的标准和风格。因此，Android 编程结构基本上是 Java 结构，遵循面向对象的风格。

## 类形成

Java 类格式应保持一致，并遵循 Javadoc 规则；标准结构应遵循以下顺序：

1.  版权信息

1.  许可信息

1.  包声明

1.  库导入

1.  类描述和目的

1.  类定义

1.  全局变量

1.  构造函数

1.  方法

这是版权和许可信息格式：

```kt
/*
* Copyright (C) <year> authority
* 
* <License information and other details>
*/
```

这是类和方法描述格式：

```kt
/*
* <Description>
* <Purpose>
*/
```

## 调用层次结构

与编码风格一样，没有定义的调用层次结构。然而，在 Android 游戏中，大多数开发人员遵循基本方法。在这种方法中，项目结构主要有三种类：

+   管理器和控制器

+   关联

+   实用类

游戏需要管理器和控制器来实施游戏规则和法规。它还用于控制游戏元素和状态的行为。大多数游戏包括多个部分或屏幕，例如菜单，级别选择，游戏玩法等。

这些部分可以称为状态，其中使用的元素称为关联。关联可能是独立的类。实用类基本上通过提供预定义功能来支持开发，例如游戏声音实现，记录存储管理，常用工具，网络连接等：

！[调用层次结构]（img/B05069_04_01.jpg）

调用层次结构

在游戏循环中，主 Android 游戏线程循环将控制权交给主游戏管理器。主游戏管理器负责将线程和渲染控制传递给所需的状态管理器。主游戏管理器还负责根据当前线程的初始化和销毁状态管理器。此外，主游戏管理器在整个游戏周期内都是活动的，并管理主游戏活动。

状态管理器负责管理状态（主菜单，级别选择，游戏中等）和所有所需的关联类。状态管理器将调用传递给相应的关联类以执行特定任务。

实用类可以从层次结构中的任何层访问，具体取决于要求。

这是一个通用的架构，不是强制性的。许多开发人员以不同的方式设计调用层次结构。一切都很好，游戏流程也在不牺牲类/数据安全的情况下正常运行。

# 游戏编程规范

游戏程序员与其他软件程序员并没有太大的不同。然而，游戏编程需要比软件编程更强的逻辑能力。游戏设计感也是不同的。

游戏是一个互动娱乐系统。软件或应用程序旨在减少人类的实时计算任务。因此，很明显游戏的目的与软件或应用程序非常不同。

这就是为什么游戏编程必须遵循一些规范和协议。

游戏编程可以分为以下几个类别：

+   游戏性编程

+   图形编程

+   技术编程

## 游戏性编程

这是游戏部门最相关的编程。游戏性编程需要强大的逻辑、数学和分析能力。还需要一定的游戏设计感。游戏性编程包括人工智能、用户控制、物理、显示控制等等。

游戏程序员是与最负责任的设计师打交道的人，用于原型游戏。

## 图形编程

所有的视觉效果和影响都是由图形程序员制作的。他们负责游戏的视觉质量。在游戏运行时，有很大的空间来操纵图形资产。

图形编程就是要充分利用 GPU。如今，大多数游戏都是图形密集型的。最新的设备有独立、强大的 GPU 来支持高负荷的图形。

现代游戏展现出优质的图形显示。所有新的 3D 实时光照、粒子系统效果、视觉动态效果等完全依赖于图形程序员。挑战在于提高视觉质量而不影响游戏性能。

大部分时间，游戏性能会因为大量艺术资产处理而显著下降，这绝不是期望的情况。着色器或图形程序员必须在质量和性能之间取得平衡。

当游戏在不同平台上移植时，这通常是有效的。正如我们之前讨论过的，Android 上运行着一系列硬件平台，具有广泛的硬件规格。这种移植需要单独的着色器和资产。着色器程序指示图形处理器以特定方式渲染每个像素。

## 技术编程

这部分编程与游戏没有太多关系；然而，它确保了游戏的性能。除了性能外，网络管理、插件开发、优化等也是技术编程的一部分。以下是技术编程可能涉及的领域的列表：

+   声音编程

+   网络编程

+   游戏工具编程

+   研究和开发编程

### 声音编程

如今，声音是游戏的必要部分。一些游戏甚至是围绕音乐制作的。因此，声音编程已成为游戏编程的一部分。声音程序员主要具有数字信号处理的知识。声音程序员必须与声音设计师合作。

现代游戏使用 3D 音响系统。声音编程在不影响性能的情况下发挥着传递高质量声音的关键作用。

### 网络编程

老式游戏大多是为了在单个实例上运行。大部分时间，游戏不会与其他实例通信，因此在那个时候并不需要太多的网络编程。现代是网络时代；仅有一个实例是不够的。多人游戏如今非常普遍；即使是独立游戏也会与其他游戏实例通信，只是为了社交和货币化。

网络编程负责网络延迟、数据包优化、连接处理和维护通信。网络程序员还负责管理客户端-服务器通信和创建架构。

一些游戏在服务器上运行。客户端充当服务器上运行的游戏实例的显示设备。交易遵循实时同步。少数游戏甚至采用异步通信。网络编程确保了这种架构中的平稳和适当的过渡。

### 游戏工具编程

游戏开发离不开某些工具的支持。工具程序员可以让其他开发人员的生活变得天堂或地狱。适当的游戏工具编程可以极大地简化开发过程。开发工具的帮助可以节省大量时间和精力。

我们已经讨论了一些开发工具。然而，并不是所有的工具都必须与游戏无关。可能有一些工具是特定于游戏的。例如，可以制作一个工具来生成游戏中需要使用的数据库。

### 研究和开发编程

这种编程不是主要用于制作游戏。相反，这种编程有助于使游戏变得更好，并找到用于即将推出的游戏的新技术。

这种类型的编程需要对技术理解、硬件平台和本地开发具有强大的技能。程序员应该具有本地语言和汇编或硬件级语言的知识。

在 Android 游戏开发的情况下，研究程序员被指派探索新的 Android 设备以及新的功能和规格。然后，这些程序员尝试发现如何在游戏中以最佳方式使用这些功能。

这种编程完全负责具有各种传感器（如重力、光线、加速计等）使用等功能的游戏。最近在 Android 设备上开发虚拟现实就是这种实验的一个实际例子。

# 技术设计标准

大多数情况下，游戏开发围绕游戏设计展开；然而，开发过程受技术设计控制。技术设计考虑了实际游戏设计和需求的实时可行性的每一个可能方面。

技术设计包含以下部分：

+   游戏分析

+   设计模式和流程图

+   技术规范

+   工具和其他要求

+   资源分析

+   测试要求

+   范围分析

+   风险分析

+   变更日志

## 游戏分析

技术设计的这一部分彻底分析了游戏设计，并找出了技术在其中发挥重要作用的部分。游戏逻辑开发不是本节的一部分。然而，当游戏逻辑需要硬件依赖时，技术设计也会被考虑在内。

许多开发人员和组织在制定游戏设计后，开始实际开发过程之前制定技术设计文档的习惯。这有助于定义时间表并预测即将出现的挑战，以及可能的解决方案。

## 设计模式和流程图

本部分设计了游戏的类图和层次结构。游戏的流程图和服务器-客户端架构（如果需要）也在这里定义。

游戏技术设计的这一部分为开发人员提供了即将到来的开发的清晰图景。技术设计文档的这一部分应清楚地声明游戏模块的每一部分、程序结构、调用层次结构、第三方工具集成、数据库连接和服务器调用管理。

这样的图表视觉展示，展示流程图，总是任何开发过程的一个良好开端。

## 技术规范

技术规范指定了开发平台、目标设备集和目标操作系统。它还可能提到开发项目所需的硬件系统和软件。

在实际开发之前，这种识别是必不可少的。任何软件要运行，都需要一个能够支持软件的硬件平台。开发人员必须了解目标设备，并必须提供这些设备进行单元测试。任何额外的需求也在技术设计的这一部分中得到确认。

因此，基本上，这个规范有两个不同的部分。第一个是指定游戏指定运行的目标系统。第二个是根据设计确定创建游戏所需的系统。

## 工具和其他需求

技术设计中的这一部分涉及额外的工具和系统需求。在许多情况下，这一部分包含在技术规范中。然而，这部分有不同的目的。

这可能需要开发一个新的工具来进行实际的游戏开发。因此，工具程序员被引用到这一部分。Android 游戏开发并不在这一部分的范围之外。尽管大多数工具已经为 Android 开发准备就绪，但一些情况可能也需要一个特定于游戏的工具。在这种情况下，工具设计和单独的技术设计以及工具的使用在本节中提到。

## 资源分析

资源分析是关于人员依赖、人员技能水平、技术依赖和其他资源依赖的报告。这有助于估计项目成本并决定开发时间表。

## 测试需求

这是技术设计的另一个重要部分。测试是游戏开发过程中不可或缺的一部分。技术设计应该定义测试程序以及定义的测试用例。

游戏开发负责人确定了测试的阶段及其需求。测试工具可能在本节中声明。我们已经在前一章中提到了测试工具。在某些情况下，可能需要定制工具。

测试需求有四个主要部分：

+   测试资源需求

+   测试工具需求

+   测试用例

+   测试时间线

## 范围分析

每个游戏都有一个预定义的有限范围。特别是在 Android 设备上，种类最多，需要定义范围。在所有 Android 平台上以相同设计运行游戏几乎是不可能的。

技术设计的这一部分指示了游戏的可能范围。这可能确定运行游戏所需的最低配置、推荐配置和目标配置，以使游戏在最大性能下运行。

游戏范围定义了硬件平台的最小和最大范围。大多数开发人员喜欢将游戏设计范围最小化，以针对最大的硬件设备。技术设计文件是开发人员获取游戏性能范围的良好参考。

## 风险分析

在生产开始之前制作技术设计文件，因此有许多领域必须事先假定。这显然增加了项目的风险。然而，清楚地了解风险总是有助于开发人员在实际问题发生时找到解决方案。

这就是为什么风险分析对于任何技术设计标准都是强制性的原因。风险可以在不同领域进行分析。

在开发游戏时，技术需求或游戏设计可能会发生变化。因此，应该计算风险以适应这些变化，而不影响主要项目流程。

技术发展迅速。因此，在风险分析部分，技术变化也应该得到解决。在游戏开发的常见情况下，技术可能在开发过程中发生变化，以提高游戏质量。

## 变更日志

变更日志是包含技术文件从第一稿开始的所有变更的列表，根据日期和版本号进行排序。这有助于跟踪游戏的演变。

# 游戏设计标准

游戏设计几乎在游戏行业的每个组织中都有记录。这是几乎所有开发人员经常使用的标准之一。有时会跳过技术设计，以节省时间，一些设计师会在游戏设计中包含来自技术文件中最需要的部分。然而，这种方法是不推荐的。

维护标准游戏设计的基本方法包括以下部分：

+   游戏概述

+   游戏玩法细节

+   游戏进展

+   故事板和游戏元素

+   关卡设计

+   人工智能

+   艺术风格

+   技术参考

+   变更日志

## 游戏概述

这一部分定义了游戏的性质以及目标受众。这一部分包含了关于游戏概念，玩法和外观的简要介绍。工作标题在之前提到。

游戏概述基本上是对即将制作的游戏的几乎所有方面的简要介绍。这一部分可能展示了市场研究，以支持所选择的游戏概念和类型。

## 游戏玩法细节

游戏玩法控制和控制游戏玩法的首选用户界面在这一部分中被定义。这是游戏中最重要的部分之一。游戏玩法应该针对其所针对的每个硬件平台进行优化。游戏可能部署到手机，平板电脑和游戏机上。因此，出于明显的原因，为不同的控制方案定义了不同的控制方案。

## 游戏进展

游戏进展定义了游戏的生命周期及其随时间的演变。游戏是一个动态的娱乐系统。因此，用户在任何时候都不能感到无聊，这一部分负责用户留存。

## 故事板和游戏元素

游戏设计的这一部分定义了游戏概念的背景。这并不意味着有一个真实基于故事的游戏背景。然而，每个游戏都必须有一些元素或对象，围绕这些元素或对象进行游戏。

例如，一个横向滚动的奔跑游戏将有一个角色，一些障碍，环境物体等。它们被称为游戏元素。奔跑的原因是背景故事。

举个例子，让我们假设一个井字棋游戏。背景故事并不是必要的；然而，叉，圈，和网格是游戏的元素，需要被设计和风格化。

## 关卡设计

关卡是游戏进展的结果。每个关卡都有一个概要，介绍，材料或元素，以及一个目标。根据游戏的不同，可以提供更多信息。

## 人工智能

人工智能帮助游戏在实时场景中体验。它可以是对手，敌人，障碍，友好支持，情况检测，碰撞检测，路径规划，或者任何自动确定游戏状态的东西。

人工智能对每个游戏都是强制性的。它应该意味着在一个领域内执行某项任务的数学或物理算法。

## 艺术风格

游戏设计文件还包括外观和风格的风格和方向。设计师也可以包括一些参考。这给了艺术家在思考艺术方向时一个头脑风暴。艺术是吸引用户最有力的部分。

这一部分不包括艺术的技术规范。开发人员可以在这里包括一些技术指导，以优化游戏内使用的资产。

## 技术参考

在设计文件的这一部分，包括了所有的技术参考。对于 Android 游戏开发，这一部分可能包括一系列具有最低规格的设备，目标平台，基础图形引擎，开发引擎等。这是实际技术设计文件的缩小版本。当开发人员或组织选择不制作任何单独的技术文件时，他们在这个范围内提到所有的技术规格。

## 变更日志

变更日志记录了文件的更改历史，包括版本和日期。这与任何变更日志文档具有相同的目的。

# 其他风格和标准

在前面的章节中提到的标准定义了制作游戏的一般流程。我们将讨论一些在游戏开发行业广泛使用的这些流程。

大多数大型组织都遵循一定的项目管理和跟踪系统。这可能会使开发过程变慢，但足够有效地减少风险并提高游戏质量。一些小型组织或个人开发者为了尽快完成产品而不遵循这样的流程。

这些风格是相互对立的，有不同的后果。然而，建议您遵循一种有利于长远发展的程序。快速修复不能成为永久解决方案。

另一个常用的做法是修补代码以解决错误。这也极易受到诸如项目崩溃、截止日期失败和产生重大错误等威胁。在游戏开发中，最常见的问题是设备崩溃，这在任何硬件平台上都是最不期望发生的。在大多数情况下，这是因为糟糕地处理异常而发生的。

玩游戏并理解游戏对于制作游戏是非常必要的。大多数游戏开发组织鼓励开发者玩游戏并研究游戏。对于 Android 开发者来说，多玩不同平台的游戏是非常好的练习。已经确定 Android 是最好的移动或小型硬件操作系统。它也在大型平台上有所发展。作为 Android 开发者，时刻关注其他平台的特性和发展，并尝试在 Android 中实现它们是一种良好的实践。这是 Android 游戏研发团队的工作。

# 不同的开发引擎的不同风格

我们已经讨论了一些开发工具和引擎。当前的游戏行业不鼓励仅针对特定硬件或操作平台开发游戏。我们可以找到很多平台独占的游戏，但这意味着一个商业决定。

很明显，相同的开发方法不适用于每个开发引擎。例如，在本地 Android 中的开发风格将不同于 Unity3D 游戏引擎中的开发风格。基本原因是：

+   不同的编程语言

+   不同的工作原则

+   不同的目标平台

## 不同的编程语言

每种编程语言都有自己的编程风格和结构。通过 C++在 Android NDK 上开发游戏与使用 Java 在 Android SDK 上制作游戏是不同的。使用第三方跨平台引擎开发游戏也是不同的。

我们这里不是在谈论语法上的差异。这是关于编码风格。在 Android NDK 中使用 C++与在 Unreal Engine 4 或 Cocos2d-x 中使用 C++是不同的。尽管 C++核心库是相同的，但每个工具都引导开发者朝着不同的风格方向以获得最佳结果。

不仅仅是 C++和 Java，游戏行业还在使用 C＃、Python、JavaScript、Lua、Boo 等。许多引擎支持多种编程语言，以吸引更多的开发者。

## 不同的工作原则

不同的游戏引擎或游戏制作工具遵循不同的工作原则。开发者应该足够灵活，适应这些不同的系统。不同引擎总是有不同的代码结构、文件夹结构和程序层次。

对于本地开发，是开发者设定标准。引擎带有一套标准，预期所有在该引擎上工作的开发者都会遵循相同的原则。

例如，Unity3D 的工作原理与 Unreal Engine 或 Cocos2d-x 大不相同。Cocos2d-x 不支持可视化编程，而 Unreal Engine Blueprint 则完全支持可视化编程。因此，尽管部署目标相同，开发方法必须不同。

## 不同的目标平台

现代跨平台游戏开发工具已经最小化了风格和标准的差异。然而，对于很少数的工具来说，风格和标准仍然不同。

现在，如果我们只谈论安卓，那么考虑一下上面的不同硬件平台。开发风格并不总是指编程。它涉及到从设计到部署的完整项目维护。安卓控制台开发与安卓手机开发不同。

从游戏玩法角度来看，设计风格通常随着游戏时间、控制和外观而变化。在控制台上的平均游戏时间可能长达 2 小时，而移动设备的游戏时间几乎是这个时间的 5%。触摸界面与按键界面大不相同，而游戏控制器界面也不同。因此，即使开发者计划使用相同的引擎部署相同的游戏，由于非常明显的原因，界面设计风格也会发生变化。

# 行业最佳实践

尽管存在大量的风格和标准，大多数开发者喜欢遵循一些共同的标准，以在游戏开发过程中创建稳定性。让我们讨论一些行业常见的标准领域：

+   设计标准

+   编程标准

+   测试标准

## 设计标准

每款游戏的设计和概念都各不相同。最佳的设计标准做法是将其适当地记录下来，并留有改进的余地。文件必须足够清晰，以便用户理解。无论概念是什么，开发者都不能在没有对标准有适当理解的情况下实施它。

设计范围不能太开放，以至于可以改变整个游戏；这会导致生产时间严重延误。然而，它应该始终有限的范围，以随着想法的增长改善生产时间。

设计必须指定目标类型和受众，以及有效的原因。这也应包括可能的目标硬件平台。

对于安卓开发，移动游戏是当今最大的行业。因此，大多数安卓开发者主要关注移动游戏。然而，设计师应该始终留有余地，使游戏能够部署到其他平台，如可穿戴设备、控制台等。

## 编程标准

编程是设计的执行。这是任何游戏制作中最重要的部分。标准的代码应该是可读的、模块化的，并且有适当的文档记录。以前有两种编程方法：过程化和面向对象。在现代游戏行业中，开发者遵循面向对象的方法。因此，编程标准发生了很大变化。以前，使用`m_`和`l_`作为变量前缀来指示它们在面向对象结构中的状态是常见做法。还有一些其他符号，如`i`、`f`和`b`等，用来表示变量类型。

现代标准主要遵循驼峰和帕斯卡命名法作为它们的命名约定。常见做法是对所有类、接口、枚举、事件、结构、命名空间和方法名使用帕斯卡命名法，其他元素应使用驼峰命名法。

编程语言中的驼峰命名法意味着名称的第一个字母应为小写，这被称为**小驼峰命名法**。帕斯卡命名法规定名称的第一个字母应大写，这被称为**大驼峰命名法**。

在任何语言的编程中，方法中的参数数量或每行的字数都没有技术上的限制。然而，常见的行业做法是方法的参数数量应在八个以内，编码每行的字数不应超过 20 个。

手动限制的原因是为了减少复杂性，提高代码的可读性。出于同样的原因，方法体应限制在 200 行以内，并且分割类结构始终是首选。

## 测试标准

测试是对设计实施的验证过程。测试还检查开发标准，并确保游戏的质量。

在大多数情况下，测试程序主要包括自动化测试和手动测试两个部分。程序员必须编写用于检查核心开发的自动化测试代码。这部分被称为测试代码，不得包含在主要开发项目中。需要专门的测试人员进行手动测试。他们的工作是从用户的角度确保游戏的质量。

大多数游戏开发公司都遵循测试程序的检查表。这个检查表通常包含定义的测试用例。测试用例主要由开发人员和设计师定义，测试人员需要执行这些用例。我们将在后面的章节中详细讨论测试。

# 总结

任何软件开发都必须遵循一定的协议和标准。游戏开发也不例外。遵循标准有助于产品在较长时间内持续存在。现代 Android 游戏的生命周期包括推出后的许多更新，在许多情况下游戏会持续多年。对于一个组织来说，同一个开发人员可能不会长时间地在同一个游戏上工作，这在游戏行业中是非常普遍的情况。

开发项目必须足够易读，以便新开发人员采用，并且足够灵活，以适应游戏更新的新变化。

最后，让我们总结一下在 Android 游戏开发行业中常见的强制性任务。游戏开发人员应该遵循游戏开发原则。首先，他们必须创建适当的游戏设计文件，以便程序员和艺术家能够清楚地理解。然后，他们应该创建适当的技术设计文件，为程序员和游戏工程师提供所有可能的技术信息。组织中的特定开发流程定义和维护开发标准。程序员必须以模块化的方式编写代码，以避免未来的更改，并增加代码的可重用性。适当的命名约定总是有助于更好地理解代码，并为轻松编辑和重用做好准备。

游戏开发人员应该遵循的另一种做法是玩很多游戏并享受游戏。
