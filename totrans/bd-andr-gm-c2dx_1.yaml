- en: Chapter 1. Setting Up Your Development Environment
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1章. 设置你的开发环境
- en: In this chapter, we will explain how to download and set up all the required
    tools to get you started with setting up an environment for building games for
    the Android platform. Although there are huge similarities between the Mac OS
    and the Windows development environment, we will cover all the details regarding
    the installation in both of these operating systems.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将解释如何下载并设置所有需要的工具，以便开始为Android平台构建游戏的环境。尽管Mac OS和Windows开发环境之间有很大的相似性，但我们将涵盖这两个操作系统安装的所有细节。
- en: 'The following topics will be covered in this chapter:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章节将涵盖以下主题：
- en: Cocos2d-x overview
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Cocos2d-x概述
- en: Setting up Java
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Java
- en: Setting up the Android SDK
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Android SDK
- en: Setting up the Android Native Development Kit (NDK)
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Android原生开发工具包（NDK）
- en: Setting up Apache Ant
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Apache Ant
- en: Setting up Python
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Python
- en: Setting up Cocos2d-x
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Cocos2d-x
- en: Setting up the Eclipse IDE
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 安装Eclipse IDE
- en: Template code walk-through
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模板代码演练
- en: Cocos2d-x overview
  id: totrans-12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Cocos2d-x概述
- en: Cocos2d-x is a C++ cross-platform port of the popular iOS gaming framework Cocos2d.
    It was first released in November 2010, and bought in 2011 by Chukong Technologies,
    a Beijing-based mobile gaming company. Nevertheless, it is still maintained by
    an active community of more than 400,000 developers worldwide, including Ricardo
    Quesada, the creator of the original Cocos2d iPhone engine.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: Cocos2d-x是流行的iOS游戏框架Cocos2d的C++跨平台移植版本。它最初于2010年11月发布，并在2011年被北京一家移动游戏公司触控科技收购。尽管如此，它仍然由一个超过40万开发者的活跃社区维护，包括原始Cocos2d
    iPhone引擎的创造者Ricardo Quesada。
- en: This framework encapsulates all the game details, such as sound, music, physics,
    user inputs, sprites, scenes, and transitions, so the developer will only have
    to focus on the game logic rather than re-inventing the wheel.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 这个框架封装了所有游戏细节，如声音、音乐、物理、用户输入、精灵、场景和过渡等，因此开发者只需关注游戏逻辑，而无需重新发明轮子。
- en: Setting up Java
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装Java
- en: The Android platform technology stack is based on the Java technology; that
    is why the first item to be downloaded will be the Java Development Kit (JDK).
    Although Java JDK 8 is the latest version at the time of writing this book, it
    is not officially supported by all Android versions, so we will download JDK 6,
    all the template Java codes generated by Cocos2d-x can be successfully compiled
    with this version.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: Android平台技术栈基于Java技术；因此，首先要下载的是Java开发工具包（JDK）。尽管在撰写本书时Java JDK 8是最新版本，但它并不被所有Android版本官方支持，因此我们将下载JDK
    6，所有由Cocos2d-x生成的模板Java代码都可以用这个版本成功编译。
- en: Note
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Java Runtime Environment (JRE) is not enough for building the Android applications,
    since it only contains the files required for running the Java applications, but
    it does not contain the tools required for building the Java applications.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Java运行环境（JRE）对于构建Android应用程序来说是不够的，因为它只包含了运行Java应用程序所需的文件，但它不包括构建Java应用程序所需的工具。
- en: You can download the JDK 6 from Oracle at [http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase6-419409.html](http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase6-419409.html)
    regardless of your development environment.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从Oracle的[http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase6-419409.html](http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase6-419409.html)下载JDK
    6，无论你的开发环境是什么。
- en: 'If Windows is your current environment, then after installing JDK you are required
    to add the path of the binaries folder to the PATH environment variable. This
    path will look like this: `C:\Program Files\Java\jdk1.6.0_45\bin`.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你的当前环境是Windows，那么在安装JDK之后，你需要将二进制文件所在路径添加到PATH环境变量中。这个路径看起来像这样：`C:\Program
    Files\Java\jdk1.6.0_45\bin`。
- en: Open a new system console and type `javac –version`, if Java compiler's version
    number is displayed, then you have successfully installed JDK in your system.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 打开一个新的系统控制台，输入 `javac –version`，如果显示了Java编译器的版本号，那么你已经成功在你的系统中安装了JDK。
- en: Note
  id: totrans-22
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: JDK 7 is required for building the applications for Android 5.0 and higher.
    You should download this version if you are targeting the latest Android versions.
    But, if you want your game to be compatible with the Android versions that are
    older than 4.4, then you should pick JDK 6.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: JDK 7是用于构建针对Android 5.0及以上版本应用程序所需的。如果你针对的是最新Android版本，应该下载这个版本。但是，如果你想你的游戏兼容低于4.4的Android版本，那么你应该选择JDK
    6。
- en: Setting up the Android SDK
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安装Android SDK
- en: The Android SDK contains all the required command line tools for building an
    Android application. It has versions for Windows, Mac, and GNU/Linux operating
    systems.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: Android SDK 包含构建 Android 应用所需的所有命令行工具。它有适用于 Windows、Mac 和 GNU/Linux 操作系统的版本。
- en: Android Studio is now the only officially supported IDE; nevertheless, Cocos2d-x
    3.4 provides only out-of-the-box support for Eclipse, which was the former official
    IDE for Android development. It is no longer available for downloading, since
    it is not in active development any more, but you may download Eclipse manually
    and install the **Android Development Tools** (**ADT**) by following the steps
    below.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: Android Studio 现在是唯一官方支持的 IDE；尽管如此，Cocos2d-x 3.4 只提供对 Eclipse 的即开即用支持，Eclipse
    是之前的官方 Android 开发 IDE。它不再可供下载，因为它已经不再积极开发，但你可以手动下载 Eclipse 并按照以下步骤安装 **Android
    Development Tools** (**ADT**)。
- en: Downloading the Android SDK
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 下载 Android SDK
- en: 'You can download Android SDK from the link: [http://developer.android.com/sdk](http://developer.android.com/sdk).
    At the bottom of the page, under **Other Download Options**, you will find the
    option for downloading the SDK tools. Choose the version that matches your operating
    system.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从链接 [http://developer.android.com/sdk](http://developer.android.com/sdk)
    下载 Android SDK。在页面底部，在 **Other Download Options** 下，你会找到下载 SDK 工具的选项。选择与你的操作系统相匹配的版本。
- en: At the time of writing this book, the latest version of SDK was 24.0.2.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本书时，SDK 的最新版本是 24.0.2。
- en: Run the Android SDK Installer and install the Android SDK on your computer.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 运行 Android SDK 安装程序并在你的计算机上安装 Android SDK。
- en: 'When the Android SDK finishes installing, it is not yet ready to build the
    Android apps. So, at the final screen of the installation wizard, mark the checkbox
    for **Start SDK Manager** so you can download the required components for building
    your games, as shown in the following screenshot:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完 Android SDK 后，它还不能立即用来构建 Android 应用。因此，在安装向导的最后一屏，勾选 **Start SDK Manager**
    的复选框，以便你可以下载构建游戏所需的组件，如下面的截图所示：
- en: '![Downloading the Android SDK](img/B04193_01_01.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![下载 Android SDK](img/B04193_01_01.jpg)'
- en: 'Once the Android SDK Manager starts, select **Android SDK Platform-tools**
    and **Android SDK Build-tools** from the `Tools` folders. Then select **SDK Platform**
    from your desired API level, as shown in the following screenshot:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 当 Android SDK 管理器启动后，从 `Tools` 文件夹中选择 **Android SDK Platform-tools** 和 **Android
    SDK Build-tools**。然后选择你所需 API 级别中的 **SDK Platform**，如下面的截图所示：
- en: '![Downloading the Android SDK](img/B04193_01_02.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![下载 Android SDK](img/B04193_01_02.jpg)'
- en: Downloading Eclipse
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 下载 Eclipse
- en: Download the latest version of the Eclipse IDE for Java Developers from [http://www.eclipse.org/downloads](http://www.eclipse.org/downloads).
    It will suggest the download versions compatible with your current operating system,
    select the version that better suits your operating system platform which will
    either be 32-bit or 64-bit.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 从 [http://www.eclipse.org/downloads](http://www.eclipse.org/downloads) 下载 Eclipse
    IDE for Java Developers 的最新版本。它会推荐与你的当前操作系统兼容的下载版本，选择最适合你的操作系统平台的版本，可以是 32 位或
    64 位。
- en: At the time of writing this book, Eclipse Luna (4.4.1) was the latest version.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本书时，Eclipse Luna (4.4.1) 是最新版本。
- en: Setting up the Eclipse ADT plugin
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置 Eclipse ADT 插件
- en: 'Open Eclipse and navigate to **Help** | **Install new Software** and add the
    Eclipse ADT download location, which is `https://dl-ssl.google.com/android/eclipse/`,
    as shown in the following screenshot:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 打开 Eclipse，导航到 **Help** | **Install new Software** 并添加 Eclipse ADT 下载位置，即 `https://dl-ssl.google.com/android/eclipse/`，如下面的截图所示：
- en: '![Setting up the Eclipse ADT plugin](img/B04193_01_03.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![设置 Eclipse ADT 插件](img/B04193_01_03.jpg)'
- en: Click on **OK**, then select the **Developer Tools** checkbox, and click on
    **Next** in order to finish the ADT installation wizard.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 点击 **OK**，然后勾选 **Developer Tools** 复选框，点击 **Next** 以完成 ADT 安装向导。
- en: Setting up the Android Native Development Kit
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置 Android 原生开发工具包
- en: We have already downloaded the Android SDK that allows you to create Android
    applications using the Java Technology; nevertheless, the Cocos2d-x framework
    is written in C++, so you will need the Android Native Development Kit (NDK) in
    order to build the C++ code for the Android platform.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经下载了允许你使用 Java 技术创建 Android 应用的 Android SDK；尽管如此，Cocos2d-x 框架是用 C++ 编写的，因此你需要
    Android 原生开发工具包（NDK）以便为 Android 平台构建 C++ 代码。
- en: Note
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Android's official documentation clearly states that you should use this native
    kit for specific circumstances, but you should not use it just because you are
    familiar with the C++ language, or because you want your application to perform
    faster. The manufacturer makes this suggestion because the Android core API is
    only available for Java.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: Android 的官方文档明确指出，你应该在特定情况下使用这个本地工具包，但不要仅仅因为熟悉 C++ 语言或希望应用程序运行更快而使用它。制造商提出这个建议是因为
    Android 核心API 只对 Java 语言可用。
- en: Download the latest NDK revision. At the time this book was written, it was
    10d. This version of NDK will allow you to build for all the Android platforms,
    including the latest.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 下载最新的 NDK 版本。在本书编写时，最新的版本是 10d。这个版本的 NDK 将允许你为所有 Android 平台构建，包括最新的。
- en: 'You can download the latest version of the Android NDK for all the platforms
    from the following link:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从以下链接下载适用于所有平台的最新版本 Android NDK：
- en: '[https://developer.android.com/tools/sdk/ndk](https://developer.android.com/tools/sdk/ndk)'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://developer.android.com/tools/sdk/ndk](https://developer.android.com/tools/sdk/ndk)'
- en: After downloading it, run the executable file. It will decompress the Android
    NDK directory on the current path; you need to be aware of this path since you
    will need it later.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 下载后，运行可执行文件。它将在当前路径解压 Android NDK 目录；你需要记住这个路径，因为你稍后需要用到。
- en: Setting up Apache Ant
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置 Apache Ant
- en: Apache Ant is a build management tool widely used for automating the Java projects
    build process. It has been introduced in Cocos2d-x 3.0 for building the framework
    for the Android platform. It has made the Android build process simpler and enhanced
    the cross-platform build. Back in Cocos2d-x 2.x, building the Android apps within
    the Windows operating system required simulating the UNIX environment by using
    Cygwin. This required minor hacks for successfully building the code, many of
    them still remain undocumented on the official Cocos2d-x site.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: Apache Ant 是一个广泛用于自动化 Java 项目构建过程的构建管理工具。从 Cocos2d-x 3.0 开始引入，用于为 Android 平台构建框架。它简化了
    Android 的构建过程，并增强了跨平台构建。在 Cocos2d-x 2.x 时代，在 Windows 操作系统内构建 Android 应用需要通过使用
    Cygwin 模拟 UNIX 环境。这需要一些小的修改才能成功构建代码，其中许多修改在官方 Cocos2d-x 网站上仍然没有记录。
- en: 'This tool can be downloaded from the link: [https://www.apache.org/dist/ant/binaries/](https://www.apache.org/dist/ant/binaries/)'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 这个工具可以从以下链接下载：[https://www.apache.org/dist/ant/binaries/](https://www.apache.org/dist/ant/binaries/)
- en: At the time of writing this book, version 1.9.4 was the latest. This tool is
    a cross-platform tool so a single download will work on any operating system that
    provides support for the Java technology.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 在编写本书时，最新的版本是 1.9.4。这个工具是一个跨平台工具，所以一个下载文件可以在任何支持 Java 技术的操作系统上工作。
- en: In order to install this tool, just unzip the file. Remember the path since
    you will need it during the Cocos2d-x setup process.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 为了安装这个工具，只需解压文件。记住这个路径，因为你在 Cocos2d-x 设置过程中需要用到。
- en: Setting up Python
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置 Python
- en: All the Cocos2d-x configuration files are written in Python. If you are using
    Mac OS or any Linux distribution, it will already be installed on your OS. So,
    you can skip this section.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 所有 Cocos2d-x 配置文件都是用 Python 编写的。如果你使用的是 Mac OS 或任何 Linux 发行版，你的操作系统已经预装了 Python。因此，你可以跳过这一部分。
- en: 'If you are using Windows, you need to download Python 2 from the following
    link: [https://www.python.org/ftp/python/2.7.8/python-2.7.8.msi](https://www.python.org/ftp/python/2.7.8/python-2.7.8.msi).'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用的是 Windows 系统，你需要从以下链接下载 Python 2：[https://www.python.org/ftp/python/2.7.8/python-2.7.8.msi](https://www.python.org/ftp/python/2.7.8/python-2.7.8.msi)。
- en: Take in to consideration that Python, as Cocos2d-x, keeps simultaneous support
    for versions 2 and 3\. Cocos2d-x only supports Python 2\. At the time of writing
    this book the latest version of the 2 branch was 2.7.8.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 请考虑 Python 和 Cocos2d-x 同时支持版本 2 和版本 3。Cocos2d-x 只支持 Python 2。在编写本书时，2.x 分支的最新版本是
    2.7.8。
- en: After the installer finishes with the setup, you should manually add the Python
    installation path to the PATH environment variable. The default installation path
    is `C:\Python27`.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 安装程序设置完成后，你应该手动将 Python 安装路径添加到 PATH 环境变量中。默认的安装路径是`C:\Python27`。
- en: 'Open a new system console and type `python`, if the Python console is shown,
    as seen in the following screenshot, then it means that Python has been installed
    correctly:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 打开一个新的系统控制台并输入`python`，如果出现如下截图所示的 Python 控制台，那么意味着 Python 已经正确安装：
- en: '![Setting up Python](img/B04193_01_04.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![设置 Python](img/B04193_01_04.jpg)'
- en: Note
  id: totrans-62
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'For setting an environment variable on Windows, click on the **Start** button
    and type: `edit the system environment` variables, click on it and hit the **Environment
    Variables** button, and then the environment variables configuration dialog will
    be displayed.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 在Windows上设置环境变量，点击**开始**按钮并输入：`编辑系统环境`变量，点击它然后点击**环境变量**按钮，接着将显示环境变量配置对话框。
- en: Setting up Cocos2d-x
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 设置Cocos2d-x
- en: 'Now that you have all the Cocos2d-x pre-requisites for building your first
    game for the Android platform, you are going to download the Cocos2d-x 3.4 framework
    and set it up with the help of the following steps:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 既然你已经拥有了构建Android平台上的第一款Cocos2d-x游戏所需的所有前提条件，你将需要下载Cocos2d-x 3.4框架，并按照以下步骤进行设置：
- en: You can download the source code from [http://www.cocos2d-x.org/download](http://www.cocos2d-x.org/download).
    Be aware that this page also has the link for downloading the Cocos2d-x branch
    2, which is not covered in this book, and the manufacturer has officially announced
    that the new features will only be available in branch 3.
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你可以从[http://www.cocos2d-x.org/download](http://www.cocos2d-x.org/download)下载源代码。请注意，此页面还提供了下载Cocos2d-x分支2的链接，本书不涉及此分支，而且制造商已正式宣布新特性仅在分支3中提供。
- en: After downloading the compressed Cocos2d-x source code, uncompress it to your
    desired location.
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载压缩的Cocos2d-x源代码后，将其解压到你想要的位置。
- en: In order to configure Cocos2d-x, open your system terminal and point to the
    path where you have uncompressed it, and type `setup.py`. It will require you
    to specify `ANDROID_NDK_PATH`, here you will specify the root directory of the
    NDK that you have previously uncompressed in the previous sections. Secondly,
    it will require you to specify `ANDROID_SDK_ROOT`, here you will specify the directory
    path from where you have chosen to install the Android SDK during the installation
    process. Then, it will require you to set `ANT_ROOT,` where you will specify the
    root directory of your ant installation. Finally, close the terminal, and open
    a new one so that the changes can take effect.
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为了配置Cocos2d-x，打开你的系统终端，定位到你解压它的路径，并输入`setup.py`。这将需要你指定`ANDROID_NDK_PATH`，在这里你需要指定之前在前面章节解压的NDK的根目录。其次，它将需要你指定`ANDROID_SDK_ROOT`，这里你需要指定在安装过程中你选择安装Android
    SDK的目录路径。然后，它将需要你设置`ANT_ROOT`，在这里你需要指定ant安装的根目录。最后，关闭终端，并打开一个新的终端，以便更改生效。
- en: Creating your first project
  id: totrans-69
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建你的第一个项目
- en: 'Now, Cocos2d-x is set up, and it is ready for creating your first project.
    You can do so by typing the following command:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，Cocos2d-x已经设置好了，可以开始创建你的第一个项目了。你可以通过输入以下命令来完成：
- en: '[PRE0]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: This script has created an Android template code for your game that will run
    in all the Android devices containing the Android API 9 or higher, that is Android
    2.3 (Gingerbread) and later.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 此脚本为你创建了一个Android模板代码，你的游戏将运行在所有包含Android API 9或更高版本的Android设备上，即Android 2.3（姜饼）及更高版本。
- en: Take in to consideration that the package name should contain exactly two dots,
    as the example shows, if it has less or more, then the project creation script
    will not work. The `–l cpp` parameter means that the new project is going to use
    C++ as the programming language, which is the only one that is covered in this
    book.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，包名应该恰好包含两个点，如示例所示，如果少于或多于两个点，项目创建脚本将无法工作。`–l cpp`参数意味着新项目将使用C++作为编程语言，这是本书唯一涵盖的语言。
- en: Cocos2d-x 3.x, as opposed to branch 2.x, allows you to create your project outside
    of the framework directory structure. Therefore, you can create your project at
    any location, and not just inside the `projects` directory, as it was in the previous
    versions.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 与2.x分支相反，Cocos2d-x 3.x允许你在框架目录结构之外创建你的项目。因此，你可以在任何位置创建你的项目，而不仅仅是像之前版本那样在`projects`目录内。
- en: 'It will take a while, since it will copy all the framework files to your new
    project''s path. After it finishes, plug your Android device to your computer,
    then you can easily run the template `HelloWorld` code by typing the following
    command within your new project''s path:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 这将需要一些时间，因为它会将所有框架文件复制到你的新项目路径中。完成后，将你的Android设备连接到电脑上，然后你可以在新项目路径中通过输入以下命令轻松运行模板`HelloWorld`代码：
- en: '[PRE1]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Alternatively, you could run the following command regardless of your current
    path on the terminal:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，无论你当前在终端的路径如何，都可以运行以下命令：
- en: '[PRE2]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Note
  id: totrans-79
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: For building and running Cocos2d-x 3.4 for Windows, you will need Microsoft
    Visual Studio 2012 or 2013.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 要为Windows构建和运行Cocos2d-x 3.4，您需要Microsoft Visual Studio 2012或2013。
- en: 'Now, you should be able to see the Cocos2d-x logo and a text that says **Hello
    World**, as we can see in the following image:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您应该能够看到Cocos2d-x的标志和显示**Hello World**的文字，如下面的图片所示：
- en: '![Creating your first project](img/B04193_01_05.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![创建您的第一个项目](img/B04193_01_05.jpg)'
- en: Setting up the Eclipse IDE
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 设置Eclipse IDE
- en: Cocos2d-x branch 3 has improved the Android building process significantly.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: Cocos2d-x 3分支显著改进了安卓构建过程。
- en: Back in branch 2, it was necessary to manually configure many environment variables
    within IDE, import many core projects, and handle dependencies. Even after completing
    all the steps, the Cygwin Windows UNIX port integration with Eclipse was never
    polished to work flawlessly, so minor hacks were required.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 在2分支中，需要在IDE中手动配置许多环境变量，导入许多核心项目，并处理依赖关系。即使完成所有步骤后，Cygwin Windows UNIX端口与Eclipse的集成也从未完善，因此需要一些小的修改。
- en: Building Cocos2d-x 3.4 within Eclipse is as simple as importing the project
    and clicking on the **Run** button. In order to achieve this, within the ADT,
    navigate to **File** | **Import** | **General** | **Existing Projects into Workspace**,
    select the path, where Cocos2d-x has created the new project from the previous
    sections. Then click on **Finish**.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 在Eclipse中构建Cocos2d-x 3.4就像导入项目并点击**运行**按钮一样简单。为了实现这一点，在ADT中，转到**文件** | **导入**
    | **通用** | **将现有项目导入工作空间**，选择Cocos2d-x在上一个部分创建新项目的路径。然后点击**完成**。
- en: Tip
  id: totrans-87
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Cocos2d-x Android template project is created using the API Level 10 as target
    platform. If you don't have this version installed on your system, you should
    change it by right-clicking on the project from the package explorer, click on
    **Properties**, and select your preferred installed Android API version from the
    **Project Build Target** box.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Cocos2d-x安卓模板项目是使用API级别10作为目标平台创建的。如果您系统上没有安装这个版本，您应该通过从包浏览器中右键点击项目，点击**属性**，并从**项目构建目标**框中选择您喜欢的已安装的安卓API版本来进行更改。
- en: 'Now, right-click on the project name in the package explorer, click on **run
    as,** and finally, click on **Android Application**. The following pop up will
    be displayed, and it will require you to specify the Android device on which you
    want to launch the Cocos2d-x game:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，在包浏览器中右键点击项目名称，点击**作为运行**，最后点击**安卓应用程序**。将会显示以下弹出窗口，要求您指定要启动Cocos2d-x游戏的安卓设备：
- en: '![Setting up the Eclipse IDE](img/B04193_01_06.jpg)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![设置Eclipse IDE](img/B04193_01_06.jpg)'
- en: After picking your Android device, you will see the HelloWorld game scene as
    it was shown when we ran the **Run** command in the previous section.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 选择您的安卓设备后，您将看到我们在前一部分运行**运行**命令时所显示的HelloWorld游戏场景。
- en: Template code walk-through
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模板代码演练
- en: In this section, we will explain the main parts of the Cocos2d-x template code
    generated in the previous sections by the project creation script.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一部分，我们将解释由项目创建脚本在上一个部分生成的Cocos2d-x模板代码的主要部分。
- en: Java classes
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Java类
- en: We now have one Java class in our project named `AppActivity` that has no members
    and extends the `Cocos2dxActivity` class from the core library. We can also see
    that 22 Java classes from the core library have been referenced in the project.
    This code is aimed to make our C++ code work, and we don't have to modify it at
    all.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的项目中现在有一个名为`AppActivity`的Java类，它没有成员并从核心库中的`Cocos2dxActivity`类继承。我们还可以看到项目中引用了核心库中的22个Java类。这段代码旨在使我们的C++代码工作，我们完全不需要修改它。
- en: Android application configuration
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安卓应用程序配置
- en: The generated `AndroidManifest.xml`, which is the android configuration file,
    requires the permission `android.permission.INTERNET,` which allows your Android
    application to use the Internet connection on your device; nevertheless, this
    is not needed by our simple game code since there is no Internet interaction.
    So, you may delete this line from the `AndroidManifest.xml` file if you wish.
    Your game will be shown in landscape by default, but if you wish to create a game
    that runs in portrait mode, then you should change the `android:screenOrientation`
    value from `landscape` to `portrait`.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 生成的`AndroidManifest.xml`是 Android 配置文件，它需要`android.permission.INTERNET`权限，该权限允许你的
    Android 应用程序使用设备上的互联网连接；然而，由于我们的简单游戏代码没有互联网交互，所以并不需要这个权限。因此，如果你愿意，可以删除`AndroidManifest.xml`文件中的这一行。你的游戏默认会以横屏显示，但如果你希望创建一个在竖屏模式下运行的游戏，那么你应该将`android:screenOrientation`的值从`landscape`更改为`portrait`。
- en: In order to change the Android application name, you may modify the `app_name`
    value located on the `strings.xml` file; it will affect the launcher icon's text
    and the application identifier within the Android OS.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更改 Android 应用程序名称，你可以修改位于`strings.xml`文件中的`app_name`值；这将影响启动器图标上的文字和 Android
    系统内的应用程序标识符。
- en: When you are creating your own games, you will have to create your own classes,
    and those will often be more than the two classes that were created by the script.
    Every time you create a new class, you need to add its name to the `LOCAL_SRC_FILES`
    property of the `Android.mk` make file located inside the `jni` folder of your
    new project directory structure. So, when your `cpp` code is built by the C++
    build tools, it knows which files it should compile.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 当你创建自己的游戏时，你将不得不创建自己的类，这些类通常会比脚本创建的两个类多。每次你创建一个新类时，都需要将其名称添加到新项目目录结构中`jni`文件夹内的`Android.mk`制作文件的`LOCAL_SRC_FILES`属性中。这样，当你的`cpp`代码由
    C++ 构建工具构建时，它会知道应该编译哪些文件。
- en: C++ classes
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: C++ 类
- en: 'Two C++ classes have been created: `AppDelegate` and `HelloWorldScene`. The
    first one is in charge of launching the Cocos2d-x framework and passing the control
    to the developer. The framework loading process happens within this class. If
    the Cocos2d-x core framework is successfully launched on the target device, it
    will run the `applicationDidFinishLaunching` method, which is the first game-specific
    function to be run.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 已经创建了两个 C++ 类：`AppDelegate`和`HelloWorldScene`。第一个负责启动 Cocos2d-x 框架并将控制权传递给开发者。框架加载过程发生在这个类中。如果
    Cocos2d-x 核心框架在目标设备上成功启动，它将运行`applicationDidFinishLaunching`方法，这是要运行的首个游戏特定功能。
- en: 'The code is very straightforward and it is documented such that you will be
    able to grasp its logic easily. Our first minor change to the code will be to
    hide the debug information that shows by default on this sample game. You could
    simply guess that in order to achieve this you should only send `false` as a parameter
    for the `setDisplayStats` method call in the `director` singleton instance, as
    we can see in the following code listing:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 代码非常直观，并且有详细的文档，以便你可以轻松理解其逻辑。我们对代码的第一次小改动将是隐藏默认显示在示例游戏中的调试信息。你可以猜测，为了实现这一点，你只需为`director`单例实例中的`setDisplayStats`方法调用发送`false`作为参数，如下面的代码清单所示：
- en: '[PRE3]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Tip
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Downloading the example code**'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**下载示例代码**'
- en: You can download the example code files for all Packt books you have purchased
    from your account at [http://www.packtpub.com](http://www.packtpub.com). If you
    purchased this book elsewhere, you can visit [http://www.packtpub.com/support](http://www.packtpub.com/support)
    and register to have the files e-mailed directly to you.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以从你在[http://www.packtpub.com](http://www.packtpub.com)的账户中下载你所购买的所有 Packt
    图书的示例代码文件。如果你在其他地方购买了这本书，可以访问[http://www.packtpub.com/support](http://www.packtpub.com/support)注册，我们会直接将文件通过电子邮件发送给你。
- en: Scenes
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 场景
- en: As we will cover in the chapters later in this book, Cocos2d-x handles the scene
    concept just like movies; movies are composed by scenes, so are the Cocos2d-x
    games. We can visualize the different screens, such as loading, main menu, world
    selection, gameplay levels, ending credits, and so on, as the different scenes.
    Each scene has a class that defines its behavior. The template code has only one
    scene named `HelloWorld` scene that is initialized and launched from within the
    `AppDelegate` class. The scene flow is managed by the game director as we have
    seen in the previous code. The `Director` class has all the basic features to
    drive the game, just like a director does during a movie. There is a single shared
    instance of the director class that is used within the whole application scope.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书后续章节中，我们将介绍Cocos2d-x如何处理场景概念，就像电影一样；电影由场景组成，Cocos2d-x游戏也是如此。我们可以将加载、主菜单、世界选择、游戏关卡、结束字幕等不同的屏幕可视化为不同的场景。每个场景都有一个定义其行为的类。模板代码只有一个名为`HelloWorld`的场景，该场景在`AppDelegate`类内部初始化并启动。正如我们在之前的代码中所见，场景流程由游戏导演管理。`Director`类拥有驱动游戏的所有基本特性，就像电影中的导演一样。有一个导演类的单一共享实例在整个应用程序范围内被使用。
- en: '`HelloWorldScene` contains the layer that represents all the visible areas
    that show up when we run our HelloWorld application, that is, the hello world
    label, the Cocos2d-x logo, and the menu showing the exit option.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '`HelloWorldScene`包含了代表我们运行HelloWorld应用程序时出现的所有可见区域的层，即，hello world标签，Cocos2d-x标志和显示退出选项的菜单。'
- en: Within the `init` method, we do the instantiation of the visual elements, and
    then we add it to the scene using the `addChild` method inherited from the `Node`
    core class.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 在`init`方法中，我们实例化视觉元素，并使用从`Node`核心类继承的`addChild`方法将其添加到场景中。
- en: Summary
  id: totrans-111
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have introduced the Cocos2d-x 3.4 gaming framework, and
    explained how to download and install it. We have also explained all of its pre-requisites.
    We have configured our work environment, launched our first Android application
    into an actual device, and gone through a quick code overview of the main aspects
    of the template code generated by the script.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们介绍了Cocos2d-x 3.4游戏框架，并解释了如何下载和安装它。我们还解释了所有它的先决条件。我们配置了工作环境，将我们的第一个Android应用程序部署到实际设备上，并通过脚本生成的模板代码快速概览了其主要方面。
- en: In the next chapter, we will cover how to create and manipulate all of our game
    graphics, such as the main character, enemies, obstacles, backgrounds, and so
    on.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将介绍如何创建和操作所有的游戏图形，例如主角、敌人、障碍物、背景等。
