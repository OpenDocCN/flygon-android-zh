- en: Chapter 7
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第七章
- en: Android application and forensic analysis
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安卓应用程序与法医分析
- en: Information in this chapter
  id: totrans-2
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 本章信息
- en: • [Analysis techniques](#S0015)
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: • [分析技术](#S0015)
- en: • [FAT forensic analysis](#S0050)
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: • [FAT法医分析](#S0050)
- en: • [YAFFS2 forensic analysis](#S0080)
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: • [YAFFS2法医分析](#S0080)
- en: • [Android app analysis and reference](#S0110)
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: • [安卓应用分析与参考](#S0110)
- en: Introduction
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 引言
- en: A lot of material has been discussed up to this point in the book covering not
    only the history and architecture of Android devices but also complete details
    on the file systems, ways to secure devices, and methodology to acquire data from
    them. But data without context and analysis is just noise. Many of the techniques
    used in traditional forensic investigations are applicable in Android forensics
    analysis.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，本书已经讨论了大量材料，不仅涵盖了安卓设备的历史和架构，还提供了关于文件系统、设备安全方法和数据获取方法的完整详细信息。但缺乏上下文和分析的数据只是噪音。许多传统法医调查中使用的技术适用于安卓法医分析。
- en: Analysis techniques
  id: totrans-9
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 分析技术
- en: This section will provide an overview of the analysis techniques followed by
    sections that demonstrate the procedures for specific file systems.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将提供分析技术概述，随后是展示特定文件系统程序的章节。
- en: Timeline Analysis
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 时间线分析
- en: Timeline analysis should be a key component to any investigation as the timing
    of events is nearly always relevant. There are many ways to build a forensic timeline.
    However, unless created with specialized software, the process can be quite tedious.
    Several software techniques will be covered in detail later in the chapter including
    free, open source forensic utilities from both The Sleuth Kit and log2timline.
    Other forensic tools can create timelines as well.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 时间线分析应成为任何调查的关键组成部分，因为事件的时间几乎总是相关的。构建法医时间线的方法有很多。然而，除非使用专门软件创建，否则这个过程可能非常繁琐。本章后面将详细介绍几种软件技术，包括来自The
    Sleuth Kit和log2timline的自由开源法医工具。其他法医工具也可以创建时间线。
- en: For supported file systems (for example, the FAT16/FAT32 file systems found
    on the SD cards and embedded MultiMediaCard [eMMC]), a number of tools are available
    which can create the timeline. However, YAFFS2 is not currently supported by any
    analysis tool and so creating a timeline requires significant manual analysis.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 对于支持的文件系统（例如，在SD卡和嵌入式多媒体卡[eMMC]上发现的FAT16/FAT32文件系统），有许多工具可以创建时间线。然而，目前没有分析工具支持YAFFS2，因此创建时间线需要大量的手动分析。
- en: The primary source of timeline information is the file system metadata including
    the modified (file metadata), accessed, changed (file contents), and created.
    This metadata is often referred to as MAC times or sometimes MACB where the “B”
    represents when a file was created (born). File systems track different time stamps
    and have nuances that must be taken into account when performing forensic analysis.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 时间线信息的主要来源是文件系统元数据，包括修改（文件元数据）、访问、更改（文件内容）和创建时间。这些元数据通常被称为MAC时间，有时也被称为MACB（其中“B”代表文件创建时间）。在进行法医分析时，必须考虑文件系统跟踪不同时间戳并具有细微差别。
- en: 'For example, Microsoft’s FAT file system has been the subject of many forensic
    investigations and analyses. The Microsoft Developers Network (MSDN) provides
    details on file times in FAT and NTFS file systems, stating:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，微软的FAT文件系统已经成为了许多法医调查和分析的主题。微软开发者网络（MSDN）提供了关于FAT和NTFS文件系统中的文件时间的详细信息，并指出：
- en: Not all file systems can record creation and last access times, and not all
    file systems record them in the same manner. For example, the resolution of create
    time on FAT is 10 ms, while write time has a resolution of 2 s, and access time
    has a resolution of 1 day, and hence, it is really the access date. The NTFS file
    system delays updates to the last access time for a file by up to 1 h after the
    last access.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 并非所有文件系统都能记录创建和最后访问时间，而且不是所有文件系统都以相同方式记录它们。例如，FAT上的创建时间分辨率为10毫秒，而写入时间分辨率为2秒，访问时间分辨率为1天，因此实际上它是访问日期。NTFS文件系统会将文件最后访问时间更新延迟最多1小时。
- en: ([File Times, n.d.](#BIB1))
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: （[文件时间，未标明日期](#BIB1)）
- en: Andre Ross created a useful graphical representation of this on his digfor (DIGital
    FORensics) blog ([http://digfor.blogspot.com/2008/10/time-and-timestamps.html](http://digfor.blogspot.com/2008/10/time-and-timestamps.html))
    shown in [Fig. 7.1](#F0010) ([Ross, A., n.d.](#BIB10)).
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: Andre Ross在他的digfor（数字法医）博客上创建了一个有用的图形表示([http://digfor.blogspot.com/2008/10/time-and-timestamps.html](http://digfor.blogspot.com/2008/10/time-and-timestamps.html))，如图[7.1](#F0010)所示（[Ross,
    A., 未标明日期](#BIB10)）。
- en: '![image](img/F10007Xf07-01-9781597496513.jpg)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-01-9781597496513.jpg)'
- en: FIGURE 7.1 FAT and NTFS time and time stamps.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.1 FAT和NTFS时间及时间戳。
- en: To further illustrate how FAT time stamps work, digital forensics and incident
    response firm cmdLab posted a blog entitled “Misinterpretation of File System
    Timestamps” ([Casey, E., n.d.](#BIB3)), which provides full details on FAT time
    stamps.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进一步说明FAT时间戳的工作原理，数字取证和事件响应公司cmdLab发布了一篇名为“文件系统时间戳的误解”的博客（[Casey, E., n.d.](#BIB3)），其中提供了关于FAT时间戳的完整详细信息。
- en: 'The confusion arises from the fact that FAT file systems represent create and
    last-write time stamps slightly differently. Last-write time stamps are 32-bit
    little-endian values, interpreted as follows:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 之所以出现混淆，是因为FAT文件系统对创建时间和最后写入时间戳的表示略有不同。最后写入时间戳是32位小端值，解释如下：
- en: '![image](img/F10007Xu07-01-9781597496513.jpg)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-01-9781597496513.jpg)'
- en: 'Take as an example the following FAT folder entry with the last-write date
    highlighted in bold:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 以以下FAT文件夹条目为例，其中最后写入日期以粗体突出显示：
- en: '![image](img/F10007Xu07-02-9781597496513.jpg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-02-9781597496513.jpg)'
- en: 'Converting to big endian gives 3a 75 b9 78, which has the following binary
    representation:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 转换为大端表示为3a 75 b9 78，其二进制表示如下：
- en: 00111010 01110101 10111001 01111000
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 00111010 01110101 10111001 01111000
- en: 'This translates to a time stamp of 2009.03.21 23:11:48 as follows:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 这对应于以下时间戳：2009.03.21 23:11:48：
- en: • 7 bits = 0011101 = 29 years since 1980
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: • 7位 = 0011101 = 1980年以来29年
- en: • 4 bits = 0011 = 3 months
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: • 4位 = 0011 = 3个月
- en: • 5 bits = 10101 = 21 days
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: • 5位 = 10101 = 21天
- en: • 5 bits = 10111 = 23 h
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: • 5位 = 10111 = 23 h
- en: • 6 bits = 001011 = 11 min
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: • 6位 = 001011 = 11 min
- en: • 5 bits = 11000 = 24 = 48 s
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: • 5位 = 11000 = 24 = 48 s
- en: Note that 5 bits cannot store all 60 s, so last-write time stamps must be incremented
    in 2 s intervals, and are always an even number of seconds.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，5位无法存储所有的60秒，因此最后写入时间戳必须以2秒的间隔递增，并且总是偶数秒。
- en: Although the create time follows a similar general calculation, it uses an additional
    8 bits to represent one hundredths of a second. In the same directory listing
    above, the create time stamp is identical to the last modified time stamp except
    for an additional byte (75 78 b9 75 3a). The additional byte equates to 117 hundredths
    of a second, which brings the create time to 2009.03.21 23:11:49.17\. Thus, the
    create time can have an odd number of seconds, and has a resolution of 10 ms.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管创建时间遵循类似的通用计算方法，但它使用额外的8位来表示百分之一秒。在上面的同一目录列表中，创建时间戳与最后修改时间戳相同，除了多出一个字节（75
    78 b9 75 3a）。这个额外的字节等于117百分之一秒，这使得创建时间变为2009.03.21 23:11:49.17。因此，创建时间可以有奇数秒，并且具有10毫秒的分辨率。
- en: One tool used in this book for timeline analysis is The Sleuth Kit (TSK), which
    supports several file systems. The TSK wiki provides the information presented
    in [Table 7.1](#T0010) to define the meaning of MACB time stamps for the supported
    file systems ([Carrier, B., n.d.](#BIB2)).
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 本书用于时间线分析的一个工具是The Sleuth Kit（TSK），它支持多种文件系统。TSK维基提供了[表7.1](#T0010)中的信息，以定义支持的文件系统MACB时间戳的含义（[Carrier,
    B., n.d.](#BIB2)）。
- en: Table 7.1 MAC Meaning by File System
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.1 文件系统MAC含义
- en: '![Image](img/T10007XtabT0010.jpg)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
  zh: '![Image](img/T10007XtabT0010.jpg)'
- en: Unfortunately, TSK does not, as of version 3.2.1, fully support YAFFS2\. However,
    there are some efforts to provide this information. For Android, TSK is effective
    in analyzing the FAT file systems as well as EXT3 which is found on some devices.
    TSK does not yet fully support EXT4 but the software is updated frequently and
    examiners should check the web site [http://www.sleuthkit.org/](http://www.sleuthkit.org/)
    for the most recent changes.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 不幸的是，截至版本3.2.1，TSK并不完全支持YAFFS2。然而，有一些努力提供这些信息。对于Android，TSK在分析FAT文件系统以及某些设备上发现的EXT3方面是有效的。TSK尚未完全支持EXT4，但软件更新频繁，检查员应访问[http://www.sleuthkit.org/](http://www.sleuthkit.org/)以获取最近的更改。
- en: File System Analysis
  id: totrans-41
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 文件系统分析
- en: As discussed throughout this book, the directories and files in the Android
    file systems are obviously the primary focus of a forensic investigation. The
    final section of this chapter and book, “Android App Analysis and Reference,”
    will provide a detailed analysis of Android apps. Combining this information with
    techniques demonstrated in [Chapter 4](CHP004.html) will provide the most significant
    results for an investigation.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 正如本书所讨论的，Android文件系统中的目录和文件显然是法医调查的主要关注点。本章和本书的最后一节“Android应用分析与参考”将提供对Android应用的详细分析。将此信息与[第4章](CHP004.html)中展示的技术相结合，将为调查提供最重要的结果。
- en: There are a number of directories that need to be examined for an investigation.
    Over time, examiners will need to expand the list to include new directories and
    files, as Android devices are changing rapidly. The best way to approach this
    problem is to first run the following command to determine which file systems
    are mounted on the system, where they are mounted, and what type they are. To
    demonstrate, let’s look at four different Android phones including a T-Mobile/HTC
    G1, a Google Nexus One, a Motorola Droid, and an HTC Incredible.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 调查中需要检查许多目录。随着时间的推移，检查员需要扩展目录和文件列表，因为 Android 设备变化迅速。解决这个问题最好的方法是首先运行以下命令，以确定系统上挂载了哪些文件系统，它们挂载在哪里，以及它们的类型是什么。为了说明，让我们看看四款不同的
    Android 手机，包括 T-Mobile/HTC G1，谷歌 Nexus One，摩托罗拉 Droid 和 HTC Incredible。
- en: 'To start, let’s examine the output of the mount command on the G1 running Android
    1.5:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们检查一下运行 Android 1.5 的 G1 上的 mount 命令输出：
- en: '![image](img/F10007Xu07-03-9781597496513.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-03-9781597496513.jpg)'
- en: This particular G1 was running a stock firmware and did not have an SD card
    inserted, so we are left with four file systems to examine, highlighted with emphasis.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 这款特定的 G1 运行的是原厂固件，没有插入 SD 卡，所以我们只剩下四个用强调标记的文件系统需要检查。
- en: 'Similarly, we examine the output of mount on the Nexus One running Android
    2.1-update1:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，我们检查一下运行 Android 2.1-update1 的 Nexus One 上的 mount 输出：
- en: '![image](img/F10007Xu07-04-9781597496513.jpg)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-04-9781597496513.jpg)'
- en: In this case, there are five file systems on the Nexus One, highlighted with
    emphasis, which should be the initial focus of an examination. The additional
    file system is the SD card mounted.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个案例中，Nexus One 上有五个文件系统，我们用强调的方式标记出来，这应该是检查的初步关注点。新增的文件系统是挂载的 SD 卡。
- en: 'Next, we take a look at the Motorola Droid’s mounted file systems when running
    Android 2.2.1:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们看看运行 Android 2.2.1 系统的摩托罗拉 Droid 的挂载文件系统：
- en: '![image](img/F10007Xu07-05a-9781597496513.jpg)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-05a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-05b-9781597496513.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-05b-9781597496513.jpg)'
- en: The Motorola Droid also has seven files systems of interest. However, they are
    slightly different from the Nexus One.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 摩托罗拉 Droid 也有七个值得关注的文件系统。然而，它们与 Nexus One 略有不同。
- en: 'Finally, let’s take a look at the HTC Incredible output previously discussed
    running Android 2.2:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们看看之前讨论的运行 Android 2.2 的 HTC Incredible 的输出：
- en: '![image](img/F10007Xu07-06-9781597496513.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-06-9781597496513.jpg)'
- en: The HTC Incredible tops the list with nine file systems of interest. As you
    can tell, with different Android devices and different versions of Android, the
    file systems of interest change. However, from the above examination, we have
    created [Table 7.2](#T0015), which provides a strong starting point for file system
    examinations.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: HTC Incredible 以九个值得关注的文件系统位居榜首。如您所见，不同的 Android 设备和不同的 Android 版本，关注的文件系统会有所变化。然而，从上述检查中，我们创建了[表
    7.2](#T0015)，这为文件系统检查提供了一个强有力的起点。
- en: Table 7.2 File Systems to Include in an Investigation
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 表 7.2 调查中应包含的文件系统
- en: '| Mount Point | File System Type | Relevance |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: '| 挂载点 | 文件系统类型 | 相关性 |'
- en: '| --- | --- | --- |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| /proc | proc | Examine on the phone with the “cat” command. Look for relevant
    metadata about the system such as file system statistics |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: '| /proc | proc | 使用“cat”命令在手机上检查。寻找关于系统的相关元数据，如文件系统统计信息 |'
- en: '| /data/data (on older systems, entire /data is 1 partition/file system) |
    YAFFS2 | Nearly all app data |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: '| /data/data（在旧系统上，整个/data是1个分区/文件系统） | YAFFS2 | 几乎所有的应用数据 |'
- en: '| /data (on newer phones /data can be further segemented) | EXT3/EXT4/YAFFS2
    | App and system data excluding the app data stores found in /data/data |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: '| /data（在新手机上/data可以进一步细分） | EXT3/EXT4/YAFFS2 | 应用和系统数据，不包括/data/data中的应用数据存储
    |'
- en: '| /cache | YAFFS2/EXT3 | Cache file system used by some apps and by the system
    |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '| /cache | YAFFS2/EXT3 | 一些应用和系统使用的缓存文件系统 |'
- en: '| /mnt/asec | tmpfs | Unencrypted app .apk file, which is stored encrypted
    on the SD card but decrypted here for running systems to access and utilize |'
  id: totrans-64
  prefs: []
  type: TYPE_TB
  zh: '| /mnt/asec | tmpfs | 未加密的应用 .apk 文件，它存储在 SD 卡上并加密，但在这里解密以便运行系统访问和使用 |'
- en: '| /app-cache | tmpfs | Temporary file system where com.android.browser (on
    HTC Incredible) stores cache. Other apps may also use this directory over time
    |'
  id: totrans-65
  prefs: []
  type: TYPE_TB
  zh: '| /app-cache | tmpfs | 临时文件系统，HTC Incredible 上的 com.android.browser 存储缓存。随着时间的推移，其他应用也可能使用这个目录
    |'
- en: '| /mnt/sdcard | vfat | FAT32 file system on removable SD card |'
  id: totrans-66
  prefs: []
  type: TYPE_TB
  zh: '| /mnt/sdcard | vfat | 可移动 SD 卡上的 FAT32 文件系统 |'
- en: '| /mnt/emmc | vfat | FAT32 file system on the Embedded MultiMediaCard (eMMC)
    |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '| /mnt/emmc | vfat | 嵌入式 MultiMediaCard (eMMC) 上的 FAT32 文件系统 |'
- en: On a positive note, as these files are allocated, even for unsupported file
    systems such as YAFFS2, the files can be copied to another medium and examined
    with existing forensic tools and techniques an examiner owns and has knowledge
    of. For example, the contents of “/data/data” could be copied from an Android
    device onto your forensic workstation and then the content could be examined directly.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 值得注意的是，由于这些文件已被分配，即使是不受支持的文件系统（如YAFFS2），这些文件也可以被复制到另一个介质上，并使用现有的取证工具和技术进行检验。例如，可以从Android设备将“/data/data”的内容复制到你的取证工作站上，然后直接检查内容。
- en: File Carving
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 文件雕刻
- en: File carving is a process in which specified file types are searched for and
    extracted across binary data, often resulting in a forensic image of an entire
    disk or partition. File carving works by examining the binary data and identifying
    files based on their known file headers. If the file format has a known footer,
    it will then scan from the header until it finds the footer (or hits a maximum
    file length set by the configuration file) and then save the carved file to disk
    for further examination.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 文件雕刻是一个过程，通过这个过程，在二进制数据中搜索并提取特定的文件类型，通常会导致整个磁盘或分区的取证镜像。文件雕刻通过检查二进制数据并基于已知的文件头来识别文件。如果文件格式有一个已知的文件尾，它将从头部扫描直到找到尾部（或达到配置文件设置的最大文件长度），然后将雕刻的文件保存到磁盘以供进一步检查。
- en: Traditional file carving techniques require that the data are sequential in
    the image and this cannot produce the full file if it is fragmented. There are
    many reasons that files are fragmented as the process for saving the file to nonvolatile
    storage varies by file system type and is heavily influenced by the memory type
    such as NAND flash. This also means that files that are very large (such as videos)
    will be more difficult to recover.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 传统的文件雕刻技术要求数据在镜像中是连续的，如果文件被碎片化，这无法产生完整的文件。文件碎片化的原因有很多，因为将文件保存到非易失性存储的过程因文件系统类型而异，并且受到内存类型（如NAND闪存）的强烈影响。这也意味着，非常大的文件（如视频）将更难以恢复。
- en: Newer file carving techniques are being researched and developed to address
    the limitations experienced with file fragmentation. One such technique is developed
    by Digital Assembly, a digital forensics solutions company based in New York.
    Their technique, called SmartCarving, profiles the fragmentation characteristics
    of several popular file systems (except YAFFS2, unfortunately) and uses this information
    to carve even fragmented photos. Their product, Adroit Photo Forensics, can also
    carve images from unknown file systems ([Digital Assembly, n.d.](#BIB5)).
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 新的文件雕刻技术正在被研究和开发，以解决文件碎片化带来的限制。纽约的一家数字取证解决方案公司——数字装配（Digital Assembly）开发了一种这样的技术，称为SmartCarving。该技术分析了多种流行文件系统（不幸的是，不包括YAFFS2）的碎片化特性，并利用这些信息来雕刻碎片化的照片。他们的产品Adroit
    Photo Forensics还可以从未知文件系统中雕刻图像（[数字装配，未标明日期](#BIB5)）。
- en: One popular tool used for carving data files is scalpel, an open source, high
    performance file carver written by Golden G. Richard III ([Scalpel, n.d.](#BIB12)).
    Scalpel reads a configuration file for desired file header and footer definitions
    in order to extract files from a raw image. It is file system independent and
    will work on FATx, NTFS, EXT2/3, HFS, or raw partitions. Scalpel is written in
    C and runs on Linux, Windows, OS X, and other operating systems which can compile
    the C code ([Scalpel, n.d.](#BIB12)).
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 用于雕刻数据文件的一种流行工具是scalpel，这是一个由Golden G. Richard III编写的开源高性能文件雕刻工具（[Scalpel，未标明日期](#BIB12)）。Scalpel读取一个配置文件，其中包含所需的文件头和尾定义，以便从原始镜像中提取文件。它是独立于文件系统的，可以在FATx、NTFS、EXT2/3、HFS或原始分区上工作。Scalpel是用C语言编写的，可以在Linux、Windows、OS
    X和其他可以编译C代码的操作系统上运行（[Scalpel，未标明日期](#BIB12)）。
- en: 'There are two ways to acquire scalpel. First, on the forensic workstation,
    you can install via apt-get:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 获取scalpel有两种方法。首先，在取证工作站上，你可以通过apt-get安装：
- en: '![image](img/F10007Xu07-07-9781597496513.jpg)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-07-9781597496513.jpg)'
- en: This will install the latest version. Alternatively, you can compile from source,
    which will allow you to install the latest version on Linux or other platforms
    without waiting for the specific platform maintainer to update the prepackaged
    version.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 这将安装最新版本。另外，你也可以从源代码编译，这将允许你在Linux或其他平台上安装最新版本，而无需等待特定平台维护者更新预打包版本。
- en: '![image](img/F10007Xu07-08-9781597496513.jpg)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-08-9781597496513.jpg)'
- en: 'The scalpel executable is now in “~/scalpel-1.60” and is simply called scalpel.
    In addition, there is a sample scalpel.conf in that same directory that is needed
    by scalpel to run and to extend the supported file definitions. Here’s a starter
    scalpel.conf for an Android device:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 现在scalpel可执行文件位于“~/scalpel-1.60”目录下，简单地称为scalpel。此外，在同一目录中还有一个样本scalpel.conf文件，scalpel需要它来运行并扩展支持的文件定义。以下是针对Android设备的起始scalpel.conf文件：
- en: '![image](img/F10007Xu07-09a-9781597496513.jpg)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-09a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-09b-9781597496513.jpg)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-09b-9781597496513.jpg)'
- en: As you can tell, the headers for this configuration file define the extension
    or file type (if it is case sensitive), the maximum size to carve, the header
    definition (in ASCII, hex, and other supported notations), and the footer (if
    it exists). A targeted file type for carving does not need to define each setting.
    For additional information, see the sample configuration file in the downloaded
    source files as there are many additional options that are quite powerful. Your
    Ubuntu workstation now has the software needed for file carving, which will be
    covered in the FAT32 and YAFFS2 sections.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，这个配置文件的头部定义了扩展名或文件类型（如果区分大小写），要雕刻的最大大小，头部定义（以ASCII、十六进制和其他支持的表示法），以及尾部（如果存在）。针对雕刻的目标文件类型不需要定义每个设置。有关更多信息，请参见下载源文件中的示例配置文件，因为还有许多其他非常强大的选项。现在你的Ubuntu工作站已经具备了进行文件雕刻所需的软件，这将在FAT32和YAFFS2部分进行介绍。
- en: It is worth pointing out that a large number of file signatures have already
    been assembled. Gary Kessler, an independent consultant and practitioner of digital
    forensics, actively maintains a table of file signatures on his web site ([Kessler,
    G., n.d.](#BIB9)). He references the “magic file,” which is found on most Unix
    systems located at “/usr/share/file/magic” on the Ubuntu workstation. On the workstation,
    you can run the “file” command, which takes a file as an argument and attempts
    to determine the file type based on the signatures in the magic file.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 值得一提的是，大量的文件签名已经被汇编好了。Gary Kessler，一位独立的咨询数字取证实践者，在他的网站上积极维护文件签名表([Kessler,
    G., n.d.](#BIB9))。他引用了“magic file”，在大多数Unix系统中都可以找到，位于Ubuntu工作站上的“/usr/share/file/magic”。在工作站上，您可以运行“file”命令，它接受一个文件作为参数，并尝试根据magic文件中的签名确定文件类型。
- en: 'A simple example is looking at an unknown file in “/mnt/emmc/.Trashes,” called
    “._501,” which cannot be easily identified by the file name (of course, some people
    might try to hide file types by changing the extension; however, by examining
    the file signature, this is easily discovered):'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简单的例子是查看“/mnt/emmc/.Trashes”中的未知文件，名为“._501”，通过文件名无法轻易识别它（当然，有些人可能会通过更改扩展名来隐藏文件类型；然而，通过检查文件签名，很容易发现这一点）：
- en: '![image](img/F10007Xu07-10-9781597496513.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-10-9781597496513.jpg)'
- en: Thus, the eMMC has an OS X file in the Trash, which might indicate that someone
    connected the Android device to a Mac computer.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，eMMC中有一个OS X文件在垃圾箱里，这可能表明有人将Android设备连接到了Mac电脑。
- en: Strings
  id: totrans-86
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 字符串
- en: The strings command on the Ubuntu workstation will extract, by default, ASCII
    printable strings—at least four characters long—from any file, text or binary.
    While this technique is not terribly elegant or sophisticated, it is quite effective
    at quickly examining binary data to determine if information of interest might
    be contained in the file.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Ubuntu工作站上的strings命令默认会从任何文件（文本或二进制）中提取至少四个字符长的ASCII可打印字符串。虽然这种技术不是特别优雅或复杂，但它非常有效，可以快速检查二进制数据，以确定文件中是否可能包含感兴趣的信息。
- en: 'There are several options that have a great impact on what strings output.
    First, let’s take a look at the synopsis section of the command’s man page (manual):'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个选项对字符串输出有很大影响。首先，让我们看一下命令手册页面的概要部分：
- en: '![image](img/F10007Xu07-11-9781597496513.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-11-9781597496513.jpg)'
- en: There are a few options you should always consider using when executing strings.
    First, the “—all” option tells strings to examine the entire file (on certain
    files, it only examines certain portions of the file). Second, the “--radix=”
    option instructs strings to print the offset within the file where the string
    was found. This is extremely helpful when you combine strings and a hex editor
    to examine possible evidence found in the file. The radix option can print the
    offset in octal (--radix=o), hex (--radix=x), or decimal (--radix=d). For most
    hex editors, you should consider hex or perhaps decimal offsets.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行strings命令时，有几个选项你应当始终考虑使用。首先，“—all”选项告诉strings检查整个文件（对于某些文件，它只检查文件的某些部分）。其次，“--radix=”选项指示strings打印在文件中找到字符串的偏移量。当你将strings命令和十六进制编辑器结合使用，以检查文件中可能找到的证据时，这个选项非常有帮助。radix选项可以以八进制(--radix=o)、十六进制(--radix=x)或十进制(--radix=d)打印偏移量。对于大多数十六进制编辑器，你应该考虑使用十六进制或十进制偏移量。
- en: 'The other extremely important option controls the character encoding of the
    strings, which provides support for Unicode characters in both big-endian and
    little-endian formats:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个极其重要的选项控制字符串的字符编码，它支持大端和小端格式下的Unicode字符：
- en: '![image](img/F10007Xu07-12-9781597496513.jpg)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-12-9781597496513.jpg)'
- en: 'This is important because not only does Android natively support Unicode but
    it also allows investigating a phone where the default language requires Unicode.
    Following are a few examples from the previous dd image:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 这一点很重要，因为Android不仅原生支持Unicode，而且它还允许调查者探究那些默认语言需要Unicode的手机。以下是之前dd镜像中的一些例子：
- en: '![image](img/F10007Xu07-13-9781597496513.jpg)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-13-9781597496513.jpg)'
- en: In this example, the first lines of results were omitted. However, you can see
    the dd image is referencing the htcchirp.db at offset 0x880A and, shortly thereafter,
    we see unlinked (0x900A), deleted (0x980A), and finally htcchirp.db-journal (0xA00A).
    So what does all this mean? It seems likely that the htcchirp.db database was
    modified. During that time, it created a special file (htcchirp.db-journal, a
    journal file) that manages the update and allows the change to roll back if it
    was not successful. After the journal file was no longer needed, it was deleted.
    This is important information for understanding what occurred and where deleted
    data might exist (the journal file takes a complete snapshot of the SQLite page
    that is being updated and thus, the previous values are stored on the NAND flash).
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，结果的最初几行被省略了。但是，你可以看到dd镜像在偏移量0x880A处引用了htcchirp.db，紧接着我们看到了未链接(0x900A)、已删除(0x980A)，最后是htcchirp.db-journal
    (0xA00A)。那么这一切意味着什么？看起来htcchirp.db数据库被修改了。在那段时间里，它创建了一个特殊文件（htcchirp.db-journal，一个日志文件），该文件管理更新并允许在更新不成功时回滚更改。当不再需要日志文件时，它被删除了。这对于理解发生的情况以及可能存在已删除数据的位置（日志文件对正在更新的SQLite页面进行了完整快照，因此，以前的值存储在NAND闪存上）是重要的信息。
- en: 'Now, let’s change the encoding parameter and look for the following:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们更改编码参数并查找以下内容：
- en: '![image](img/F10007Xu07-14-9781597496513.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-14-9781597496513.jpg)'
- en: In this example, we are looking for 16-bit big-endian characters. In this case,
    two examples were pulled from the results. In one example at offset 0xC42404,
    it’s clear some sort of activity related to Chicago occurred. The examiner could
    simply open a hex edit, jump to offset 0xC42404, and look at the data around this
    entry in an attempt to understand the activity.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们正在寻找16位大端字符。在这个案例中，从结果中提取了两个示例。在一个示例中，偏移量0xC42404处清楚显示了一些与芝加哥相关的活动。调查者可以简单地打开一个十六进制编辑器，跳转到偏移量0xC42404，查看这个条目周围的数据，试图理解这一活动。
- en: Equally interesting is the next entry at offset 0x1943020 that references the
    [bearshare.com](http://bearshare.com) web site and has what appears to be a time
    stamp. If we convert the number 1295219345 into a date/time based on Unix Epoch,
    we get Sunday, 16 Jan 2011 23:09:05 GMT. Again, the examiner would need to examine
    the data more closely to validate any findings, but a good hypothesis is that
    some web-based activity took place on the Android device at that time.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 同样有趣的是，偏移量0x1943020处的下一个条目引用了[bearshare.com](http://bearshare.com)网站，并且似乎有一个时间戳。如果我们把数字1295219345转换成基于Unix
    Epoch的日期/时间，我们得到的是2011年1月16日星期日23:09:05 GMT。同样，调查者需要更仔细地检查数据以验证任何发现，但一个好的假设是，在那时Android设备上发生了一些基于网络的活动。
- en: 'One final example (and the other encodings can be left as an exercise for the
    reader) reveals the following:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个例子（其他编码留给读者作为练习）揭示了以下内容：
- en: '![image](img/F10007Xu07-15-9781597496513.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-15-9781597496513.jpg)'
- en: 'This is a great example because it includes not only a (valid) longitude and
    latitude, but a time stamp (in milliseconds, not seconds, since 1970) that translates
    to GMT: Sat, 30 Oct 2010 20:20:18 GMT.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个很好的例子，因为它不仅包含了一个（有效的）经度和纬度，还包含了一个时间戳（以毫秒为单位，自1970年以来，不是秒），它转换为GMT时间：Sat,
    30 Oct 2010 20:20:18 GMT。
- en: Strings is a very powerful command which, when combined with searching and filters,
    can quickly determine if phone numbers, names, locations, GPS coordinates, dates,
    and many more pieces of information are easily extractable in a data file.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: Strings是一个非常强大的命令，当与搜索和过滤器结合使用时，可以快速确定数据文件中是否容易提取电话号码、姓名、位置、GPS坐标、日期以及更多信息。
- en: 'Hex: A Forensic Analyst’s Good Friend'
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 十六进制：法医分析师的好朋友
- en: In many forensic investigations, a logical acquisition or a logical file system
    analysis from a physical acquisition will provide more than enough data for the
    case. However, certain cases require a deeper analysis to find deleted data or
    unknown file structures. This is also necessary when the file system has little
    or no support in standard forensic tools, such as YAFFS2.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在许多法医调查中，从物理获取的逻辑获取或逻辑文件系统分析将提供足够的数据。然而，某些案件需要深入分析以找到已删除的数据或未知文件结构。当文件系统在标准法医工具中几乎没有或没有支持时，这也同样必要，例如YAFFS2。
- en: Understandably, many forensic analysts would prefer to not perform a deeper
    analysis because it requires significant time, is extremely tedious, and requires
    a fairly deep understanding and curiosity of data structures. However, the results
    from this type of analysis are often quite amazing. Important information about
    that individual case is learned, and this knowledge is generally applicable to
    many cases in the future.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 可以理解，许多法医分析师宁愿不对数据进行深入分析，因为这需要大量的时间，非常繁琐，并且需要对数据结构有相当深入的理解和好奇心。然而，这种分析得出的结果常常非常惊人。可以了解到有关该案件的重要信息，而且这些知识通常可以应用于未来的许多案件。
- en: For these reasons, every forensic analyst should be comfortable using a hex
    editor should the need arise. This allows the analysts to see exactly what data
    are being stored, look for patterns, and perhaps identify deleted or previously
    understood data structures.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这些原因，每个法医分析师都应该熟练使用十六进制编辑器，以备不时之需。这使分析师能够确切地看到正在存储哪些数据，寻找模式，并可能识别已删除或以前未理解的数据结构。
- en: 'Of course, let’s explain this better with an example. First, make sure you
    install the following package on your Ubuntu workstation:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，让我们用一个例子来更好地解释这一点。首先，确保在你的Ubuntu工作站上安装以下软件包：
- en: '![image](img/F10007Xu07-16-9781597496513.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-16-9781597496513.jpg)'
- en: 'This is a very fast curses (terminal)-based hex editor. Of course, you can
    use any hex editor that is comfortable. Next, let’s use the strings command to
    look at the mmssms.db file which is located in the /data/data/com.android.providers.telephony/databases
    directory to see if we can find some deleted text messages. In this sample case,
    it is known that text messages to 3128781100 were deleted from the device. First,
    let’s use strings to see if we find that phone number in the SQLite file:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个非常快速的基于curses（终端）的十六进制编辑器。当然，你可以使用任何你觉得舒适的十六进制编辑器。接下来，让我们使用strings命令查看位于/data/data/com.android.providers.telephony/databases目录下的mmssms.db文件，看看我们是否能找到一些已删除的短信。在这个示例案例中，已知设备上删除了发送到3128781100的短信。首先，让我们使用strings命令看看是否能在这个SQLite文件中找到那个电话号码：
- en: '![image](img/F10007Xu07-17-9781597496513.jpg)'
  id: totrans-111
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-17-9781597496513.jpg)'
- en: 'In this command, we use the pipe (“|”) operator, which takes the output from
    one command and sends it to the next command. In this way we can link many commands
    together and get very powerful analysis techniques on the fly. Thus, the above
    command does the following:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个命令中，我们使用了管道（“|”）操作符，它将一个命令的输出传递给下一个命令。通过这种方式，我们可以将许多命令连接在一起，即时获得非常强大的分析方法。因此，上述命令执行了以下操作：
- en: 1. Runs the strings command on the SQLite database.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 在SQLite数据库上运行strings命令。
- en: 2. Takes the output of the strings command and runs it through the grep program,
    which filters the output-based patterns provided. In this case, we provide the
    phone number in question. However, you can create very powerful search strings
    for grep including regular expressions.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 将strings命令的输出通过grep程序运行，该程序基于提供的模式过滤输出。在这种情况下，我们提供了有疑问的电话号码。然而，你可以为grep创建非常强大的搜索字符串，包括正则表达式。
- en: 3. Take the output from the grep command and see how many lines are returned
    by piping the output to the word count program (“wc”) and instructing it to count
    by line instead of by word.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 将grep命令的输出传递给单词计数程序（“wc”），并指示它按行而不是按单词计数，以查看返回了多少行。
- en: 'The result is that 417 entries for that phone number were found; obviously
    indicating that there was indeed communication with the phone number on that device.
    We next want to take a close look at the messages, so instead of piping the output
    to the wc program, let’s look at the results directly and include one line of
    text after the phone number by adding the option “-A 1” to grep (also, we pipe
    the output to the “less” command to display it one page at a time):'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是，找到了针对该电话号码的417条记录；显然表明确实与该设备上的电话号码进行了通信。接下来，我们想仔细查看这些消息，因此不是将输出传递给wc程序，而是直接查看结果，并在电话号码后添加“-A
    1”选项来包含一行文本（另外，我们将输出传递给“less”命令，以一次显示一页）：
- en: '![image](img/F10007Xu07-18-9781597496513.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-18-9781597496513.jpg)'
- en: Thus, we know we have an SQLite database with the targeted number and messages.
    Let’s use SQLite3 to better understand the database. Here we will use command
    line (covered in [Chapter 4](CHP004.html)) but you can use a SQLite viewer with
    a graphical front end if you prefer.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们知道有一个SQLite数据库，其中包含目标号码和消息。让我们使用SQLite3来更好地了解数据库。这里我们将使用命令行（[第4章](CHP004.html)介绍）进行操作，但如果你愿意，也可以使用带有图形界面的SQLite查看器。
- en: Tip
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 提示
- en: SQLite language reference
  id: totrans-120
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: SQLite语言参考
- en: While we have mentioned several SQLite tools throughout this book, you may find
    the SQLite language reference at [http://www.sqlite.org/lang.html](http://www.sqlite.org/lang.html)
    to be a great resource. For those not familiar with SQL, it provides a thorough
    overview. If you already have an understanding of SQL, this language reference
    will help explain, as the page title reads, “SQL as Understood by SQLite.”
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管本书中提到了多个SQLite工具，但您可能会发现[http://www.sqlite.org/lang.html](http://www.sqlite.org/lang.html)的SQLite语言参考是一个极佳的资源。对于不熟悉SQL的人来说，它提供了全面的概述。如果您已经了解SQL，这个语言参考将有助于解释，正如页面标题所说，“SQLite理解的SQL”。
- en: '![image](img/F10007Xu07-19a-9781597496513.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-19a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-19b-9781597496513.jpg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-19b-9781597496513.jpg)'
- en: 'In the above SQLite3 sessions, the following commands were run to better understand
    the data:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述SQLite3会话中，运行了以下命令以更好地理解数据：
- en: '1. SQLite3 mmssms.db: Opens database for querying.'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '1. SQLite3 mmssms.db: 打开数据库以进行查询。'
- en: '2. .tables: Lists the tables in the database.'
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: '2. .tables: 列出数据库中的表。'
- en: '3. .schema sms: Focuses on the sms table, asks database for the structure (schema)
    of the table. The schema was quite long and was truncated.'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: '3. .schema sms: 关注sms表，请求数据库提供表的结构（架构）。架构相当长，因此被截断了。'
- en: '4. .mode line: Sets the display mode to line for easier viewing.'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: '4. .mode line: 将显示模式设置为行，以便更容易查看。'
- en: '5. “select ∗ from sms limit 1;”: Instructs SQLite3 to display one record to
    the screen (limit one) from the sms table showing all columns.'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: '5. “select ∗ from sms limit 1;”: 指示SQLite3从sms表显示一条记录到屏幕上（限制一条），显示所有列。'
- en: '6. .quit: Exits the program'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: '6. .quit: 退出程序'
- en: 'Thus, we can now see that there are a number of fields in the sms table, but
    that after the phone number, there is a personal ID followed by the time stamp.
    Using a hex editor, let’s see if we can determine the date/time stamp from the
    message about the phone being activated. First, let’s open the mmssms.db in the
    hex editor we just installed:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们现在可以看到sms表中有很多字段，但在电话号码之后是一个个人ID，然后是时间戳。使用十六进制编辑器，让我们确定一下从关于电话激活的消息中是否能确定日期/时间戳。首先，让我们在刚才安装的十六进制编辑器中打开mmssms.db：
- en: '![image](img/F10007Xu07-20-9781597496513.jpg)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-20-9781597496513.jpg)'
- en: 'This will then show you the beginning of the file in box hex as well as the
    printable ASCII strings in the right column:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 这将显示文件开头的框状十六进制以及右侧的可打印ASCII字符串：
- en: '![image](img/F10007Xu07-21-9781597496513.jpg)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-21-9781597496513.jpg)'
- en: 'We can press Control-T (^T) to jump to an offset in the file. In this case,
    the previous strings command included the “--radix=x,” so we have the offset in
    hex (0x12108), so time to search:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以按Ctrl-T (^T)跳转到文件中的偏移量。在这种情况下，前面的strings命令包括了“--radix=x”，因此我们有十六进制的偏移量（0x12108），是时候搜索了：
- en: '![image](img/F10007Xu07-22-9781597496513.jpg)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-22-9781597496513.jpg)'
- en: 'The hex editor is extremely responsive and jumps to the offset:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 十六进制编辑器非常响应迅速，跳转到偏移量：
- en: '![image](img/F10007Xu07-23-9781597496513.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-23-9781597496513.jpg)'
- en: 'Looking at the hex data above, we can see the phone number and it ends at 0x12111\.
    After that, we should see a person field, as it is the next column as specified
    in the table design (also called the table schema). If the person field is set,
    it links to the contact table to provide details on the person involved. In this
    case, no person was set, so SQLite does not record anything. Finally, we look
    at the next six bytes and we get 0x012AFC97C52C. When translated to decimal, the
    resulting number is 1284138059052\. Finally, we can use a number of techniques
    to convert this time (Unix Epoch in milliseconds) to a more easily read date/time.
    One quick technique for this is to use the built-in date command. However, it
    only handles Unix Epoch in seconds, not milliseconds, so you can simply divide
    by 1000 (that is, omit the last three digits):'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 从上面的十六进制数据中，我们可以看到电话号码，并在0x12111结束。在那之后，我们应该看到一个person字段，因为它是表设计中指定的下一个列（也称为表架构）。如果设置了person字段，它会链接到联系人表，以提供涉及人员详细信息。在这种情况下，没有设置person，所以SQLite没有记录任何内容。最后，我们查看接下来的六个字节，得到0x012AFC97C52C。转换为十进制后，得到的数字是1284138059052。最后，我们可以使用多种技术将这个时间（以毫秒为单位的Unix纪元时间）转换为更易于阅读的日期/时间。对于这种情况，一个快速的技术是使用内置的date命令。然而，它只能处理以秒为单位的Unix纪元时间，而不是毫秒，所以你可以简单地将数字除以1000（即省略最后三位数字）：
- en: '![image](img/F10007Xu07-24-9781597496513.jpg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-24-9781597496513.jpg)'
- en: The date command automatically displays the date in the current system time
    zone. Another quick way to convert the time is to use the web site designed to
    convert Unix Epoch time at [http://www.epochconverter.com/](http://www.epochconverter.com/)
    that handles both Unix Epoch in seconds and milliseconds ([Epoch Converter, n.d.](#BIB7)).
    To convert, copy the entire time stamp (not necessary to divide by 1000) into
    the web site text box and click “Timestamp to Human date” as in [Fig. 7.2](#F0015).
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: date命令会自动以当前系统时区显示日期。另一种快速转换时间的方法是使用设计用于转换Unix纪元时间的网站[http://www.epochconverter.com/](http://www.epochconverter.com/)，它支持以秒和毫秒为单位的Unix纪元时间（[Epoch
    Converter, n.d.](#BIB7)）。要转换，将整个时间戳（无需除以1000）复制到网站文本框中，然后点击“Timestamp to Human
    date”，如图7.2所示。
- en: '![image](img/F10007Xf07-02-9781597496513.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xf07-02-9781597496513.jpg)'
- en: FIGURE 7.2 Time conversion on [http://www.epochconverter.com/](http://www.epochconverter.com/).
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.2 在[http://www.epochconverter.com/](http://www.epochconverter.com/)上的时间转换。
- en: One final time stamp conversion technique to mention is the free utility DCode
    by Digital Detective, a digital forensic software company based in the United
    Kingdom. DCode supports many formats ([Digital Detective, n.d.](#BIB6)) and can
    covert from milliseconds as shown in [Fig. 7.3](#F0020).
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个要提及的时间戳转换技术是由英国数字取证软件公司Digital Detective提供的免费工具DCode。DCode支持许多格式（[Digital
    Detective, n.d.](#BIB6)）并且如[图7.3](#F0020)所示，可以转换毫秒。
- en: '![image](img/F10007Xf07-03-9781597496513.jpg)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xf07-03-9781597496513.jpg)'
- en: FIGURE 7.3 DCode time conversion utility by Digital Detective.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.3 Digital Detective的DCode时间转换工具。
- en: This example is simply intended to illustrate the importance of data that might
    only be accessible if the forensic analyst moves beyond the forensic software
    they use and also examines the data directly. With well-known file systems and
    perhaps “standard” cases, this is often not necessary. However, mobile forensics,
    and Android forensics in particular, is a challenging area as many of the file
    formats, file systems, hardware, and software are not only very new (and not well
    supported) but also change at an alarming rate. Forensic analysts who dive into
    hex will find they uncover far more data than simply relying on existing forensic
    software.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 这个例子仅仅是为了说明如果取证分析师超越他们使用的取证软件，直接检查数据，那么可能只有这样才能访问到数据的重要性。对于知名的文件系统和“标准”案例，通常并不需要这样做。然而，移动取证，尤其是Android取证是一个具有挑战性的领域，因为许多文件格式、文件系统、硬件和软件不仅非常新（支持不佳），而且变化速度惊人。深入十六进制的取证分析师会发现，他们揭露的数据远比仅仅依赖现有取证软件要多。
- en: Android Directory Structures
  id: totrans-148
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Android目录结构
- en: A broad understanding of the Android directory structure is very helpful in
    the forensic analysis of a device. To perform this analysis, five important root
    level directories were copied from the HTC Incredible and then displayed with
    the tree command on the local workstation. Following the hierarchical layout,
    an explanation of many directories is provided.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 对Android目录结构有一个广泛的理解对于设备的取证分析非常有帮助。为了进行这项分析，从HTC Incredible复制了五个重要的根级目录，然后在本地工作站上使用tree命令显示。按照层次结构布局，提供了许多目录的解释。
- en: '![image](img/F10007Xu07-25a-9781597496513.jpg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-25a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-25b-9781597496513.jpg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-25b-9781597496513.jpg)'
- en: 'Line 1: At the top is the root directory, which creates the structure and mount
    points for the other file systems explored previously.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 第1行：顶部是根目录，它创建了其他文件系统的结构和挂载点，这些文件系统之前已经探讨过。
- en: 'Line 2: As previously discussed, the HTC Incredible created an “/app-cache”
    directory of type tmpfs. You can see the browser cache structure. Presumably,
    over time, other apps may leverage this directory.'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 第2行：如前所述，HTC Incredible创建了一个类型为tmpfs的“/app-cache”目录。你可以看到浏览器缓存的结构。据推测，随着时间的推移，其他应用可能会利用这个目录。
- en: 'Lines 6–8: Android devices from the start had a dedicated “/cache” directory
    that originally appeared to be unused. However, this is certainly not the case
    and the “/cache” partition should be imaged for full analysis. Files including
    Gmail attachment previews, Browser DRM, some downloads (Market and other), as
    well as Over The Air (OTA) updates from the wireless carriers can be found here.'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 第6-8行：从一开始，Android设备就有一个专门的“/cache”目录，最初看似未被使用。然而，实际情况并非如此，应该对“/cache”分区进行完整分析。这里可以找到包括Gmail附件预览、浏览器DRM、一些下载（市场和其它）以及来自无线运营商的OTA更新文件。
- en: 'Line 9: The root level “/data” directory has a number of important subdirectories
    covered next. Note that some phones (such as the HTC Incredible) have a dedicated
    partition for the “/data/data” subdirectory.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 第9行：根级别的“/data”目录有许多重要的子目录，将在下一步介绍。请注意，一些手机（如HTC Incredible）为“/data/data”子目录分配了一个专用的分区。
- en: 'Line 10: The “/data/anr” directory contains stack traces (debugging) from the
    system and is generally not accessible to the shell user. However, some of the
    adb debug commands appear to read this data.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 第10行：" /data/anr"目录包含了来自系统的堆栈跟踪（调试信息），通常对shell用户不可访问。然而，一些adb调试命令似乎可以读取这些数据。
- en: 'Line 11: The “/data/app” directory contains the .apk files from the Android
    Market.'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 第11行：" /data/app"目录包含了来自Android市场的.apk文件。
- en: 'Line 12: The “/data/app-private” directory stores protected apps from the Android
    Market.'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 第12行：" /data/app-private"目录用于存储来自Android市场的受保护应用。
- en: 'Line 13: More recent versions of Android have a secure cloud backup API that
    developers can integrate into their apps. The “/data/backup” directory is used
    to queue and manage these backups. However, thus far meaningful data has not been
    recovered from directory.'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 第13行：较新版本的Android有一个安全的云备份API，开发者可以将其集成到他们的应用中。" /data/backup"目录用于排队和管理这些备份。然而，到目前为止，还没有从该目录恢复有意义的数据。
- en: 'Line 14: The “/data/btips” (Texas Instrument’s Bluetooth Protocol Stack) directory
    stores the log files if the associated app (com.ti.btips) crashes.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 第14行：" /data/btips"（德州仪器的蓝牙协议栈）目录存储了相关应用（com.ti.btips）崩溃时的日志文件。
- en: 'Line 15: The “/data/davlik-cache” directory contains the Davlik VM’s cached
    dex files used to run apps.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 第15行：" /data/davlik-cache"目录包含了Davlik VM用于运行应用的缓存dex文件。
- en: 'Line 16: The “/data/data directory” contains the application specific data,
    easily the most important area to focus on in an investigation.'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 第16行：" /data/data"目录包含了应用特定的数据，这无疑是调查中需要重点关注的最重要的区域。
- en: 'Lines 17–23: One app was kept in the directory hierarchy for demonstration
    purposes. The directory is named according to the package name and often clearly
    identifies the developer (Facebook in this case).'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 第17-23行：出于演示目的，在目录层次结构中保留了一个应用。该目录根据包名命名，通常可以清晰地识别开发者（在本例中是Facebook）。
- en: 'Line 24: For HHGTTG fans (famous advice to intergalactic travelers from the
    classic novel *The Hitchhiker’s Guide to the Galaxy:* DON’T PANIC), there’s a
    great directory named “/data/dontpanic,” which is simply a place to store some
    error log files from the system. Again, a great benefit of an open system is the
    ability to examine code. Short of that, we would have simply had to guess the
    purpose or perform significant testing. From the AOSP:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 第24行：对于《银河系漫游指南》（*The Hitchhiker’s Guide to the Galaxy*）的粉丝（这部经典小说给星际旅行者的著名建议是：不要恐慌），有一个名为“/data/dontpanic”的目录非常有趣，它只是用来存储系统的一些错误日志文件的地方。再次，开放系统的优点是可以检查代码。如果不是这样，我们就只能猜测其用途或进行大量的测试。以下是AOSP的内容：
- en: '![image](img/F10007Xu07-26a-9781597496513.jpg)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-26a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-26b-9781597496513.jpg)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-26b-9781597496513.jpg)'
- en: 'Line 25: The “/data/local” directory is important as it allows shell (the user
    account nonrooted phones run adbd as) read/write access. When an app is installed,
    it is first copied to “/data/local.” Also, some forensic techniques rely on this
    directory to upload important files, typically binaries.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 第25行：`/data/local`目录非常重要，因为它允许shell（非root手机运行adbd的用户账户）具有读写权限。安装应用时，首先将其复制到`/data/local`目录。此外，一些取证技术依赖此目录上传重要文件，通常是二进制文件。
- en: 'Line 26: The “/data/lost+found” directory shows up in several places in YAFFS2
    file systems. Again, a quick search (try “grep -R lost+found ∗.c” from the YAFFS2
    source directory we downloaded) will explain that any files or directories found
    that do not have a path to the root directory will be placed in this folder.'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 第26行：`/data/lost+found`目录在YAFFS2文件系统的多个位置出现。再次，快速搜索（尝试从我们下载的YAFFS2源代码目录中使用“grep
    -R lost+found ∗.c”）将解释任何没有到根目录路径的文件或目录都将被放置在此文件夹中。
- en: '![image](img/F10007Xu07-27-9781597496513.jpg)'
  id: totrans-169
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-27-9781597496513.jpg)'
- en: 'Lines 27–35: The “/data/misc” directory contains files related to Bluetooth,
    dhcp, vpn, Wi-Fi, and more. One important file to point out is “/data/misc/wifi/wpa_supplicant.conf”
    that contains a list of [Wi-Fi.com](http://Wi-Fi.com) networks to which the device
    got connected. If the wireless access point required a password, it is stored
    in plain text in the file (have fun pen testers). Here’s a partial listing:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 第27-35行：`/data/misc`目录包含与蓝牙、dhcp、vpn、Wi-Fi等相关的文件。其中一个重要的文件是`/data/misc/wifi/wpa_supplicant.conf`，其中包含设备连接过的[Wi-Fi.com](http://Wi-Fi.com)网络的列表。如果无线接入点需要密码，该文件将以明文形式存储密码（渗透测试人员可以好好利用）。以下是部分列表：
- en: '![image](img/F10007Xu07-28a-9781597496513.jpg)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-28a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-28b-9781597496513.jpg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-28b-9781597496513.jpg)'
- en: 'Line 36: The “/data/property” directory contains various system properties
    such as time zone, country, and language.'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 第36行：`/data/property`目录包含各种系统属性，如时区、国家和语言。
- en: 'Line 37: Beyond the subdirectories you can see /data/system contains several
    key files. First, the accounts.db contains a list of accounts that require authentication
    and provides the name, type, password (encrypted), and authentication tokens (among
    other data). There are also two very important files related to the pass code
    or PIN for the device. The files are gesture.key and password.key and contain
    an encoded/encrypted hex value for the pass code.'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 第37行：除了子目录，你可以看到`/data/system`包含几个关键文件。首先，accounts.db包含需要身份验证的账户列表，并提供名称、类型、密码（加密）和认证令牌（以及其他数据）。还有两个与设备密码或PIN码相关的非常重要的文件。这些文件是gesture.key和password.key，它们包含密码的编码/加密十六进制值。
- en: 'Line 43: When a process crashes, a special tombstone file can be created. The
    file is ASCII and thus readable. More information can be found online such as
    one informative post on [Crazydaks.com](http://Crazydaks.com) ([Debugging in Android,
    n.d.](#BIB4)).'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 第43行：当进程崩溃时，会创建一个特殊的墓碑文件。该文件为ASCII格式，因此可读。更多信息可以在网上找到，例如[Crazydaks.com](http://Crazydaks.com)上的一篇有信息性的帖子（[在Android中调试，n.d.](#BIB4)）。
- en: 'Line 44: The “/mnt” directory is where the system mounts various file systems,
    including the SD card, the eMMC, and others.'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 第44行：`/mnt`目录是系统挂载各种文件系统的地方，包括SD卡、eMMC等。
- en: 'Line 45: The “/mnt/asec” directory contains the unencrypted apps that are stored
    on the SD card. When Android introduced the ability to store apps on the SD card,
    they encrypted the contents for security reasons. However, when the system is
    up and running and unencrypted access to the files is necessary, they are decrypted
    and mounted in “/mnt/asec.”'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 第45行：`/mnt/asec`目录包含存储在SD卡上的未加密应用。当Android引入在SD卡上存储应用的功能时，出于安全原因对内容进行了加密。然而，当系统运行并需要访问未加密的文件时，这些文件将在`/mnt/asec`中被解密并挂载。
- en: 'Line 46: The “/mnt/emmc” contains the FAT32 file system that resides on the
    NAND flash for some devices. Lines 47 through 55 are several examples of eMMC
    subdirectories.'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 第46行：`/mnt/emmc`包含一些设备上的NAND闪存上的FAT32文件系统。第47至55行是几个eMMC子目录的示例。
- en: 'Line 51: The “/mnt/emmc/DCIM directory,” album thumbnails are stored here.'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 第51行：`/mnt/emmc/DCIM`目录，相册缩略图存储在这里。
- en: 'Line 52: The “/mnt/emmc/DCIM/100MEDIA” directory contains any pictures or videos
    taken by the HTC Incredible.'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 第52行：`/mnt/emmc/DCIM/100MEDIA`目录包含由HTC Incredible拍摄的照片或视频。
- en: 'Line 53: The “/mnt/emmc/LOST.DIR” directories are found on FAT32 partitions
    and may contain files or fragments that the file system lost track of (similar
    to YAFFS2 lost+found directory). This directory should be examined.'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 行53：在FAT32分区上可以找到"/mnt/emmc/LOST.DIR"目录，其中可能包含文件系统失去追踪的文件或片段（类似于YAFFS2的lost+found目录）。应该检查这个目录。
- en: 'Line 56: If a physical SD card is present, it is mounted at “/mnt/sdcard.”'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 行56：如果存在物理SD卡，它将被挂载在"/mnt/sdcard"。
- en: 'Line 66: As with the eMMC, the “/mnt/sdcard/dcim” directory would store pictures
    and videos from the device. On the HTC Incredible, they are stored in “/mnt/emmc/DCIM,”
    so they are not present on the physical SD card.'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 行66：与eMMC类似，"/mnt/sdcard/dcim"目录用于存储设备中的图片和视频。在HTC Incredible上，它们存储在"/mnt/emmc/DCIM"中，因此并不在物理SD卡上。
- en: 'Lines 67–68: The “/mnt/sdcard/download” and “/mnt/sdcard/Downloads” directories
    contain files downloaded by the browser, e-mail clients, and others.'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 行67-68："/mnt/sdcard/download"和"/mnt/sdcard/Downloads"目录包含浏览器、电子邮件客户端等下载的文件。
- en: 'Line 72: As mentioned previously, the “/mnt/sdcard/secure/asec” directory is
    encrypted and is where apps that reside on the SD card (instead of the NAND flash)
    store data.'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 行72：如前所述，"/mnt/sdcard/secure/asec"目录是加密的，那些位于SD卡上（而不是NAND闪存）的应用程序会在此存储数据。
- en: 'Line 75: The “/system/app” directory contains .apk app files for apps that
    are provided with the system. This includes apps bundled by Google/Android, the
    manufacturer (HTC in this case), and the wireless carrier (Verizon in this case).
    In the case of the HTC Incredible, the directory contains a significant 152 .apk
    files. It’s important to know this location in case app analysis is required for
    a case (which means you need access to the apk file). The .apk files present on
    the reference HTC Incredible were:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 行75："/system/app"目录包含与系统一起提供的.apk应用文件。这包括由Google/Android、制造商（在本例中为HTC）和无线运营商（在本例中为Verizon）捆绑的应用。在HTC
    Incredible的情况下，该目录包含一个重要的152个.apk文件。在需要对案件进行应用分析时（这意味着你需要访问apk文件），了解这个位置很重要。参考HTC
    Incredible上存在的.apk文件包括：
- en: '![image](img/F10007Xu07-29-9781597496513.jpg)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-29-9781597496513.jpg)'
- en: 'Lines 76 and 117: The “/system/bin” and “/system/xbin” directories contain
    the Android binary files used on the system. Forensic analysts and security engineers
    (and most definitely Android researchers) can find many useful and undocumented
    commands by experimenting with files in these directories.'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 行76和117："/system/bin"和"/system/xbin"目录包含系统上使用的Android二进制文件。法医分析师和网络安全工程师（以及无疑的Android研究人员）可以通过实验这些目录中的文件，找到许多有用且未记录的命令。
- en: 'Lines 77–80: The “/system/customize” directories contain carrier-specific customizations
    for the phone, notably UI.'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 行77-80："/system/customize"目录包含针对手机的运营商特定定制，尤其是UI。
- en: 'Line 81: The “/system/etc” directory is where Android stores the typical Linux/Unix
    configuration (/etc) directory. It contains numerous configuration files worthy
    of examination—too many to discuss in this book—but can vary from device to device.'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 行81："/system/etc"目录是Android存储典型的Linux/Unix配置(/etc)目录的地方。它包含许多值得检查的配置文件——本书中无法一一讨论——但会因设备而异。
- en: There are far more directories and files to explore but the above overview provides
    a good starting point.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 有更多目录和文件等待探索，但上述概览提供了一个很好的起点。
- en: FAT forensic analysis
  id: totrans-192
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: FAT法医分析
- en: The SD card can be a gold mine for forensic investigators. All the multimedia
    that has been synced with the phone, or taken with the phone’s camera, is stored
    here. Items such as pictures, videos, voice recordings, application data, music,
    Google Map data, and potentially complete backup files from backup apps that use
    the SD card for storage are recoverable. In addition, investigators can also find
    cached mms image thumbnails, trash information relating to deleted objects, and
    downloaded application APKs.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: SD卡对法医调查人员来说可能是一座金矿。所有与手机同步的多媒体，或者用手机相机拍摄的内容，都存储在这里。可以恢复的项目包括图片、视频、语音录音、应用数据、音乐、Google地图数据，以及可能使用SD卡存储的备份应用生成的完整备份文件。此外，调查人员还可以找到缓存的彩信图片缩略图、与已删除对象相关的垃圾信息，以及下载的应用APK文件。
- en: For example, a typical user might use Google Maps to obtain driving directions
    to a local shopping center. Through forensic examination of the “com.google.android.apps.maps/cache”
    directory on the SD card, we are able to recover map image tiles and navigation
    voice prompts. These voice prompts are also stamped with a date and time, so a
    forensic investigator can literally retrace the location of that device for a
    given time and date.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，一个典型的用户可能会使用 Google 地图获取到当地购物中心的驾车指南。通过在 SD 卡上对“com.google.android.apps.maps/cache”目录进行取证检查，我们能够恢复地图图像块和导航语音提示。这些语音提示也带有日期和时间戳，因此取证调查员可以字面上根据给定的日期和时间追溯设备的位置。
- en: 'Here’s what it looks like after a short trip within a Chicago suburb:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 在芝加哥郊区短暂旅行后，它看起来像这样：
- en: '![image](img/F10007Xu07-30-9781597496513.jpg)'
  id: totrans-196
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-30-9781597496513.jpg)'
- en: It is also important to remember that SD cards can be mounted through Android
    as an external mass storage device. This allows the user to transfer any files
    between the SD card and his or her personal computer.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 还需要记住，SD 卡可以通过 Android 作为外部大容量存储设备挂载。这使得用户可以在 SD 卡和个人电脑之间传输任何文件。
- en: In [Chapter 6](CHP006.html), we demonstrated how to acquire the two current
    FAT32 partitions on Android devices that contain data. There are many books and
    articles which cover the analysis of FAT32 file systems and this section will
    not attempt to cover those again in detail. However, this section will demonstrate
    some techniques for examining the FAT32 partitions found on Android devices using
    the Ubuntu workstation.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第6章](CHP006.html)中，我们演示了如何获取包含数据的 Android 设备上的两个当前 FAT32 分区。有许多书籍和文章涵盖了 FAT32
    文件系统的分析，本节将不再详细重复这些内容。但是，本节将展示一些使用 Ubuntu 工作站对 Android 设备上发现的 FAT32 分区进行检查的技术。
- en: FAT Timeline Analysis
  id: totrans-199
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: FAT 时间线分析
- en: To build a file system timeline of a FAT32 image, we utilize both The Sleuth
    Kit (TSK) and another great open source forensic tool called log2timeline. The
    log2timeline utility, written by Kristinn Gudjonsson, is a framework for automatic
    creation of a timeline that encompasses various log files and artifacts found
    on the system. log2timeline can be utilized on many systems and does an excellent
    job at extracting time stamp information for many file formats for analysis.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 为了构建一个 FAT32 映像的文件系统时间线，我们同时使用 The Sleuth Kit（TSK）和另一个名为 log2timeline 的优秀开源取证工具。由
    Kristinn Gudjonsson 编写的 log2timeline 工具是一个自动创建时间线的框架，包括系统上各种日志文件和发现的工件。log2timeline
    可在许多系统上使用，并且在提取多种文件格式的的时间戳信息以进行分析方面做得非常出色。
- en: As we already have TSK setup, we need to take a few steps to install log2timeline.
    First, it has probably been a while since you first built the Ubuntu workstation
    so it is a good idea to update any packages which have newer versions and often
    contain security patches or bug fixes.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经设置了 TSK，我们需要采取几个步骤来安装 log2timeline。首先，自从你第一次构建 Ubuntu 工作站以来可能已经有一段时间了，因此更新任何有新版本并且通常包含安全补丁或错误修复的软件包是一个好主意。
- en: '![image](img/F10007Xu07-31-9781597496513.jpg)'
  id: totrans-202
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-31-9781597496513.jpg)'
- en: The first step updates your software list and the second will actually perform
    the upgrade. Next, we’ll install log2timeline, which Kristinn has greatly simplified
    by creating a Ubuntu package for his software.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 第一步更新了你的软件列表，第二步将实际执行升级。接下来，我们将安装 log2timeline，Kristinn 通过为他的软件创建了一个 Ubuntu
    软件包，极大地简化了这一过程。
- en: '![image](img/F10007Xu07-32-9781597496513.jpg)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-32-9781597496513.jpg)'
- en: 'The four commands do the following:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 这四个命令执行以下操作：
- en: 1. Add the log2timeline custom software repository to the Ubuntu workstations
    overall list.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 将 log2timeline 自定义软件仓库添加到 Ubuntu 工作站的总体列表中。
- en: 2. Download the public key used to validate the software and add to the list
    of accepted keys.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 下载用于验证软件的公钥并将其添加到接受密钥列表中。
- en: 3. Update the software packages list.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 更新软件包列表。
- en: 4. Install log2timeline.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 安装 log2timeline。
- en: For this analysis, we are going to use the forensic image of the 2 GB SD card
    we imaged in [Chapter 6](CHP006.html). First, the examiner should always ensure
    that the hash signature of the image matches with the hash taken during forensic
    imaging to ensure the image is valid.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进行分析，我们将使用在[第6章](CHP006.html)中成像的 2 GB SD 卡的取证映像。首先，检查员应始终确保映像的哈希签名与取证成像期间获取的哈希相匹配，以确保映像是有效的。
- en: '![image](img/F10007Xu07-33-9781597496513.jpg)'
  id: totrans-211
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-33-9781597496513.jpg)'
- en: 'If you recall, the hash of the input device (/dev/sdc in this case) was e5dcc0af1d8a09c9af4d2db98f5f684d20a561666b9ff8df7c8b90a0b9d78770\.
    The forensic image is now validated. Next, let’s take a quick look at the file
    first with the file command:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你记得，输入设备（在本例中为/dev/sdc）的哈希值是e5dcc0af1d8a09c9af4d2db98f5f684d20a561666b9ff8df7c8b90a0b9d78770。取证镜像现在已验证。接下来，让我们先用file命令快速查看文件：
- en: '![image](img/F10007Xu07-34-9781597496513.jpg)'
  id: totrans-213
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-34-9781597496513.jpg)'
- en: 'So we are, in fact, dealing with a disk image with a valid partition. Next,
    we can examine the disk image further with TSK’s mmls:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们实际上是在处理一个带有有效分区的磁盘镜像。接下来，我们可以使用TSK的mmls进一步检查磁盘镜像：
- en: '![image](img/F10007Xu07-35-9781597496513.jpg)'
  id: totrans-215
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-35-9781597496513.jpg)'
- en: 'And finally TSK’s fsstat, but note that you have to provide a sector offset
    of 129 as the FAT partition starts there:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 最后是TSK的fsstat，但请注意，你必须提供一个扇区偏移量129，因为FAT分区从那里开始：
- en: '![image](img/F10007Xu07-36a-9781597496513.jpg)'
  id: totrans-217
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-36a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-36b-9781597496513.jpg)'
  id: totrans-218
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-36b-9781597496513.jpg)'
- en: 'In this case, the partition is a FAT16 partition with data on it. So, we are
    going to first build the timeline with TSK’s fls command:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 在此例中，分区是一个带有数据的FAT16分区。因此，我们首先要使用TSK的fls命令构建时间线：
- en: '![image](img/F10007Xu07-37-9781597496513.jpg)'
  id: totrans-220
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-37-9781597496513.jpg)'
- en: 'The options set have the following meaning:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 设置的选项具有以下含义：
- en: • -z CST6CDT—Sets time zone to CST6CDT for US Central Time
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: • -z CST6CDT—将时区设置为美国中部时间的CST6CDT
- en: • -s 0—Sets the time skew if one is known
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: • -s 0—如果已知时间偏移，则设置时间偏移
- en: • -m /mnt/sdcard—Prefaces the path with this value when writing out the body
    file
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: • -m /mnt/sdcard—在写入body文件时用这个值作为路径前缀
- en: • -f fat16—Sets file system to FAT16
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: • -f fat16—将文件系统设置为FAT16
- en: • -r—Recursively traverses all directories to build the timeline
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: • -r—递归遍历所有目录以构建时间线
- en: • -o 129—Sets the offset to 129 (a sector size of 512 bytes is assumed but can
    be changed with the -b option)
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: • -o 129—将偏移量设置为129（假定一个扇区大小为512字节，但可以使用-b选项更改）
- en: • -i raw—Sets the image type, in this case a raw image and not another forensic
    image format
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: • -i raw—设置镜像类型，在本例中为原始镜像，而不是其他取证镜像格式
- en: • ~/sd-emmc/viaforensics/af-book/sdcard2-113serialno/sdcard2-113serialno.dc3dd—Image
    file
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
  zh: • ~/sd-emmc/viaforensics/af-book/sdcard2-113serialno/sdcard2-113serialno.dc3dd—镜像文件
- en: • > ~/sdcard.body—Redirects the command’s output to a file instead of displaying
    on the screen
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: • > ~/sdcard.body—将命令的输出重定向到文件，而不是在屏幕上显示
- en: 'Often it is helpful to know how long a command takes (if nothing else, over
    time you learn when it’s best to go grab that coffee warmer). So, we preface fls
    with the time command, which will tell us how long the program took to run (real)
    and the various system time it took (user, sys). You can view the contents of
    the body file, but in a later step we will convert it to a more readable format.
    If you want to verify fls-returned results, you can always determine the total
    lines in the file:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 通常了解命令需要多长时间很有帮助（如果没有什么，随着时间的推移，你会知道什么时候去拿咖啡加热器最好）。因此，我们在fls前加上time命令，它会告诉我们程序运行了多长时间（实际）以及各种系统时间（用户，系统）。你可以查看body文件的内容，但在后续步骤中，我们将把它转换成更易读的格式。如果你想验证fls返回的结果，你总是可以确定文件中的总行数：
- en: '![image](img/F10007Xu07-38-9781597496513.jpg)'
  id: totrans-232
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-38-9781597496513.jpg)'
- en: 'So, we have just over 24,000 entries. Next, we need to mount the file system
    read-only and then we can run log2timeline against it. To mount the file system
    using the dd image, you use the mount command and a special device called the
    loopback device. The full command is as follows:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们刚刚超过了24,000个条目。接下来，我们需要以只读方式挂载文件系统，然后我们可以对其运行log2timeline。要使用dd镜像挂载文件系统，请使用mount命令和一个名为loopback的特殊设备。完整的命令如下：
- en: '![image](img/F10007Xu07-39-9781597496513.jpg)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-39-9781597496513.jpg)'
- en: 'Again, let’s look at each of the options set. First, this command requires
    administrator rights so we run with sudo. The options are then:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，让我们看看设置的每个选项。首先，此命令需要管理员权限，所以我们用sudo运行。选项如下：
- en: • -t vfat
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: • -t vfat
- en: • -o loop,ro,offset=66068—This tells mount to use the loopback device as we
    are using a physical file instead of an actual device. The ro mounts the e-mail
    as read-only. Finally, we have to tell mount where to find the partition. From
    the mmls command, you recall that the offset was a sector 129\. Mount does not
    know the sector size, so we calculate 129 × 512, which is equal to 66,048
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: • -o loop,ro,offset=66068—这告诉mount使用loopback设备，因为我们使用的是物理文件而不是实际的设备。ro以只读方式挂载电子邮件。最后，我们必须告诉mount在哪里找到分区。从mmls命令中，你记得偏移量是扇区129。Mount不知道扇区大小，所以我们计算129×512，等于66,048
- en: • ~/sd-emmc/viaforensics/af-book/sdcard2-113serialno/sdcard2-113serialno.dc3dd—The
    dd images
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: • ~/sd-emmc/viaforensics/af-book/sdcard2-113serialno/sdcard2-113serialno.dc3dd—dd镜像文件
- en: • ~/mnt/sdcard—Where to mount the image
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: • ~/mnt/sdcard—挂载镜像的位置
- en: 'We can validate that the file system is mounted by executing the mount command
    with no options, which returns the list of all mounted file systems. We pipe this
    through grep to isolate the file system we are looking for:'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过执行不带选项的mount命令来验证文件系统是否已挂载，这将返回所有已挂载文件系统的列表。我们通过grep管道来隔离我们要查找的文件系统：
- en: '![image](img/F10007Xu07-40-9781597496513.jpg)'
  id: totrans-241
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-40-9781597496513.jpg)'
- en: 'So, we can see the vfat file system is mounted read-only using loopback device
    “/dev/loop0” and located at “/home/ahoog/mnt/sdcard.” You can see the total size
    with the df command:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以看到vfat文件系统通过环回设备“/dev/loop0”以只读方式挂载在“/home/ahoog/mnt/sdcard”位置。你可以使用df命令查看总大小：
- en: '![image](img/F10007Xu07-41-9781597496513.jpg)'
  id: totrans-243
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-41-9781597496513.jpg)'
- en: 'So, only 244 M of the 1.7 G available is in use. Now we are ready to use the
    timescanner program that comes with log2timeline to extract additional timeline
    information from the files. We will append the command output to the same body
    file as fls:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，在可用的1.7G中，只有244M被使用。现在我们准备使用与log2timeline一起提供的timescanner程序，从文件中提取额外的时间线信息。我们将把命令输出追加到与fls相同的正文文件中：
- en: '![image](img/F10007Xu07-42-9781597496513.jpg)'
  id: totrans-245
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-42-9781597496513.jpg)'
- en: 'The options for timescanner are as follows:'
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: timescanner的选项如下：
- en: • -d /home/ahoog/mnt/sdcard—Specify the directory to scan for time stamp artifacts
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: • -d /home/ahoog/mnt/sdcard—指定要扫描时间戳工件的目录
- en: • -z CST6CDT—Again set the time zone to U.S. Central Time
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: • -z CST6CDT—再次将时区设置为美国中部时间
- en: • >> sdcard.body—Append the output to the existing sdcard.body. Please note
    the double greater than sign (“>>”), which instructs the shell to append to the
    file (and if it does not exist, creates it). If you forget and use a single “>”,
    then you will overwrite the fls output.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: • >> sdcard.body—将输出追加到现有的sdcard.body。请注意双大于号（“>>”），它会指示shell将内容追加到文件中（如果文件不存在，则创建它）。如果你忘记并使用了单“>”，那么你会覆盖fls的输出。
- en: Timescanner only extracted 410 artifacts, which is far less than the number
    you would extract on a scan of an entire hard drive. However, the 410 artifacts
    will certainly help build the overall timeline for the device.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: Timescanner只提取了410个工件，这比扫描整个硬盘所提取的数量要少得多。但是，这410个工件肯定有助于构建设备的整体时间线。
- en: 'Finally, we can create an easy-to-read (and easy-to-share) comma separated
    values (csv) file of the timeline with TSK’s mactime command:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以使用TSK的mactime命令创建一个易于阅读（且易于分享）的时间线csv文件：
- en: '![image](img/F10007Xu07-43-9781597496513.jpg)'
  id: totrans-252
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-43-9781597496513.jpg)'
- en: 'The following options were passed to mactime:'
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 传递给mactime的选项如下：
- en: • -b sdcard.body—Specifies the body file to convert
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: • -b sdcard.body—指定要转换的正文文件
- en: • -z CST6CDT—Time zone
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: • -z CST6CDT—时区
- en: • -d—Output of the file in csv format
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: • -d—以csv格式输出文件
- en: This only takes a few seconds for just under 25,000 entries but yields over
    73,000 lines in the csv file.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 这只需几秒钟，对于不到25,000个条目，但在csv文件中产生了超过73,000行。
- en: '![image](img/F10007Xu07-44-9781597496513.jpg)'
  id: totrans-258
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-44-9781597496513.jpg)'
- en: You can now easily browse the timeline in a spreadsheet program or even import
    it into a database for additional analysis. There are several interesting items
    to point out.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 你现在可以轻松地在电子表格程序中浏览时间线，甚至可以将其导入数据库进行进一步分析。有几个有趣的项目需要指出。
- en: First, you will likely see many dates near January 1, 1970\. This is caused
    by time stamps that were set to 0 or not set at all. As Unix Epoch is based on
    the number of seconds since 01/01/1970 00:00:00 UTC, then an offset would be that
    exact time. In the above examples, we set the time zone to CST6CDT which, in January,
    is GMT −6 hours. So, there are many artifacts with a time stamp of “Wed Dec 31
    1969 18:00:00.” While we are unable to glean specific timeline data on these artifacts,
    they may nonetheless contain important information.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，你可能会看到很多接近1970年1月1日的日期。这是由于时间戳被设置为0或根本没有设置。由于Unix纪元是基于自1970年1月1日00:00:00
    UTC以来的秒数，那么偏移量将是那个确切的时间。在上面的例子中，我们将时区设置为CST6CDT，一月份这是GMT -6小时。因此，有很多带有“Wed Dec
    31 1969 18:00:00”时间戳的工件。虽然我们无法从这些工件中提取具体的时间线数据，但它们可能仍然包含重要信息。
- en: If you double-click the sdcard-timeline.csv file from your Ubuntu workstation,
    Open Office’s Calc program will present a Text Import screen as shown in [Fig.
    7.4](#F0025). Make sure the “Separated by” is set to comma, then press OK.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你从Ubuntu工作站双击sdcard-timeline.csv文件，Open Office的Calc程序将显示如图[图7.4](#F0025)所示的文本导入屏幕。确保“分隔符”设置为逗号，然后按确定。
- en: '![image](img/F10007Xf07-04-9781597496513.jpg)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-04-9781597496513.jpg)'
- en: FIGURE 7.4 Text import of sdcard-timeline.csv into OO Calc.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.4 将sdcard-timeline.csv文本导入到OO Calc中。
- en: The Calc program will then open and you can browse the timeline, illustrated
    in [Fig. 7.5](#F0030).
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 然后Calc程序将打开，你可以浏览时间线，如图[图7.5](#F0030)所示。
- en: '![image](img/F10007Xf07-05-9781597496513.jpg)'
  id: totrans-265
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-05-9781597496513.jpg)'
- en: FIGURE 7.5 Viewing timeline in OO Calc.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.5 在OO Calc中查看时间线。
- en: As you can see, most of the files are deleted. However, TSK and other programs
    can still recover them. One interesting event to examine is when an app was moved
    to the SD card for testing purposes. The app, Angry Birds, supports running from
    the SD card, which was tested at 06:17:28 on 02/15/2011, shown in [Fig. 7.6](#F0035).
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，大多数文件都被删除了。然而，TSK和其他程序仍然可以恢复它们。一个有趣的事件是检查一个应用程序出于测试目的被移动到SD卡上。该应用程序，愤怒的小鸟，支持从SD卡运行，在2011年2月15日06:17:28进行了测试，如图[图7.6](#F0035)所示。
- en: '![image](img/F10007Xf07-06-9781597496513.jpg)'
  id: totrans-268
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-06-9781597496513.jpg)'
- en: FIGURE 7.6 Timeline when app moved to SD card.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.6 应用程序移动到SD卡的时间线。
- en: The timeline clearly shows that a new file is created and modified at 06:17:28
    in “/mnt/sdcard/.android_secure.”
  id: totrans-270
  prefs: []
  type: TYPE_NORMAL
  zh: 时间线清楚地显示在“/mnt/sdcard/.android_secure”中在06:17:28创建并修改了一个新文件。
- en: 'One final entry to point out is from log2timeline. As it came across a PDF,
    the metadata was extracted. We can see the following:'
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一个要指出的是来自log2timeline的条目。当它遇到一个PDF时，提取了元数据。我们可以看到以下内容：
- en: • Mon Nov 29 2010 04:44:47
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: • 2010年11月29日星期一 04:44:47
- en: • 23,159 bytes
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
  zh: • 23,159字节
- en: • File modified
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: • 文件已修改
- en: '• Title: (Scanned Document)'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
  zh: • 标题：（扫描文档）
- en: '• Author: [michelle]'
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
  zh: • 作者：[michelle]
- en: '• Creator: [HardCopy]'
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: • 创建者：[HardCopy]
- en: '• Produced by: [Lexmark X543]'
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: • 制作者：[Lexmark X543]
- en: '• File: /mnt/sdcard/.easc/Attachment/ATT_1291219677612.pdf'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
  zh: • 文件：/mnt/sdcard/.easc/Attachment/ATT_1291219677612.pdf
- en: Timeline analysis is extremely powerful, especially if the forensic analyst
    combines traditional file system time stamped artifacts from Kristinn Gudjonsson’s
    log2timeline.
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 时间线分析非常强大，特别是如果法医分析师结合了Kristinn Gudjonsson的传统文件系统时间戳工件log2timeline。
- en: FAT Additional Analysis
  id: totrans-281
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: FAT附加分析
- en: 'There are many different approaches for further analysis of the FAT partitions.
    First, the large majority of forensic software in the market supports the FAT
    file system, and many examiners will have tool sets that they are comfortable
    with. Beyond the forensic software, we covered several additional techniques in
    the first section including:'
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 对于FAT分区的进一步分析有许多不同的方法。首先，市场上大多数法医软件都支持FAT文件系统，许多检查员都有他们感到舒适的工具集。除了法医软件，我们在第一部分中介绍了一些额外的技术，包括：
- en: • File system analysis
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: • 文件系统分析
- en: • File carving
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
  zh: • 文件雕刻
- en: • Strings
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: • 字符串
- en: • Hex analysis
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
  zh: • 十六进制分析
- en: These techniques are similar even when the file system type is different, so
    we will provide detailed coverage of them in the YAFFS2 section next. However,
    some brief concepts are highlighted below.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 即使文件系统类型不同，这些技术也是相似的，因此我们将在接下来的YAFFS2部分提供详细的内容。但是，下面突出了一些简要概念。
- en: First, the SD card clearly has a significant amount of deleted files. It is
    advisable to use a forensic tool to recover the data. TSK can recover the data
    as well as many other forensic software packages. In addition, file-carving techniques
    should be used to recover files that are not referenced in the File Allocation
    Table of the partition. Strings and hex analysis are again great ways to quickly
    locate data of interest.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，SD卡显然有大量被删除的文件。建议使用法医工具来恢复数据。TSK可以恢复数据，以及其他许多法医软件包。此外，应使用文件雕刻技术来恢复分区文件分配表中未引用的文件。字符串和十六进制分析再次成为快速定位感兴趣数据的好方法。
- en: There is one more quick technique to mention if the Ubuntu workstation is used
    for file system analysis. Using the find and file commands, you can list all allocated
    files by name, path, and file type. You can easily sort them on the fly or import
    them into a spreadsheet or database for additional analysis. This technique only
    lists allocated (undeleted) files, but is quite effective.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 如果使用Ubuntu工作站进行文件系统分析，还有一项快速技术要提及。使用find和file命令，你可以按名称、路径和文件类型列出所有已分配的文件。你可以轻松地即时排序，或者将它们导入电子表格或数据库进行进一步分析。这项技术只列出已分配（未删除）的文件，但非常有效。
- en: 'The command is as follows:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
  zh: 命令如下：
- en: '![image](img/F10007Xu07-45a-9781597496513.jpg)'
  id: totrans-291
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-45a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-45b-9781597496513.jpg)'
  id: totrans-292
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-45b-9781597496513.jpg)'
- en: 'In total, this command found and categorized 4352 allocated files on the SD
    card. Here’s what each part of the command accomplished:'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: 总的来说，这个命令在SD卡上找到了并分类了4352个已分配的文件。以下是命令每一部分完成的工作：
- en: • find ~/mnt/sdcard—Finds files in the directory where we mounted the SD card
    image ~/mnt/sdcard
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: • find ~/mnt/sdcard—在挂载SD卡镜像的目录中查找文件，即~/mnt/sdcard
- en: • -type f—Only examines regular files (i.e., doesn’t list directories)
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
  zh: • -type f—只检查普通文件（即，不列出目录）
- en: • -print0—Terminates each file name with a NULL character instead of the default
    new line which causes issues when file names have spaces
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: • -print0—使用NULL字符结束每个文件名，而不是默认换行符，当文件名包含空格时会导致问题
- en: • “|”—Pipes the output of find to the next program
  id: totrans-297
  prefs: []
  type: TYPE_NORMAL
  zh: • “|”—将find的输出传递给下一个程序
- en: • xargs—This program builds and executes command lines using data from standard
    input (i.e., other programs’ output)
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: • xargs—这个程序使用标准输入（例如，其他程序的输出）构建并执行命令行
- en: • -0—Tells xargs that the data being piped is terminated by NULL character (matches
    the -print0 from find)
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: • -0—告诉xargs，通过管道传输的数据由NULL字符结束（与find的-print0匹配）
- en: • file—This is the command xargs runs against each line returned by the find
    command
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
  zh: • file—这是xargs针对find命令返回的每一行执行的命令
- en: The find and xargs commands are very powerful ways to examine, interact, or
    otherwise manipulate a large set of files. By combining timeline and file system
    analysis, file carving, strings, and hex analysis, an investigator is armed with
    powerful tools to uncover information critical to the case.
  id: totrans-301
  prefs: []
  type: TYPE_NORMAL
  zh: find和xargs命令是检查、交互或以其他方式处理大量文件非常强大的方法。通过结合时间线分析和文件系统分析、文件雕刻、字符串和十六进制分析，调查员装备了强大的工具，以揭示对案件至关重要信息。
- en: FAT Analysts Notes
  id: totrans-302
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: FAT分析笔记
- en: There are a few remaining notes for the FAT file systems on Android.
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
  zh: 关于Android上的FAT文件系统还有几点剩余的说明。
- en: Apps on the SD Card
  id: totrans-304
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: SD卡上的应用
- en: First, as mentioned in [Chapter 6](CHP006.html), as of Android 2.2, users can
    move supported applications to the SD card to save space in the “/data/data” directory
    where user data are stored. The app must explicitly support this capability, and
    typical candidates for this feature are apps that use a lot of storage such as
    a game. To test this feature, the popular Angry Birds game by Rovio Mobile ([Rovio
    - Angry Birds, n.d.](#BIB11)) was installed on the reference HTC Incredible. The
    app was briefly run and then closed. To move the app to the SD card, you select
    Settings from the home screen, then Applications, and finally Manage Applications
    as illustrated in [Fig. 7.7](#F0040).
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，如[第6章](CHP006.html)所述，从Android 2.2开始，用户可以将支持的应用移动到SD卡，以节省"/data/data"目录中的空间，该目录用于存储用户数据。应用必须明确支持此功能，典型的候选者是使用大量存储空间的应用，如游戏。为了测试这个功能，在参考HTC
    Incredible上安装了Rovio Mobile公司流行的Angry Birds游戏（[Rovio - Angry Birds, n.d.](#BIB11)）。运行了该应用，然后关闭。要将应用移动到SD卡，你从主屏幕选择设置，然后是应用程序，最后是管理应用程序，如图7.7所示。
- en: '![image](img/F10007Xf07-07-9781597496513.jpg)'
  id: totrans-306
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-07-9781597496513.jpg)'
- en: FIGURE 7.7 Manage applications screen.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.7 管理应用程序屏幕。
- en: As you can tell, the Angry Birds uses 18.40 MB of space on “/data/data,” which
    is very precious space. So, the app developer included the necessary support to
    move the .apk to the SD card. The user can then select the app (Angry birds, in
    this case) and is then presented with a screen that has information and options
    about the app, including “Move to SD card” as shown in [Fig. 7.8](#F0045).
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，"Angry Birds"在"/data/data"目录下占用了18.40 MB的空间，这是非常宝贵的空间。因此，应用开发者包含了必要的支持，将.apk移动到SD卡。然后用户可以选择应用（在这个例子中是Angry
    Birds），并会看到一个包含有关应用信息及选项的屏幕，包括“移动到SD卡”选项，如图[7.8](#F0045)所示。
- en: '![image](img/F10007Xf07-08-9781597496513.jpg)'
  id: totrans-309
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-08-9781597496513.jpg)'
- en: FIGURE 7.8 Move to SD card.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.8 移动到SD卡。
- en: From this screen, you can see that the app itself uses 18.39 MB while user data
    is only 12.00 KB, a clear candidate for moving the .apk to the SD card. And, as
    illustrated in [Fig. 7.9](#F0050), it’s as simple as clicking the “Move to SD
    card” button and waiting for the task to complete.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: 从这个屏幕上，你可以看到应用程序本身使用了18.39 MB，而用户数据只有12.00 KB，显然是移动.apk文件到SD卡的理想候选者。正如[图7.9](#F0050)所展示的，只需点击“移动到SD卡”按钮，然后等待任务完成即可。
- en: '![image](img/F10007Xf07-09-9781597496513.jpg)'
  id: totrans-312
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-09-9781597496513.jpg)'
- en: FIGURE 7.9 App move to SD card complete.
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.9 应用程序移动到SD卡完成。
- en: This is great from the user’s perspective. But what does this mean for the forensic
    examiner or security analyst? A number of steps are taken that are described next
    and then highlighted in the code listing.
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 这对于用户来说是非常好的。但对于取证检查员或安全分析师来说这意味着什么呢？接下来描述了一些步骤，并在代码列表中突出显示。
- en: 1. The .apk file is moved from “/data/app” (or “/data/app-private”) to the SD
    card in an encrypted partition at /mnt/secure/asec (see highlighted parts of next
    listing) which can only be accessed via the root directory.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 1. .apk文件从“/data/app”（或“/data/app-private”）移动到SD卡上加密分区中的/mnt/secure/asec（见下一个列表中突出显示的部分），只能通过根目录访问。
- en: 2. A new device mapper file system is mounted read-only and the app from “/mnt/secure/asec”
    is decrypted and accessible to the system at “/mnt/asec/com.rovio.angrybirds-1.”
    The system must be able to access the unencrypted .apk file to run the app.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 一个新的设备映射文件系统被只读挂载，来自“/mnt/secure/asec”的应用程序被解密，并且可以在“/mnt/asec/com.rovio.angrybirds-1”处被系统访问。系统必须能够访问未加密的.apk文件才能运行该应用程序。
- en: 3. The user data remains in “/data/data” (in this case “/data/data/com.rovio.angrybirds”).
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 用户数据保留在“/data/data”中（在本例中为“/data/data/com.rovio.angrybirds”）。
- en: 4. If the SD card becomes inaccessible (whether it is removed, damaged, or simply
    mounted on a host computer for file sharing), the unencrypted volume is unmounted
    and no longer accessible to the system. This is why the core apps are currently
    unable to run from the SD card.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 如果SD卡无法访问（无论是被移除、损坏，还是仅仅在主机计算机上挂载用于文件共享），未加密的卷会被卸载，并且不再能被系统访问。这就是为什么核心应用程序目前无法从SD卡运行的原因。
- en: The .apk file is encrypted on the SD card to ensure that other apps (or processes)
    cannot corrupt or maliciously modify the app. However, app developers should not
    rely on the encryption to prevent people from accessing the .apk file as it is
    simply a matter of copying it from the unencrypted “/mnt/asec/<app-name>.” The
    mount and ls commands in the following code illustrate the structure.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: .apk文件在SD卡上被加密，以确保其他应用程序（或进程）不能损坏或恶意修改应用程序。然而，应用程序开发者不应依赖加密来防止人们访问.apk文件，因为它只是从未加密的“/mnt/asec/<app-name>”中复制的问题。以下代码中的mount和ls命令说明了这个结构。
- en: '![image](img/F10007Xu07-46-9781597496513.jpg)'
  id: totrans-320
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-46-9781597496513.jpg)'
- en: If you need the .apk for analysis (for example, investigating malware), then
    it is critical to copy the “/mnt/asec” subdirectories during the acquisition process
    while the SD card is inserted and active on the Android device (that is, not mounted
    on the forensic workstation for physical acquisition).
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你需要.apk文件进行分析（例如，调查恶意软件），那么在获取过程中，当SD卡插入并激活在Android设备上时（即没有在取证工作站上进行物理获取的挂载），复制“/mnt/asec”子目录是至关重要的。
- en: nomedia
  id: totrans-322
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: nomedia
- en: One other common item found on the SD card and eMMC partitions is an empty file
    named .nomedia that will instruct Android’s media scanner to skip the directory,
    so that it does not include any of the media files in apps such as Gallery or
    Music. If a directory does not contain this file, then it is quite possible that
    images which were previously deleted might have thumbnails which can be found
    in the media scanner’s directory. This will be covered further in the section
    on Android App Analysis and Reference.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 在SD卡和eMMC分区上常见的另一个项目是一个名为.nomedia的空文件，它会指示Android的媒体扫描器跳过该目录，这样在诸如图库或音乐等应用程序中就不会包含任何媒体文件。如果一个目录不包含这个文件，那么很可能之前删除的图片仍然有缩略图存在于媒体扫描器的目录中。关于Android应用程序分析和参考的部分将进一步讨论这个问题。
- en: YAFFS2 forensic analysis
  id: totrans-324
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: YAFFS2取证分析
- en: As discussed in [Chapter 4](CHP004.html), YAFFS2 is an open source, log-structured
    file system developed specifically for NAND flash, including support for wear-leveling
    and error-correcting code algorithms. This is great news not only for the phone
    owners, as YAFFS2 works very well on Android, but also for forensic analysts since
    a significant amount of old (deleted or updated) data is recoverable. But the
    good news stops there. As YAFFS2 is a relatively new file system, at this time
    no commercial forensic software solution supports it.
  id: totrans-325
  prefs: []
  type: TYPE_NORMAL
  zh: 正如在[第4章](CHP004.html)所讨论的，YAFFS2 是一个开源的、针对NAND闪存设计的日志结构文件系统，支持磨损均衡和错误校正码算法。这对于手机用户来说是个好消息，因为YAFFS2在Android上运行良好；对于法医分析师来说也是个好消息，因为大量的旧数据（已删除或更新的）是可以恢复的。但好消息仅此而已。由于YAFFS2是一个相对较新的文件系统，目前还没有商业法医软件解决方案支持它。
- en: However, all is not lost. Using the power of Linux, the openness of YAFFS2,
    an effective acquisition strategy, and the techniques already discussed including
    file system analysis, file carving, strings, and hex analysis, a forensic examiner
    can extract significant amounts of relevant data from the file system.
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，一切并未丢失。利用Linux的强大功能，YAFFS2的开放性，有效的获取策略，以及已经讨论过的技术，包括文件系统分析、文件雕刻、字符串和十六进制分析，法医检查员可以从文件系统中提取大量相关信息。
- en: As we dive into the analysis of YAFFS2, it’s quite helpful to remember how it
    is structured. One important concept to recall is how the data are structured
    physically on the NAND flash via MTD. Generally, YAFFS2 and MTD organize the NAND
    flash into 128 KB blocks, which consist of 2048 KB chunks of data followed by
    64 bytes of Out-Of-Band (OOB) data (making the total size on the NAND flash 132 KB),
    which is used to store disk and some file system metadata, as shown in [Fig. 7.10](#F0055).
  id: totrans-327
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们深入分析YAFFS2时，记住它的结构方式非常有帮助。需要回忆的一个重要概念是数据是如何通过MTD在NAND闪存上物理结构化的。通常，YAFFS2和MTD将NAND闪存组织成128 KB的块，每个块由2048 KB的数据块和64字节的带外数据（OOB）组成（使得NAND闪存上的总大小为132 KB），用于存储磁盘和某些文件系统元数据，如图[图7.10](#F0055)所示。
- en: '![image](img/F10007Xf07-10-9781597496513.jpg)'
  id: totrans-328
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xf07-10-9781597496513.jpg)'
- en: FIGURE 7.10 Block (128 KB = 64 × 2k chunks + OOB).
  id: totrans-329
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.10 块（128 KB = 64 × 2k块 + OOB）。
- en: Of course, it is not required that the Android device structure the NAND flash
    and MTD this way and the best way to verify is to examine the contents of the
    “/proc/mtd” file, which contains configuration information. Here is the file again
    from the reference HTC Incredible.
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，Android设备并不需要以这种方式构建NAND闪存和MTD，最好的验证方法是检查“/proc/mtd”文件的内容，该文件包含配置信息。以下是来自参考HTC
    Incredible的文件内容。
- en: '![image](img/F10007Xu07-47-9781597496513.jpg)'
  id: totrans-331
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-47-9781597496513.jpg)'
- en: While we need the OOB data if we want to attempt to mount the YAFFS2 nanddump
    on the Ubuntu workstation, the 64-byte OOB data will definitely cause problems
    for most forensic techniques, notably file carving. To alleviate this problem,
    you can simply remove the OOB with a simple program. The program is written in
    Python and can be easily adapted to different block and OOB configurations.
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然如果我们想在Ubuntu工作站上尝试挂载YAFFS2 nanddump，我们需要OOB数据，但64字节的OOB数据肯定会对大多数法医技术，尤其是文件雕刻造成问题。为了减轻这个问题，你可以使用一个简单的程序简单地移除OOB。该程序是用Python编写的，可以轻松地适应不同的块和OOB配置。
- en: First, let’s open a new file for editing with sudo permissions, so that we can
    place the program in “/usr/local/bin” which is the best place to save custom scripts
    and programs.
  id: totrans-333
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们使用sudo权限打开一个新文件进行编辑，这样我们就可以将程序放在“/usr/local/bin”中，这是保存自定义脚本和程序的最佳位置。
- en: '![image](img/F10007Xu07-48-9781597496513.jpg)'
  id: totrans-334
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-48-9781597496513.jpg)'
- en: 'Next, copy the following contents into the editor:'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，将以下内容复制到编辑器中：
- en: '![image](img/F10007Xu07-49a-9781597496513.jpg)'
  id: totrans-336
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-49a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-49b-9781597496513.jpg)'
  id: totrans-337
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-49b-9781597496513.jpg)'
- en: 'Then save with Ctrl-O and exit with Ctrl-X. Next, you have to make the Python
    file executable, so type in the following:'
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: 然后使用Ctrl-O保存并使用Ctrl-X退出。接下来，你需要使Python文件可执行，所以输入以下内容：
- en: '![image](img/F10007Xu07-50-9781597496513.jpg)'
  id: totrans-339
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-50-9781597496513.jpg)'
- en: 'And finally we can run the program against a nanddump file:'
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我们可以对nanddump文件运行程序：
- en: '![image](img/F10007Xu07-51-9781597496513.jpg)'
  id: totrans-341
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-51-9781597496513.jpg)'
- en: 'Let’s make sure the removeOOB.py results are what we expect. According to “/proc/mtd,”
    the “/dev/mtd/mtd6” partition has a size of 0x9500000 bytes and an erase size
    (block size) of 0x20000\. The overall size in bytes is 156,237,824 (simply convert
    the size from hex to decimal) or roughly 154 MB. Similarly, the erase size is
    2048 bytes, so if we divide 156,237,824 by 2048, we get 76,288 blocks in the data.
    This corresponds to the results from removeOOB.py. But there is one more thing
    we can check. As we know the nanddump has 64 bytes of OOB data after each 2k chunk,
    the total nanddump size on disk should be (76,288 × 64) + 156,237,824\. The total
    should then be 161,120,256, which would represent the data chunks and their corresponding
    OOB. We can see what the size on disk is with a simple “ls –l”:'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们确保 removeOOB.py 的结果符合我们的预期。根据“/proc/mtd”的信息，分区“/dev/mtd/mtd6”的大小为 0x9500000
    字节，擦除大小（块大小）为 0x20000。总字节大小为 156,237,824（将十六进制的大小转换为十进制），大约为 154 MB。同样，擦除大小为 2048
    字节，因此如果我们用 156,237,824 除以 2048，我们得到数据中的 76,288 个块。这与 removeOOB.py 的结果相符合。但还有一件事我们可以检查。由于我们知道
    nanddump 在每个 2k 数据块后都有 64 字节的 OOB 数据，因此磁盘上的 nanddump 总大小应为 (76,288 × 64) + 156,237,824。然后总数应为
    161,120,256，这代表了数据块及其相应的 OOB。我们可以通过简单的“ls –l”命令查看磁盘上的大小：
- en: '![image](img/F10007Xu07-52-9781597496513.jpg)'
  id: totrans-343
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-52-9781597496513.jpg)'
- en: As you can see, both the full nanddump and the .dd image (the nanddump with
    the OOB removed) correspond to the expected sizes.
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，完整的 nanddump 和 .dd 映像（移除了 OOB 的 nanddump）都与预期的大小相符。
- en: As we now have the YAFFS2 nanddump file, dd image, and the logical files (either
    from tar, adb pull, or by mounting the YAFFS2 partition), we are ready to perform
    various techniques against the data.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经有了 YAFFS2 nanddump 文件、dd 映像以及逻辑文件（通过 tar、adb pull 或挂载 YAFFS2 分区获得），我们可以对数据执行各种技术。
- en: YAFFS2 Timeline Analysis
  id: totrans-346
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: YAFFS2 时间线分析
- en: Ideally, this section would detail the use of already-built forensic software
    that would build YAFFS2 timelines. Unfortunately, YAFFS2 is not yet supported
    by any forensic timeline tools, so examiners in need of this information must
    take a more difficult path.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 理想情况下，这一节将详细说明已经构建的取证软件的使用，该软件可以构建 YAFFS2 时间线。不幸的是，目前还没有任何取证时间线工具支持 YAFFS2，因此需要这些信息的检查员必须走一条更艰难的道路。
- en: Over the next few years, the forensics industry needs to perform far more research
    into YAFFS2\. However, with Android moving towards EXT4, it is possible that most
    of the YAFFS2 research will not occur. Hopefully, this will not be the case.
  id: totrans-348
  prefs: []
  type: TYPE_NORMAL
  zh: 在未来几年中，取证行业需要针对 YAFFS2 进行更多的研究。然而，随着 Android 向 EXT4 迁移，可能大部分 YAFFS2 研究不会发生。希望情况不会是这样。
- en: Here, we will present some research that is intended to provide a basic framework
    to begin YAFFS2 research. This research was done on the simulated NAND flash initially
    covered in [Chapter 4](CHP004.html). While this approach provides the researcher
    with the control and privileges needed for effective research, it does not necessarily
    mimic production environments.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，我们将介绍一些旨在为 YAFFS2 研究提供一个基本框架的研究。这项研究是在第四章中首次介绍的模拟 NAND 闪存上进行的。尽管这种方法为研究者提供了进行有效研究所需的控制和权限，但它并不一定能模仿生产环境。
- en: As discussed in [Chapter 4](CHP004.html), both YAFFS2 and MTD are involved in
    writing data to the NAND flash. The YAFFS2 module is responsible for all aspects
    of the file system. However, the writing of the data to the NAND flash is managed
    by MTD. Unfortunately, this adds considerable complexity to the analysis as MTD
    can accept the data from YAFFS2, which needs to be written to the NAND flash and
    then has the autonomy to write not only the YAFFS2 data but additional MTD data
    in the manner it sees fit. Some research into the data as it has persisted must
    take into account not only the YAFFS2 code but the MTD code. Additionally, there
    can be subtle differences in the YAFFS2 and MTD modules used on different Android
    devices, which adds yet another layer of complexity.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 如第四章所述，YAFFS2 和 MTD 都涉及将数据写入 NAND 闪存。YAFFS2 模块负责文件系统的所有方面。然而，将数据写入 NAND 闪存是由
    MTD 管理的。不幸的是，这增加了分析的复杂性，因为 MTD 可以接受来自 YAFFS2 的数据，这些数据需要写入 NAND 闪存，然后它有自主权，不仅可以写入
    YAFFS2 数据，还可以按照它认为合适的方式写入额外的 MTD 数据。对持久数据的研究必须考虑到不仅是 YAFFS2 代码，还有 MTD 代码。此外，不同
    Android 设备上使用的 YAFFS2 和 MTD 模块之间可能存在细微差异，这又增加了一层复杂性。
- en: This does not mean understanding the YAFFS2 data found in a nanddump is impossible.
    To get started, we are going to setup a 64 MB simulated NAND flash device on our
    Ubuntu workstation.
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 这并不意味着理解nanddump中找到的YAFFS2数据是不可能的。为了开始，我们将在Ubuntu工作站上设置一个64 MB的模拟NAND闪存设备。
- en: '![image](img/F10007Xu07-53-9781597496513.jpg)'
  id: totrans-352
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-53-9781597496513.jpg)'
- en: 'You can verify the nandsim is properly setup:'
  id: totrans-353
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以验证nandsim是否正确设置：
- en: '![image](img/F10007Xu07-54-9781597496513.jpg)'
  id: totrans-354
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-54-9781597496513.jpg)'
- en: 'Before we mount the YAFFS2 file system, we are going to enable various debugging
    features built into YAFFS2\. There are many debugging options that YAFFS2 supports
    ([YAFFS Debugging, n.d.](#BIB14)), but we are only going to enable three of them.
    To do this, we first need to have full root permissions and then we will echo
    the debugging flags into “/proc/yaffs”:'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: 在挂载YAFFS2文件系统之前，我们将启用YAFFS2内置的各种调试功能。YAFFS2支持许多调试选项（[YAFFS Debugging, n.d.](#BIB14)），但我们只启用其中的三个。为此，我们首先需要拥有完整的root权限，然后将调试标志输入到“/proc/yaffs”：
- en: '![image](img/F10007Xu07-55-9781597496513.jpg)'
  id: totrans-356
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-55-9781597496513.jpg)'
- en: 'The value after echo command first removes any exiting debugging (none) and
    then enables the os, write, and mtd debugging options. You can view the results
    of the debugging in the system log located at “/var/log/syslog.” Ideally, open
    a second terminal window or ssh session and use the tail command to continuously
    output the tail end of the syslog:'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: echo命令后的值首先移除所有现有的调试（无），然后启用os、write和mtd调试选项。你可以在位于“/var/log/syslog”的系统日志中查看调试的结果。理想情况下，打开第二个终端窗口或ssh会话，并使用tail命令持续输出syslog的末尾部分：
- en: '![image](img/F10007Xu07-56-9781597496513.jpg)'
  id: totrans-358
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-56-9781597496513.jpg)'
- en: 'Next, we create the mount point and mount a YAFFS2 file system:'
  id: totrans-359
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们创建挂载点并挂载YAFFS2文件系统：
- en: '![image](img/F10007Xu07-57-9781597496513.jpg)'
  id: totrans-360
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-57-9781597496513.jpg)'
- en: 'At this point, the examiner should create a series of test cases, so that the
    expected controlled data can be examined on the simulated NAND flash to ultimately
    determine the structure. For this test, the following steps were taken:'
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一点上，检查员应该创建一系列测试用例，以便在模拟NAND闪存上检查预期的受控数据，最终确定其结构。对于这个测试，采取了以下步骤：
- en: 1. Create a directory called test in “~/mnt/yaffs2” (mkdir ~/mnt/yaffs2/test)
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 在“~/mnt/yaffs2”中创建一个名为test的目录（mkdir ~/mnt/yaffs2/test）
- en: 2. Create “~/mnt/yaffs2/test/file1.txt” with the contents “viaforensics” (nano
    -w ~/mnt/yaffs2/test/file1.txt)
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 创建包含“viaforensics”内容的“~/mnt/yaffs2/test/file1.txt”文件（nano -w ~/mnt/yaffs2/test/file1.txt）
- en: 3. Update “~/mnt/yaffs2/test” and append “updated” to file (echo “updated” >>
    ~/mnt/yaffs2/test/file1.txt)
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 更新“~/mnt/yaffs2/test”并将“updated”内容追加到文件（echo “updated” >> ~/mnt/yaffs2/test/file1.txt）
- en: 4. Read “~/mnt/yaffs2/test/file1.txt” (cat ~/mnt/yaffs2/test/file1.txt)
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 读取“~/mnt/yaffs2/test/file1.txt”（cat ~/mnt/yaffs2/test/file1.txt）
- en: 5. Change the user and group owner for the directory and file (chown -R pulse.rtkit
    ~/mnt/yaffs2/test)
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 5. 更改目录和文件的用户和组所有者（chown -R pulse.rtkit ~/mnt/yaffs2/test）
- en: 6. Change the permission of the directory and file (chmod -R 777 ~/mnt/yaffs2/test)
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: 6. 更改目录和文件的权限（chmod -R 777 ~/mnt/yaffs2/test）
- en: 'As these tests are being executed, not only is the file system being updated
    but the debugging information is written to the syslog. The debugging is very
    verbose (and we only enabled three of the debugging options), so only two examples
    are provided here, which correspond to the following:'
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 在执行这些测试时，不仅文件系统被更新，而且调试信息被写入syslog。调试信息非常详细（我们只启用了三个调试选项），因此这里只提供了两个示例，分别对应以下内容：
- en: 1. Creating the “~/mnt/yafs2/test” directory
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 创建“~/mnt/yafs2/test”目录
- en: 2. Change the permission of file1.txt (chmod -R 777 ~/mnt/yaffs2/test)
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 更改file1.txt的权限（chmod -R 777 ~/mnt/yaffs2/test）
- en: '![image](img/F10007Xu07-58a-9781597496513.jpg)'
  id: totrans-371
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-58a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-58b-9781597496513.jpg)'
  id: totrans-372
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-58b-9781597496513.jpg)'
- en: The debugging provides valuable information including object id, sequence number,
    chunk id, and the detailed process YAFFS2 follows to create the file. If you enable
    additional debugging you will have even more data to correlate and use in your
    understanding of YAFFS2.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 调试提供了有价值的信息，包括对象id、序列号、块id以及YAFFS2创建文件所遵循的详细过程。如果你启用了额外的调试功能，你将拥有更多的数据来关联和使用，以便更好地理解YAFFS2。
- en: 'Before we examine the actual nanddump, there is one other helpful command worth
    pointing out. The stat command will provide detailed information about a file,
    directory, or other file system objects. For example, we can run stat against
    “~/mnt/yaffs2/test” and “~/mnt/yaffs2/test/file1.txt” and use the information
    in our research:'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们检查实际的nanddump之前，还有另一个有用的命令值得一提。stat命令将提供关于文件、目录或其他文件系统对象的详细信息。例如，我们可以对“~/mnt/yaffs2/test”和“~/mnt/yaffs2/test/file1.txt”运行stat命令，并将信息用于我们的研究：
- en: '![image](img/F10007Xu07-59-9781597496513.jpg)'
  id: totrans-375
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-59-9781597496513.jpg)'
- en: We now have the Modified, Access, and Change properties of the file and directory
    and, combined with the actions we took to create the data, we have enough information
    to start our research.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经获得了文件和目录的修改、访问和更改属性，结合我们创建数据的操作，我们有足够的信息开始我们的研究。
- en: 'It’s time to look at the NAND flash, which requires root access. The following
    command will skip the rows of the NAND flash, which are all 0xFF and 0x00 making
    it easier to see trends. Also, only a small portion of the NAND flash is displayed
    here in hex for space reasons:'
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 是时候查看NAND闪存了，这需要root权限。以下命令将跳过NAND闪存的行，这些行都是0xFF和0x00，使其更容易看出趋势。此外，出于空间原因，这里只显示了NAND闪存的一小部分，以十六进制表示：
- en: '![image](img/F10007Xu07-60-9781597496513.jpg)'
  id: totrans-378
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-60-9781597496513.jpg)'
- en: 'The portion of the NAND flash included covers the following:'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 包括的NAND闪存部分涵盖以下内容：
- en: 1. Create “~/mnt/yaffs2/test” directory
  id: totrans-380
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 创建“~/mnt/yaffs2/test”目录
- en: 2. Permissions change on file1.txt (chmod -R 777 ~/mnt/yaffs2/test)
  id: totrans-381
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 对file1.txt文件权限更改（chmod -R 777 ~/mnt/yaffs2/test）
- en: The data displayed are part of YAFFS2 ObjectHeaders and contain the metadata
    for the file system. The names of the files are clearly visible as are the 64-byte
    OOB areas. One key characteristic about this data is that the integers which represent
    Unix Epoch time stamps are in little-endian order, which means that you must read
    the data from right to left.
  id: totrans-382
  prefs: []
  type: TYPE_NORMAL
  zh: 显示的数据是YAFFS2 ObjectHeaders的一部分，包含文件系统的元数据。文件名清晰可见，64字节的OOB区域也是如此。此数据的一个关键特点是表示Unix纪元时间戳的整数以小端序排列，这意味着您必须从右到左读取数据。
- en: '• Number as written to NAND flash: 63 99 d5 d4 (0x6399d5d4)'
  id: totrans-383
  prefs: []
  type: TYPE_NORMAL
  zh: • 写入NAND闪存的数字：63 99 d5 d4（0x6399d5d4）
- en: '• Converted from little endian to big endian: 4d 5d 99 36 (0x4d5d9936, which
    is the hex read from right to left)'
  id: totrans-384
  prefs: []
  type: TYPE_NORMAL
  zh: • 从 little endian 转换为 big endian：4d 5d 99 36（0x4d5d9936，这是从右到左读取的十六进制数）
- en: • Converting 0x4d5d9936 (hex) to base 10 is 1297979702
  id: totrans-385
  prefs: []
  type: TYPE_NORMAL
  zh: • 将0x4d5d9936（十六进制）转换为十进制是1297979702
- en: • Unix time stamp 1297979702 in human date/time format is Thu Feb 17 15:55:02
    CST 2011 (date -d @1297979702)
  id: totrans-386
  prefs: []
  type: TYPE_NORMAL
  zh: • Unix时间戳1297979702以人类可读的日期/时间格式是2011年2月17日星期四15:55:02 CST（date -d @1297979702）
- en: Using this information, we can isolate a number of important artifacts in the
    nanddump as shown in [Table 7.3](#T0020).
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
  zh: 使用这些信息，我们可以在nanddump中隔离出许多重要的工件，如[表7.3](#T0020)所示。
- en: Table 7.3 Artifacts from YAFFS2 Nanddump
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.3来自YAFFS2 Nanddump的工件
- en: '![Image](img/T10007XtabT0020.jpg)'
  id: totrans-389
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0020.jpg)'
- en: Quite satisfyingly, the data from the debug logs, stat command, and the nanddump
    of the simulated NAND flash device all correspond. With additional analysis, it
    would be quite possible to create the MAC times for each file and directory on
    the NAND flash, which would provide obvious benefit to an examiner. It is also
    possible to gather full metadata information from ObjectHeaders still found on
    the NAND flash and—provided garbage collection did not occur on the block—the
    full content of the time at each point in time.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
  zh: 令人满意的是，调试日志、stat命令以及模拟NAND闪存设备的nanddump数据均相互对应。通过进一步分析，完全有可能为NAND闪存上的每个文件和目录创建MAC时间，这将为审查员提供明显的好处。也有可能从NAND闪存上仍然存在的ObjectHeaders中收集完整的元数据信息，并且如果在块上没有发生垃圾回收，还可以获取每个时间点的全部内容。
- en: It is worth pointing out that in the very limited testing and analysis demonstrated
    here, it appears the *atime* (accessed time) for the file is not updated every
    time the file is accessed. This is not really surprising as it would mean that
    any time a program accesses the file, a new ObjectHeader would have to be written
    to NAND flash. This would result in a far greater number of writes to the NAND
    flash and would not only use precious battery power, but would also wear out the
    NAND flash with metadata updates most users do not really care about. This practice
    is also not terribly unusual as Microsoft, by default, disabled *atime* update
    in Microsoft Windows Vista and Windows 7.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 值得指出的是，在本文展示的非常有限测试和分析中，似乎文件的*atime*（访问时间）并不是每次访问文件时都会更新。这并不奇怪，因为这意味着每次程序访问文件时，都必须将新的ObjectHeader写入NAND闪存。这将导致对NAND闪存的写入次数大大增加，不仅会消耗宝贵的电池电量，而且还会因大多数用户并不真正关心的元数据更新而耗尽NAND闪存。这种做法并不特别不寻常，因为微软在默认情况下，在Microsoft
    Windows Vista和Windows 7中禁用了*atime*更新。
- en: To be sure, this analysis is not trivial. It can provide valuable information
    and is a basis for forensic research on the YAFFS2 file system.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 需要指出的是，这种分析并不是微不足道的。它能提供有价值的信息，并为对YAFFS2文件系统进行法医研究提供基础。
- en: YAFFS2 File System Analysis
  id: totrans-393
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: YAFFS2文件系统分析
- en: Hex analysis of the YAFFS2 file system is quite time consuming, so let’s move
    on to techniques for analyzing the allocated files. Unfortunately, there are again
    challenges, as it can be quite difficult to mount a YAFFS2 nanddump after it is
    extracted from an Android device.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
  zh: 对YAFFS2文件系统进行十六进制分析非常耗时，因此让我们继续分析分配的文件的技术。不幸的是，这里又遇到了挑战，因为从Android设备提取后，挂载YAFFS2
    nanddump可能会相当困难。
- en: For this reason, as highlighted in [Chapter 6](CHP006.html), if you have root
    access on an Android device, it is best to not only acquire the appropriate YAFFS2
    nanddump files, but to also logically copy important directories from the systems
    using adb pull, tar, or other method. That way, if you are unable to mount the
    YAFFS2 nanddump, you still have a logical copy of the files. The nanddump can
    then be used for timeline creation, other hex analysis, and file carving.
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，如[第6章](CHP006.html)所述，如果你在Android设备上有root权限，最好不仅要获取适当的YAFFS2 nanddump文件，还要使用adb
    pull、tar或其他方法从系统中逻辑地复制重要目录。这样，如果你无法挂载YAFFS2 nanddump，你仍然有一个逻辑上的文件副本。然后可以使用nanddump来创建时间线、进行其他十六进制分析以及文件雕刻。
- en: However, it is possible to mount some YAFFS2 nanddumps in Linux and, over time,
    expect more nanddump files to successfully mount. For this section though, we
    will focus on a nanddump from a Motorola Droid as they can be successfully mounted
    in Linux with nandsim and the YAFFS2 kernel module.
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，在Linux中可能挂载一些YAFFS2 nanddumps，随着时间的推移，预计会有更多的nanddump文件成功挂载。但是，在本节中，我们将关注来自摩托罗拉Droid的nanddump，因为它们可以通过nandsim和YAFFS2内核模块在Linux中成功挂载。
- en: First, we need to load the appropriate kernel modules and create a 1 GB nandsim
    device.
  id: totrans-397
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要加载合适的内核模块并创建一个1 GB的nandsim设备。
- en: '![image](img/F10007Xu07-61-9781597496513.jpg)'
  id: totrans-398
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-61-9781597496513.jpg)'
- en: We now have a 1 GB nandsim device that is capable of housing the Droid’s “/data”
    partition. The next step is to use nandwrite to copy both the data and OOB to
    the simulated NAND flash.
  id: totrans-399
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有一个1 GB的nandsim设备，可以容纳Droid的“/data”分区。下一步是使用nandwrite将数据和OOB都复制到模拟的NAND闪存中。
- en: '![image](img/F10007Xu07-62-9781597496513.jpg)'
  id: totrans-400
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-62-9781597496513.jpg)'
- en: 'The parameters instruct nandwrite to do the following:'
  id: totrans-401
  prefs: []
  type: TYPE_NORMAL
  zh: 这些参数指示nandwrite执行以下操作：
- en: • sudo nandwrite—Nandwrite requires root permission
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
  zh: • sudo nandwrite—nandwrite需要root权限
- en: • --autoplace—Use auto oob layout
  id: totrans-403
  prefs: []
  type: TYPE_NORMAL
  zh: • --autoplace—使用自动oob布局
- en: • --oob—Image contains oob data
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
  zh: • --oob—图像包含oob数据
- en: • /dev/mtd0—The mtd device to write the nanddump to
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
  zh: • /dev/mtd0—写入nanddump的mtd设备
- en: • droid_userdata.nanddump—The name of the nanddump file
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: • droid_userdata.nanddump—nanddump文件的名称
- en: 'If everything went as expected, we should now be able to mount the file system
    with the following commands:'
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
  zh: 如果一切按照预期进行，我们现在应该能够使用以下命令挂载文件系统：
- en: '![image](img/F10007Xu07-63-9781597496513.jpg)'
  id: totrans-408
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-63-9781597496513.jpg)'
- en: 'There are two primary problems you can encounter during this process. First,
    YAFFS2 and MTD may not successfully mount the file system and will display this
    message:'
  id: totrans-409
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个过程中，你可能会遇到两个主要问题。首先，YAFFS2和MTD可能无法成功挂载文件系统，并会显示以下信息：
- en: '![image](img/F10007Xu07-64-9781597496513.jpg)'
  id: totrans-410
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-64-9781597496513.jpg)'
- en: 'There can be many causes for this such as:'
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
  zh: 导致这种情况的原因可能有：
- en: • Differences between device’s YAFFS2 and MTD implementation and your workstation
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备的 YAFFS2 和 MTD 实现与你的工作站之间的差异
- en: • Corrupt or invalid nanddump
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
  zh: • 损坏或无效的 nanddump
- en: • File system issues
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: • 文件系统问题
- en: 'The second most common issue is that the file system mounts, but there are
    no files:'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
  zh: 第二个最常见的问题是文件系统挂载了，但是没有文件：
- en: '![image](img/F10007Xu07-65-9781597496513.jpg)'
  id: totrans-416
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-65-9781597496513.jpg)'
- en: 'This is most likely due to differences between the device’s YAFFS2 and MTD
    implementation and your workstation, and again can be difficult to debug. There
    are a few things you can try to resolve the issues. First, if you have a version
    of mtu-utils greater than 20090606-1, try installing the older version. Here’s
    how to check your current version and optionally install:'
  id: totrans-417
  prefs: []
  type: TYPE_NORMAL
  zh: 这很可能是由于设备的 YAFFS2 和 MTD 实现与你的工作站之间的差异造成的，并且可能很难调试。你可以尝试一些方法来解决问题。首先，如果你有大于 20090606-1
    版本的 mtu-utils，尝试安装旧版本。以下是检查你当前版本并选择安装的方法：
- en: '![image](img/F10007Xu07-66-9781597496513.jpg)'
  id: totrans-418
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-66-9781597496513.jpg)'
- en: Now that we downgraded the version of MTD, you could try the steps to mount
    a YAFFS2 nanddump again.
  id: totrans-419
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经降低了 MTD 的版本，你可以尝试再次执行挂载 YAFFS2 nanddump 的步骤。
- en: The other potential option is that your version of YAFFS2 is not consistent
    enough with the version used on the Android device. In order to get different
    versions of YAFFS2, you will need to use the source control system of either the
    YAFFS2 or the Android Open Source Project. You would then compile that source
    code, remove the existing YAFFS2 kernel module, insert the new one, and try again.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个可能的情况是，你的 YAFFS2 版本与 Android 设备上使用的版本不够一致。为了获得不同版本的 YAFFS2，你需要使用 YAFFS2 或
    Android 开源项目的源代码控制系统。然后，你可以编译该源代码，移除现有的 YAFFS2 内核模块，插入新的模块，并再次尝试。
- en: 'If these steps work, here is what you will see:'
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
  zh: '如果这些步骤有效，以下是你会看到的情况： '
- en: '![image](img/F10007Xu07-67-9781597496513.jpg)'
  id: totrans-422
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-67-9781597496513.jpg)'
- en: So we now have the full “/data” file system from a Motorola Droid accessible
    on our Ubuntu workstation, which you can then explore and analyze with the forensic
    tools of your choice. Ultimately, if you are unable to mount the nanddump on the
    Ubuntu workstation, you should still have the full set of logical files from the
    acquisition process, so it should not inhibit the analysis of the device.
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
  zh: 目前，我们已经可以在 Ubuntu 工作站上访问到一个摩托罗拉 Droid 手机的完整“/data”文件系统，你可以使用你选择的取证工具进行探索和分析。最终，如果你无法在
    Ubuntu 工作站上挂载 nanddump，你仍然应该拥有获取过程中完整的逻辑文件集，因此它不应该妨碍对设备进行分析。
- en: YAFFS2 File Carving
  id: totrans-424
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: YAFFS2 文件雕刻
- en: The next technique useful for analyzing YAFFS2 file systems is file carving.
    Previously in this chapter, we installed and configured scalpel on our Ubuntu
    workstation. For this example, let’s assume there is a file called htc-datadata.dd
    in the home directory of the logged-in user on the Ubuntu virtual machine. In
    that same directory (which you can reference with a ~ in your commands), there
    is a scalpel configuration containing the entries from the section 1.3 named scalpel-android.conf.
  id: totrans-425
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个用于分析 YAFFS2 文件系统的技术是文件雕刻。在本章前面，我们在 Ubuntu 工作站上安装并配置了 scalpel。对于这个例子，假设 Ubuntu
    虚拟机上登录用户的主目录中有一个名为 htc-datadata.dd 的文件。在同一个目录（你可以在命令中使用 ~ 来引用它），有一个包含 1.3 节条目的名为
    scalpel-android.conf 的 scalpel 配置文件。
- en: 'Please note that we are using the **dd image** for file carving, not the nanddump.
    This is necessary as the OOB data found after each 2k chunk of YAFFS2 data would
    significantly impact the ability of scalpel to carve valid files. The following
    command would run scalpel against the dd image and output the files in a folder
    called htc-scalpel-test in your home directory:'
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们在这里使用的是 **dd 映像** 进行文件雕刻，而不是 nanddump。这是必要的，因为每个 2k 块 YAFFS2 数据后面的 OOB
    数据将严重影响 scalpel 雕刻有效文件的能力。以下命令将在 dd 映像上运行 scalpel，并将文件输出到名为 htc-scalpel-test 的文件夹中，该文件夹位于你的主目录中：
- en: '![image](img/F10007Xu07-68-9781597496513.jpg)'
  id: totrans-427
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-68-9781597496513.jpg)'
- en: In this instance, scalpel was able to recover 11,370 files and the output provides
    specifics on the file types and counts that were recovered. [Fig. 7.11](#F0060)
    is a screen shot from the Ubuntu workstation looking at one of the JPG directories.
  id: totrans-428
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，scalpel 能够恢复 11,370 个文件，并且输出提供了有关恢复的文件类型和数量的详细信息。[图 7.11](#F0060) 是在
    Ubuntu 工作站上查看其中一个 JPG 目录的屏幕截图。
- en: '![image](img/F10007Xf07-11-9781597496513.jpg)'
  id: totrans-429
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xf07-11-9781597496513.jpg)'
- en: FIGURE 7.11 Viewing images recovered using scalpel.
  id: totrans-430
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.11 使用 scalpel 恢复的图像查看。
- en: 'The images do not have a high resolution but, especially when viewed directly
    on the workstation, you can discern the contents. Here are a few things that this
    small fraction of images shows:'
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
  zh: 图片的分辨率并不高，但特别是在工作站上直接查看时，你可以分辨出内容。以下是这部分图片显示的一些内容：
- en: • The top three pictures are the opening frames from YouTube movies, dragon
    cartoons in this case.
  id: totrans-432
  prefs: []
  type: TYPE_NORMAL
  zh: •   前三张图片是YouTube视频的开头帧，在这个例子中是龙卡通。
- en: • The next picture is a fragment of a Facebook message asking about lunch and
    recommending sushi.
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
  zh: •   接下来的图片是Facebook消息的一部分，询问午餐并推荐寿司。
- en: • The remaining pictures appear to be from various news articles.
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
  zh: •   剩余的图片似乎来自不同的新闻文章。
- en: As this demonstrates, file carving can recover important artifacts from YAFFS2
    and is a valuable tool for forensic analysis.
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: 正如所示，文件雕刻可以从YAFFS2恢复重要的工件，对于法医分析来说是一个有价值的工具。
- en: YAFFS2 Strings Analysis
  id: totrans-436
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: YAFFS2字符串分析
- en: We have already demonstrated one example of using strings to find data on an
    Android device. However, let’s work through another exercise to demonstrate not
    only the technique but the power of this type of analysis.
  id: totrans-437
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经展示了一个在Android设备上使用strings查找数据的例子。但是，让我们通过另一个练习来演示这项技术以及这种分析类型的强大功能。
- en: For this example, the examiner needs to find location information on the Android
    device. One term to search for, especially on an Android device, is [maps.google.com](http://maps.google.com)
    as the Google Maps service is tightly integrated into the operating system. An
    extremely powerful utility for search is called grep and is used so extensively
    it is now a verb in technical vernacular (“Did you grep the device for map references?”).
    It is not only built into the Ubuntu virtual machine but it also supports very
    powerful regular expressions (often shortened to regex or regexp), which allow
    sophisticated pattern matching. There are many online resources which introduce
    both grep and regex with good examples.
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，检查员需要在Android设备上找到位置信息。特别是在Android设备上，一个需要搜索的关键词是[maps.google.com](http://maps.google.com)，因为Google地图服务与操作系统紧密集成。一个非常强大的搜索工具叫做grep，它被广泛使用，现在在技术术语中已经变成了一个动词（“你有没有用grep搜索设备上的地图引用？”）。它不仅内置在Ubuntu虚拟机中，而且支持非常强大的正则表达式（通常简称为regex或regexp），这允许进行复杂的模式匹配。有许多在线资源介绍了grep和regex，并附有很好的示例。
- en: 'For our example, we are going to use grep for its most basic functionality
    where we simply search for a string:'
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的例子中，我们将使用grep的最基本功能，我们只需搜索一个字符串：
- en: '![image](img/F10007Xu07-69-9781597496513.jpg)'
  id: totrans-440
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-69-9781597496513.jpg)'
- en: 'The query returned 775 examples—only a few are displayed here for brevity and
    privacy reasons. However, it is quite easy to determine some of the activity that
    took place on the device. Specifically:'
  id: totrans-441
  prefs: []
  type: TYPE_NORMAL
  zh: 查询返回了775个示例——出于简洁和隐私原因，这里只显示了一些。然而，很容易确定设备上发生的一些活动。具体来说：
- en: • A search (the q= in the URL stands for query) for Naperville Crime Prevention
    was conducted and the URL is valid complete with address, phone number, pictures,
    directions, and more.
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
  zh: •   对Naperville犯罪预防的搜索（URL中的q=代表查询）已经进行，URL是有效的，包括地址、电话号码、图片、方向等。
- en: • A search for Kennedy Space Center Visitor Complex was also performed.
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: •   对肯尼迪航天中心游客综合体的搜索也已完成。
- en: • The Kennedy Space Center query was then viewed by the mobile maps application
    and we can even see the IP address.
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
  zh: •   肯尼迪航天中心的查询随后被移动地图应用程序查看，我们甚至可以看到IP地址。
- en: If we take a look at the IP address, which is part of the last query (174.253.2.53),
    we can use either command line tools or an online IP lookup service ([What Is
    My IP Address, n.d.](#BIB13)) to find out additional information. The results
    are shown in [Fig. 7.12](#F0065).
  id: totrans-445
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们查看IP地址，它是最后一个查询的一部分（174.253.2.53），我们可以使用命令行工具或在线IP查找服务（[What Is My IP Address,
    n.d.](#BIB13)）来获取更多信息。结果在[图7.12](#F0065)中显示。
- en: '![image](img/F10007Xf07-12-9781597496513.jpg)'
  id: totrans-446
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xf07-12-9781597496513.jpg)'
- en: FIGURE 7.12 Results of IP address lookup.
  id: totrans-447
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.12 IP地址查找结果。
- en: 'The information from the IP lookup service reveals several important pieces
    of information:'
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
  zh: IP查找服务的信息揭示了几个重要的信息片段：
- en: 1. The device is using the Verizon Wireless network.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 设备正在使用威瑞森无线网络。
- en: 2. The device was located in the Chicago, IL area (it is possible to spoof and
    fake IP addresses but this is nontrivial and unlikely in most scenarios).
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 设备位于伊利诺伊州芝加哥地区（可以伪造和欺骗IP地址，但在大多数情况下这并不简单且不太可能）。
- en: As we have the hex offset for the strings recovered, we could then look at data
    surrounding this search to determine the general time frame the search took place.
  id: totrans-451
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已恢复字符串的十六进制偏移量，我们可以查看此搜索周围的数据以确定搜索发生的大致时间范围。
- en: YAFFS2 Analyst Notes
  id: totrans-452
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: YAFFS2分析师笔记
- en: The manual analysis required for much of the YAFFS2 forensics is certainly time
    consuming and a bit daunting, which makes the barrier of entry much higher than
    the analysis of well-understood and supported file systems. However, there are
    many resources that are easily accessible to assist an analyst new to this approach.
  id: totrans-453
  prefs: []
  type: TYPE_NORMAL
  zh: 对于YAFFS2取证的大部分手动分析确实很耗时且有些令人畏惧，这导致进入这一领域的门槛比分析那些理解深入、支持充分的文件系统要高。然而，有许多易于获取的资源可以协助刚接触这种方法的分析师。
- en: First, hopefully this book provided a good introduction to using Linux for forensic
    analysis (please recommend that all of your friends and colleagues should have
    a copy for their bookshelf).
  id: totrans-454
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，希望这本书为取证分析中使用Linux提供了一个良好的介绍（请推荐给你的所有朋友和同事，让他们也都在书架上放一本）。
- en: Perhaps a bit more helpful is that a simple Google search will often result
    in many helpful posts on blogs, discussion boards, mailing lists, and other such
    resources. While there is certainly inaccurate information on the Internet, many
    of the technical people working in these areas post quite accurate and precise
    information. And, as a bonus, many of the authors are very responsive to inquiries
    and clarifications.
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
  zh: 也许更有帮助的是，简单的Google搜索常常会带来许多博客、讨论板、邮件列表等资源上的有用帖子。尽管互联网上确实存在不准确的信息，但许多在这些领域工作的技术人员发布的信息相当准确和精确。而且，作为额外的好处，许多作者对询问和澄清非常响应。
- en: 'Next, there is an excellent introduction to Linux for law enforcement and forensic
    analysts, which is available online and at no cost. The web site, Linux LEO: The
    Law Enforcement and Forensic Examiner’s Introduction to Linux, provides the guide
    in PDF format and introduces the reader to Linux concepts needed to use the operating
    system as a forensic tool ([Grundy, B., n.d.](#BIB8)).'
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，有一个针对执法和取证分析师的Linux优秀入门介绍，该资源在线免费提供。网站“Linux LEO：执法和取证检验员的Linux入门”提供了PDF格式的指南，并介绍了使用操作系统作为取证工具所需的Linux概念（[Grundy,
    B., n.d.](#BIB8)）。
- en: As you use Linux further, you will find that it is quite easy to automate many
    of the manual tasks. This not only allows you to have great control over how the
    system works, but the automation can save considerable time. This is a great combination
    as the busy examiner can process more forensic data with cutting edge tools and
    at the same time explain exactly what the system did instead of just being able
    to say that a button was clicked and a report was produced.
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
  zh: 随着你进一步使用Linux，你会发现自动化许多手动任务其实相当简单。这不仅让你对系统如何工作有很好的控制，而且自动化可以节省大量时间。这对于忙碌的分析师来说是一个很好的组合，他们可以使用前沿工具处理更多取证数据，同时还能准确解释系统做了什么，而不仅仅是说点击了一个按钮并生成了一份报告。
- en: The easiest way to start automating common Linux tasks is to simply write a
    shell script, which is very easy to write and essentially mimic the commands you
    would type in a terminal session.
  id: totrans-458
  prefs: []
  type: TYPE_NORMAL
  zh: 开始自动化常见Linux任务的最简单方法就是编写一个shell脚本，这非常容易实现，本质上就是模仿你在终端会话中输入的命令。
- en: For example, let’s say you have a series of .csv files, which contain the results
    from running the AFLogical forensic technique on an Android device. You need to
    send the top row of each file to someone, but it should not contain any data from
    the device. You could open each file manually, delete the data rows, save the
    updated file to a new directory, and finally send the information. However, this
    could take quite some time. Instead, you could write a simple shell script.
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，假设你有一系列.csv文件，这些文件包含了在Android设备上运行AFLogical取证技术得到的结果。你需要将每个文件的第一行发送给某人，但不应包含任何设备数据。你可以手动打开每个文件，删除数据行，将更新后的文件保存到新目录，然后发送信息。但这可能需要相当长的时间。相反，你可以编写一个简单的shell脚本。
- en: 'First, let’s open a new file for editing:'
  id: totrans-460
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们打开一个新文件进行编辑：
- en: '![image](img/F10007Xu07-70-9781597496513.jpg)'
  id: totrans-461
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-70-9781597496513.jpg)'
- en: 'Then place the following into the file:'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
  zh: 然后将以下内容放入文件中：
- en: '![image](img/F10007Xu07-71-9781597496513.jpg)'
  id: totrans-463
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-71-9781597496513.jpg)'
- en: 'Then save the file by pressing Ctrl-O and exit with Ctrl-X. Next, we have to
    make the script executable:'
  id: totrans-464
  prefs: []
  type: TYPE_NORMAL
  zh: 然后通过按Ctrl-O保存文件，并通过Ctrl-X退出。接下来，我们必须使脚本可执行：
- en: '![image](img/F10007Xu07-72-9781597496513.jpg)'
  id: totrans-465
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-72-9781597496513.jpg)'
- en: 'The files we want to sanitize are in a directory called AFLogical on the home
    directory of the user and, as you can tell, processing these by hand would be
    quite time consuming:'
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要清理的文件位于用户主目录下的一个名为AFLogical的目录中，如您所见，手动处理这些文件会非常耗时：
- en: '![image](img/F10007Xu07-73-9781597496513.jpg)'
  id: totrans-467
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-73-9781597496513.jpg)'
- en: 'We can easily process these files simply now:'
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在可以轻松处理这些文件：
- en: '![image](img/F10007Xu07-74-9781597496513.jpg)'
  id: totrans-469
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-74-9781597496513.jpg)'
- en: 'Now, the AFLogical directory not only has a new subdirectory called sanitized
    with each of the updated files in it, but also a single file containing the data:'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，AFLogical目录不仅有一个名为sanitized的新子目录，其中包含了每个更新的文件，而且还有一个包含数据的单一文件：
- en: '![image](img/F10007Xu07-75-9781597496513.jpg)'
  id: totrans-471
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-75-9781597496513.jpg)'
- en: This data can be easily e-mailed or copied to another drive.
  id: totrans-472
  prefs: []
  type: TYPE_NORMAL
  zh: 这些数据可以轻松地通过电子邮件发送或复制到另一个驱动器。
- en: Here’s a more complex example, which will create a nandsim device, mount a blank
    YAFFS2 file system, generate several files, and then allow the user to unmount
    the file system. This is a quick way to automate the steps involved in testing
    YAFFS2.
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一个更复杂的例子，它将创建一个nandsim设备，挂载一个空白的YAFFS2文件系统，生成几个文件，然后允许用户卸载文件系统。这是自动化测试YAFFS2涉及的步骤的快速方法。
- en: '![image](img/F10007Xu07-76a-9781597496513.jpg)'
  id: totrans-474
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-76a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-76b-9781597496513.jpg)'
  id: totrans-475
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-76b-9781597496513.jpg)'
- en: Hopefully, the absence of commercial tools which support the YAFFS2 file system
    is not viewed by the examiner as a situation where no additional data can be recovered.
    Using free, open source tools available on an Ubuntu workstation clearly provides
    a powerful means to further the investigation. When combining these techniques
    with the hex analysis outlined in this chapter, an examiner should find they are
    well prepared to extract evidence from YAFFS2 partitions on Android devices. When
    a case involving a medical device that runs embedded Linux with the YAFFS2 file
    system is placed on your desk you can confidently dive in and figure it out.
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
  zh: 希望检查员不要认为由于缺乏支持YAFFS2文件系统的商业工具，就无法恢复额外的数据。使用Ubuntu工作站上可用的免费开源工具，显然可以提供进一步调查的强大手段。将这些技术与本章概述的十六进制分析相结合，检查员应发现他们已经很好地准备好从安卓设备上的YAFFS2分区提取证据。当一个涉及运行嵌入式Linux和YAFFS2文件系统的医疗设备的案例放在您的桌子上时，您可以自信地深入研究并解决问题。
- en: Android app analysis and reference
  id: totrans-477
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安卓应用分析与参考
- en: While this chapter described many techniques useful for the forensic and security
    investigation of Android devices, it is helpful to have a reference of where data
    is stored for key applications. Of course, maintaining a complete reference would
    be nearly impossible not only due to the sheer number of applications but also
    due to the variation between specific devices and Android versions.
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管本章描述了许多对安卓设备进行取证和安全调查有用的技术，但了解关键应用数据存储位置的信息很有帮助。当然，由于应用程序数量庞大，以及特定设备和安卓版本之间的差异，要维护一个完整的参考资料几乎是不可能的。
- en: 'In the following sections, we analyze 10 important applications from the reference
    phones used throughout this book and provide the following data:'
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
  zh: 在以下各节中，我们将分析本书中使用的参考手机上的10个重要应用，并提供以下数据：
- en: 1. App information
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 应用信息
- en: 2. Files and directories (including /data/data, SD card, and eMMC)
  id: totrans-481
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 文件和目录（包括 /data/data，SD卡和eMMC）
- en: 3. Important database tables
  id: totrans-482
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 重要的数据库表
- en: 4. Analyst notes
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 分析师笔记
- en: Through the app analysis, all time stamps are in Unix Epoch milliseconds, the
    number of milliseconds since January 1, 1970, unless otherwise noted.
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
  zh: 通过应用分析，所有时间戳都是Unix纪元毫秒，即自1970年1月1日以来的毫秒数，除非特别说明。
- en: The apps tested were installed and used on the device and then analyzed with
    a custom Python program to automate some of the techniques described previously
    in this chapter. While significant information is provided, be advised that this
    is only a reference and likely incomplete. Analysts should use the forensic and
    security tools as well as the techniques described above for a full analysis of
    the device they are examining.
  id: totrans-485
  prefs: []
  type: TYPE_NORMAL
  zh: 测试的应用是在设备上安装并使用后，再通过一个自定义的Python程序进行分析，以自动化本章前面描述的一些技术。虽然提供了大量信息，但请注意，这只是一个参考，可能不完整。分析人员应该使用本章描述的取证和安全工具以及技术，对正在检查的设备进行全面分析。
- en: Messaging (sms and mms)
  id: totrans-486
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 短信（sms和mms）
- en: App Info
  id: totrans-487
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This is the default app shipped with Android that handles SMS and MMS messages.
  id: totrans-488
  prefs: []
  type: TYPE_NORMAL
  zh: 这是安卓系统默认的短信和彩信处理应用。
- en: '• App Name: Messaging'
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：短信
- en: '• Package name: com.android.providers.telephony'
  id: totrans-490
  prefs: []
  type: TYPE_NORMAL
  zh: • 软件包名称：com.android.providers.telephony
- en: '• Version: 2.2'
  id: totrans-491
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：2.2
- en: '• Device: HTC Incredible'
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Android'
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Android
- en: Directories, Files, and File Types
  id: totrans-494
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.android.providers.telephony:'
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `/data/data/com.android.providers.telephony` 目录下：
- en: '![image](img/F10007Xu07-77-9781597496513.jpg)'
  id: totrans-496
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-77-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-497
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: Important database tables and files for mms and sms are shown in [Table 7.4](#T0025).
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
  zh: MMS和SMS的重要数据库表和文件显示在[表7.4](#T0025)中。
- en: Table 7.4 Important Database Tables and Files from /data/data/com.android.providers.telephony/databases/mmssms.db
  id: totrans-499
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.4 来自 `/data/data/com.android.providers.telephony/databases/mmssms.db` 的重要数据库表和文件
- en: '| Database Tables/Files | Description |'
  id: totrans-500
  prefs: []
  type: TYPE_TB
  zh: '| 数据库表/文件 | 描述 |'
- en: '| --- | --- |'
  id: totrans-501
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| words_content | Content of messages |'
  id: totrans-502
  prefs: []
  type: TYPE_TB
  zh: '| words_content | 消息内容 |'
- en: '| part | MMS attachment details including type, name, location on file system
    if binary (i.e., images), and content of attachment if plain text |'
  id: totrans-503
  prefs: []
  type: TYPE_TB
  zh: '| part | MMS附件详情，包括类型、名称、如果为二进制文件（例如图像）在文件系统中的位置以及如果为纯文本的附件内容 |'
- en: '| sms | Full SMS messages including to, from, person, time stamp, read status,
    send/receive status, and message content |'
  id: totrans-504
  prefs: []
  type: TYPE_TB
  zh: '| sms | 完整的SMS消息，包括收件人、发件人、联系人、时间戳、阅读状态、发送/接收状态和消息内容 |'
- en: Analyst Notes
  id: totrans-505
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 分析笔记
- en: 'Analyst notes for /data/data/com.android.providers.telephony:'
  id: totrans-506
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 `/data/data/com.android.providers.telephony` 的分析笔记：
- en: • The app_parts folder will contain the MMS attachments and can include images,
    video, or any other supported data. File types are not maintained, so use the
    file command or other file signature analysis tools to identify.
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
  zh: • app_parts文件夹将包含MMS附件，可以包括图像、视频或任何其他支持的数据。文件类型没有维护，因此请使用file命令或其他文件签名分析工具来识别。
- en: • The telephony database is usually of little interest as it only contains service
    information for the wireless carrier(s).
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
  zh: • telephony数据库通常没什么兴趣，因为它只包含无线运营商的服务信息。
- en: • The sms table contains all the messages and should be the primary focus.
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
  zh: • sms表包含所有消息，应该是主要关注点。
- en: • Several other tables seem to replicate parts of the sms table’s content, so
    look at words_content and other tables to aid in your analysis.
  id: totrans-510
  prefs: []
  type: TYPE_NORMAL
  zh: • 其他几个表似乎复制了sms表内容的部分，因此查看words_content和其他表以帮助分析。
- en: '• See also: com.android.mms.'
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
  zh: • 另请参阅：com.android.mms。
- en: MMS Helper Application
  id: totrans-512
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: MMS辅助应用
- en: App Info
  id: totrans-513
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This app stores some MMS data and appears to be a helper application for the
    main Messaging app.
  id: totrans-514
  prefs: []
  type: TYPE_NORMAL
  zh: 该应用存储一些MMS数据，似乎是主 Messaging 应用的辅助应用。
- en: '• App Name: com.android.mm'
  id: totrans-515
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：com.android.mm
- en: '• Package name: com.android.mms'
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
  zh: • 软件包名称：com.android.mms
- en: '• Version: 2.2'
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：2.2
- en: '• Device: HTC Incredible'
  id: totrans-518
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Android'
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Android
- en: Directories, Files, and File Types
  id: totrans-520
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.android.mms:'
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `/data/data/com.android.mms` 目录下：
- en: '![image](img/F10007Xu07-78-9781597496513.jpg)'
  id: totrans-522
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-78-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-523
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: • PART files in /data/data/com.android.mms/cache
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
  zh: • 在 `/data/data/com.android.mms/cache` 目录下的PART文件
- en: Analyst Notes
  id: totrans-525
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析笔记
- en: 'Analyst notes for /data/data/com.android.mms:'
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 `/data/data/com.android.mms` 的分析笔记：
- en: • File “bufferFileForMms” might contain buffer data at the time of sending.
    However, it usually only contains 0x00.
  id: totrans-527
  prefs: []
  type: TYPE_NORMAL
  zh: • 文件“bufferFileForMms”在发送时可能包含缓冲数据。但它通常只包含0x00。
- en: • The PART files in cache are small PNG versions of the images found in the
    Messaging app at /data/data/com.android.providers.telephony/app_parts.
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
  zh: • 缓存中的PART文件是 Messaging 应用中找到的位于 `/data/data/com.android.providers.telephony/app_parts`
    的图像的小PNG版本。
- en: Browser
  id: totrans-529
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 浏览器
- en: App Info
  id: totrans-530
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This is the built-in web browser for Android, based on the open source WebKit
    project.
  id: totrans-531
  prefs: []
  type: TYPE_NORMAL
  zh: 这是基于开源WebKit项目的Android内置Web浏览器。
- en: '• App Name: Internet'
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：Internet
- en: '• Package name: com.android.browser'
  id: totrans-533
  prefs: []
  type: TYPE_NORMAL
  zh: • 软件包名称：com.android.browser
- en: '• Version: 2.2'
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：2.2
- en: '• Device: HTC Incredible'
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Android'
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Android
- en: Directories, Files, and File Types
  id: totrans-537
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.android.browser:'
  id: totrans-538
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `/data/data/com.android.browser` 目录下：
- en: '![image](img/F10007Xu07-79a-9781597496513.jpg)'
  id: totrans-539
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-79a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-79b-9781597496513.jpg)'
  id: totrans-540
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-79b-9781597496513.jpg)'
- en: 'In /app-cache/com.android.browser/cache:'
  id: totrans-541
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `/app-cache/com.android.browser/cache` 目录下：
- en: '![image](img/F10007Xu07-80-9781597496513.jpg)'
  id: totrans-542
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-80-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-543
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: Local storage for supported web apps is shown in [Table 7.5](#T0030).
  id: totrans-544
  prefs: []
  type: TYPE_NORMAL
  zh: 支持的Web应用的本地存储显示在[表7.5](#T0030)中。
- en: Table 7.5 Important Database Tables and Files from /data/data/com.android.browser/app_databases/http_www.google.com_0.localstorage
  id: totrans-545
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.5 来自 `/data/data/com.android.browser/app_databases/http_www.google.com_0.localstorage`
    的重要数据库表和文件
- en: '| Database Tables/Files | Description |'
  id: totrans-546
  prefs: []
  type: TYPE_TB
  zh: '| 数据库表格/文件 | 描述 |'
- en: '| --- | --- |'
  id: totrans-547
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| ItemTable | This table is a simple list of key/value pairs; however, potentially
    contains useful information for sites that were visited and takes advantage of
    the localstorage feature. |'
  id: totrans-548
  prefs: []
  type: TYPE_TB
  zh: '| 项目表格 | 这个表格是一个简单的键/值对列表；然而，可能包含有关访问过的网站的实用信息，并利用了localStorage功能。 |'
- en: Cached geoposition data is shown in [Table 7.6](#T0035).
  id: totrans-549
  prefs: []
  type: TYPE_NORMAL
  zh: 缓存的地理位置数据显示在[表7.6](#T0035)中。
- en: Table 7.6 Important Database Tables and Files from /data/data/com.android.browser/app_geolocation/CachedGeoposition.db
  id: totrans-550
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.6 来自/data/data/com.android.browser/app_geolocation/CachedGeoposition.db的重要数据库表格和文件
- en: '![Image](img/T10007XtabT0035.jpg)'
  id: totrans-551
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0035.jpg)'
- en: The geolocation permissions database is shown in [Table 7.7](#T0040).
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
  zh: 地理位置权限数据库显示在[表7.7](#T0040)中。
- en: Table 7.7 Important Database Tables and Files from /data/data/com.android.browser/app_geolocation/GeolocationPermissions.db
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.7 来自/data/data/com.android.browser/app_geolocation/GeolocationPermissions.db的重要数据库表格和文件
- en: '| Database Tables/Files | Description |'
  id: totrans-554
  prefs: []
  type: TYPE_TB
  zh: '| 数据库表格/文件 | 描述 |'
- en: '| --- | --- |'
  id: totrans-555
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Permissions | This table is list of origins (web sites) and the permission
    for each (allow). For example, [http://www.google.com](http://www.google.com)
    and the value 1 means Google’s web site has permission to access geolocation |'
  id: totrans-556
  prefs: []
  type: TYPE_TB
  zh: '| 权限 | 这个表格是源（网站）及其每个权限（允许）的列表。例如，[http://www.google.com](http://www.google.com)
    和值1意味着Google网站有权限访问地理位置 |'
- en: '[Table 7.8](#T0045) shows the browser database.'
  id: totrans-557
  prefs: []
  type: TYPE_NORMAL
  zh: '[表7.8](#T0045)显示了浏览器数据库。'
- en: Table 7.8 Important Database Tables and Files from /data/data/com.android.browser/databases/browser.db
  id: totrans-558
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.8 来自/data/data/com.android.browser/databases/browser.db的重要数据库表格和文件
- en: '![Image](img/T10007XtabT0045.jpg)'
  id: totrans-559
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0045.jpg)'
- en: '[Table 7.9](#T0050) shows the web view database.'
  id: totrans-560
  prefs: []
  type: TYPE_NORMAL
  zh: '[表7.9](#T0050)显示了网页视图数据库。'
- en: Table 7.9 Important Database Tables and Files from /data/data/com.android.browser/databases/webview.db
  id: totrans-561
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.9 来自/data/data/com.android.browser/databases/webview.db的重要数据库表格和文件
- en: '![Image](img/T10007XtabT0050.jpg)'
  id: totrans-562
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0050.jpg)'
- en: And the web view cache database is shown in [Table 7.10](#T0055).
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
  zh: 网页视图缓存数据库显示在[表7.10](#T0055)中。
- en: Table 7.10 Important Database Tables and Files from /data/data/com.android.browser/databases/webviewCache.db
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.10 来自/data/data/com.android.browser/databases/webviewCache.db的重要数据库表格和文件
- en: '![Image](img/T10007XtabT0055.jpg)'
  id: totrans-565
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0055.jpg)'
- en: Analyst Notes
  id: totrans-566
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.android.browser:'
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
  zh: 关于/data/data/com.android.browser的分析师笔记：
- en: • Check the WebpageIcons.db in app_icons if looking for a particular site and
    the site has a favicon.
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
  zh: • 如果需要查找特定网站并且该网站有favicon，请检查app_icons中的WebpageIcons.db。
- en: • The specific app databases can contain very useful information. For example,
    Google app database has previous search terms, many versions of cached “lon/lat/acc”
    with time stamps and more.
  id: totrans-569
  prefs: []
  type: TYPE_NORMAL
  zh: • 特定的应用数据库可能包含非常有用的信息。例如，Google应用数据库包含先前的搜索词，许多带有时间戳的“lon/lat/acc”缓存版本等。
- en: • The com.adobe.flashplayer directory contains not only “Flash cookies,” which
    end in the .sol extension and can be parsed by log2timeline, but also some of
    the Flash .swf files.
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
  zh: • com.adobe.flashplayer目录不仅包含以.sol扩展名结尾的“Flash cookies”，可以通过log2timeline解析，还包含一些Flash
    .swf文件。
- en: • The browser database (databases/browser.db) contains a table called bookmarks,
    which is generally pre-populated with bookmarks from the wireless carriers. This
    same table also contains the web browser history. There is also a table called
    Searches, which contains Google searches made from the browser.
  id: totrans-571
  prefs: []
  type: TYPE_NORMAL
  zh: 浏览器数据库（databases/browser.db）包含一个名为bookmarks的表格，该表格通常预先填充了来自无线运营商的书签。这个表格还包含了网页浏览器历史记录。还有一个名为Searches的表格，其中包含了从浏览器进行的Google搜索。
- en: • The web view database (databases/webview.db) contains considerable information
    not only useful for a forensic examiner but also a security engineer. Cookies
    are visible and most are not secure, meaning they may be vulnerable to a cookie
    hijacking attack using a tool such as Firesheep. Form URL and data often contain
    sensitive information as do httpauth and password.
  id: totrans-572
  prefs: []
  type: TYPE_NORMAL
  zh: • 网页视图数据库（databases/webview.db）包含大量信息，不仅对法医检查员有用，对安全工程师也有用。Cookies是可见的，而且大多数都不安全，这意味着它们可能容易受到像Firesheep这样的工具的cookie劫持攻击。表单URL和数据通常包含敏感信息，httpauth和密码也是如此。
- en: • The web view cache database (databases/webviewCache.db) provides the metadata
    about the cache files stored in cache directory.
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
  zh: • 网页视图缓存数据库（databases/webviewCache.db）提供了有关存储在缓存目录中的缓存文件的元数据。
- en: • Most devices save the web view cache data as a subdirectory in /data/data/com.android.browser.
    However, the HTC Incredible moved this directory to a tmpfs (RAM disk) directory.
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
  zh: • 大多数设备将网页视图缓存数据作为/data/data/com.android.browser的子目录保存。然而，HTC Incredible将此目录移动到了tmpfs（RAM磁盘）目录。
- en: Contacts
  id: totrans-575
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 联系人
- en: App Info
  id: totrans-576
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This app is the main contacts app provided by Android. While there are many
    additional apps available, this app provides the core contact functionality.
  id: totrans-577
  prefs: []
  type: TYPE_NORMAL
  zh: 该应用是Android提供的主要联系人应用。尽管有许多其他应用可用，但此应用提供了核心的联系人功能。
- en: '• App Name: Contacts'
  id: totrans-578
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：联系人
- en: '• Package name: com.android.providers.contacts'
  id: totrans-579
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名：com.android.providers.contacts
- en: '• Version: 2.2'
  id: totrans-580
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：2.2
- en: '• Device: HTC Incredible'
  id: totrans-581
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Android'
  id: totrans-582
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Android
- en: Directories, Files, and File Types
  id: totrans-583
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.android.providers.contacts:'
  id: totrans-584
  prefs: []
  type: TYPE_NORMAL
  zh: 在/data/data/com.android.providers.contacts：
- en: '![image](img/F10007Xu07-81-9781597496513.jpg)'
  id: totrans-585
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-81-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-586
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: There is only one database, contacts2.db, and it has over 30 tables. A few of
    the key tables are listed in [Table 7.11](#T0060).
  id: totrans-587
  prefs: []
  type: TYPE_NORMAL
  zh: 只有一个数据库，即contacts2.db，它有超过30个表。一些关键表在[表7.11](#T0060)中列出。
- en: Table 7.11 Important Database Tables and Files from /data/data/com.android.providers.contacts/databases/contacts2.db
  id: totrans-588
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.11 来自/data/data/com.android.providers.contacts/databases/contacts2.db的重要数据库表和文件
- en: '![Image](img/T10007XtabT0060.jpg)'
  id: totrans-589
  prefs: []
  type: TYPE_IMG
  zh: '![Image](img/T10007XtabT0060.jpg)'
- en: Analyst Notes
  id: totrans-590
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.android.providers.contacts:'
  id: totrans-591
  prefs: []
  type: TYPE_NORMAL
  zh: 关于/data/data/com.android.providers.contacts的分析师笔记：
- en: • This app stores the Call Logs for the device in the calls table.
  id: totrans-592
  prefs: []
  type: TYPE_NORMAL
  zh: • 该应用在calls表中存储设备的通话记录。
- en: • There are over 30 tables in contacts2.db, so further inspection may be required.
    The data table contains additional values about contacts and the raw_contacts
    contains additional data about some contacts.
  id: totrans-593
  prefs: []
  type: TYPE_NORMAL
  zh: • contacts2.db中超过30个表，可能需要进一步检查。数据表包含有关联系人的额外值，而raw_contacts包含有关某些联系人的额外数据。
- en: • The app is capable of storing contact information from many different accounts
    including Gmail, Exchange, Facebook, Twitter, and more. Some of the data stored
    include information from these other apps such as Facebook status messages.
  id: totrans-594
  prefs: []
  type: TYPE_NORMAL
  zh: • 该应用能够存储来自许多不同账户的联系人信息，包括Gmail、Exchange、Facebook、Twitter等。存储的一些数据包括来自这些其他应用的信息，如Facebook状态消息。
- en: • If pictures of the contacts are available, they are stored in the files directory
    and named thumbnail_photo_[NNNNN].jpg. In the reference HTC Incredible, there
    were over 200 images but duplicates were found.
  id: totrans-595
  prefs: []
  type: TYPE_NORMAL
  zh: • 如果联系人的图片可用，它们将存储在files目录中，并命名为thumbnail_photo_[NNNNN].jpg。在参考HTC Incredible中，发现超过200张图片，但有重复。
- en: Media Scanner
  id: totrans-596
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 媒体扫描器
- en: App Info
  id: totrans-597
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This app scans and stores the metadata of media files available on internal
    and external storage.
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
  zh: 该应用扫描并存储内部和外部存储介质上媒体文件的元数据。
- en: '• App Name: Media Store'
  id: totrans-599
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：媒体商店
- en: '• Package name: com.android.providers.media'
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名：com.android.providers.media
- en: '• Version: 2.2'
  id: totrans-601
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：2.2
- en: '• Device: HTC Incredible'
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Android'
  id: totrans-603
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Android
- en: Directories, Files, and File Types
  id: totrans-604
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.android.providers.media:'
  id: totrans-605
  prefs: []
  type: TYPE_NORMAL
  zh: 在/data/data/com.android.providers.media：
- en: '![image](img/F10007Xu07-82-9781597496513.jpg)'
  id: totrans-606
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-82-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-607
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: The structure of each database is similar, as shown in [Table 7.12](#T0065).
  id: totrans-608
  prefs: []
  type: TYPE_NORMAL
  zh: 每个数据库的结构相似，如[表7.12](#T0065)所示。
- en: Table 7.12 Important Database Tables and Files from /data/data/com.android.providers.media/databases/
  id: totrans-609
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.12 来自/data/data/com.android.providers.media/databases/的重要数据库表和文件
- en: '![Image](img/T10007XtabT0065.jpg)'
  id: totrans-610
  prefs: []
  type: TYPE_IMG
  zh: '![Image](img/T10007XtabT0065.jpg)'
- en: Analyst Notes
  id: totrans-611
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.android.providers.media:'
  id: totrans-612
  prefs: []
  type: TYPE_NORMAL
  zh: 关于/data/data/com.android.providers.media的分析师笔记：
- en: • The database names contain the volume ID, if available. For example, on the
    reference HTC Incredible device, the eMMC FAT32 file system has a volume ID of
    0xc7f80810.
  id: totrans-613
  prefs: []
  type: TYPE_NORMAL
  zh: • 数据库名称包含卷ID（如果有）。例如，在参考HTC Incredible设备上，eMMC FAT32文件系统有一个卷ID为0xc7f80810。
- en: • If a directory has a file named .nomedia, then the media store will not scan
    and record the metadata of files in that directory.
  id: totrans-614
  prefs: []
  type: TYPE_NORMAL
  zh: • 如果一个目录中有一个名为.nomedia的文件，那么媒体商店将不会扫描并记录该目录中文件的元数据。
- en: • If an image was deleted, the thumbnail likely still exists. Also, even if
    the metadata record is deleted, it is likely recoverable due to the YAFFS2 file
    system.
  id: totrans-615
  prefs: []
  type: TYPE_NORMAL
  zh: • 如果删除了一张图片，缩略图可能仍然存在。此外，即使删除了元数据记录，由于YAFFS2文件系统，它很可能可以被恢复。
- en: • Also scans for audio files, albums, etc.
  id: totrans-616
  prefs: []
  type: TYPE_NORMAL
  zh: • 还会扫描音频文件、专辑等。
- en: • Other media scanners and apps exist, so check for those. One stores thumbnails
    on the SD card, which can provide an insight into deleted pictures and videos.
  id: totrans-617
  prefs: []
  type: TYPE_NORMAL
  zh: • 存在其他媒体扫描器和应用，因此需要检查这些内容。其中一个在SD卡上存储缩略图，这可以提供被删除图片和视频的洞察。
- en: YouTube
  id: totrans-618
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: YouTube
- en: App Info
  id: totrans-619
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: YouTube is a video viewing web site now owned by Google, for which they have
    developed a native app for Android.
  id: totrans-620
  prefs: []
  type: TYPE_NORMAL
  zh: YouTube是一个视频观看网站，现在由Google拥有，为此他们为Android开发了一个原生应用。
- en: '• App Name: YouTube'
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：YouTube
- en: '• Package name: com.google.android.youtube'
  id: totrans-622
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名：com.google.android.youtube
- en: '• Version: 1.6.21'
  id: totrans-623
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：1.6.21
- en: '• Device: HTC Incredible'
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Google'
  id: totrans-625
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Google
- en: Directories, Files, and File Types
  id: totrans-626
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.google.android.youtube:'
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
  zh: 在`/data/data/com.google.android.youtube`中：
- en: '![image](img/F10007Xu07-83-9781597496513.jpg)'
  id: totrans-628
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-83-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-629
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: 'YouTube preferences, including device key(s) and watched videos in /data/data/com.google.android.youtube/shared_prefs/youtube.xml:'
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
  zh: YouTube偏好设置，包括在`/data/data/com.google.android.youtube/shared_prefs/youtube.xml`中的设备密钥和已观看视频。
- en: '![image](img/F10007Xu07-84-9781597496513.jpg)'
  id: totrans-631
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-84-9781597496513.jpg)'
- en: 'Information about specific movies watched saved in XML file in /data/data/com.google.android.youtube/cache:'
  id: totrans-632
  prefs: []
  type: TYPE_NORMAL
  zh: 在`/data/data/com.google.android.youtube/cache`的XML文件中保存的关于特定已观看电影的信息：
- en: '![image](img/F10007Xu07-85-9781597496513.jpg)'
  id: totrans-633
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-85-9781597496513.jpg)'
- en: Analyst Notes
  id: totrans-634
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.google.android.youtube:'
  id: totrans-635
  prefs: []
  type: TYPE_NORMAL
  zh: 关于`/data/data/com.google.android.youtube`的分析师笔记：
- en: • Examine the XML files in the cache directory and in the shared_prefs directory
    for information on videos viewed.
  id: totrans-636
  prefs: []
  type: TYPE_NORMAL
  zh: • 检查缓存目录和shared_prefs目录中的XML文件，了解已观看视频的信息。
- en: • A snapshot of the opening image to a video can often be found on the device
    using file carving or other techniques.
  id: totrans-637
  prefs: []
  type: TYPE_NORMAL
  zh: • 通常可以通过文件雕刻或其他技术在设备上找到视频开场图像的快照。
- en: Cooliris Media Gallery
  id: totrans-638
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Cooliris Media Gallery
- en: App Info
  id: totrans-639
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This app was developed for the Google Nexus One and provides a media gallery
    and scanner.
  id: totrans-640
  prefs: []
  type: TYPE_NORMAL
  zh: 这个应用是为Google Nexus One开发的，提供了一个媒体库和扫描器。
- en: '• App Name: Cooliris Media Gallery'
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：Cooliris Media Gallery
- en: '• Package name: com.cooliris.media'
  id: totrans-642
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名：com.cooliris.media
- en: '• Version: 1.1.30682'
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：1.1.30682
- en: '• Device: Google Nexus One'
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：Google Nexus One
- en: '• App developer: Cooliris'
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Cooliris
- en: Directories, Files, and File Types
  id: totrans-646
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.cooliris.media:'
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
  zh: 在`/data/data/com.cooliris.media`中：
- en: '![image](img/F10007Xu07-86-9781597496513.jpg)'
  id: totrans-648
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-86-9781597496513.jpg)'
- en: 'More importantly, thumbnails are stored on the SD card:'
  id: totrans-649
  prefs: []
  type: TYPE_NORMAL
  zh: 更重要的是，缩略图存储在SD卡上：
- en: '![image](img/F10007Xu07-87-9781597496513.jpg)'
  id: totrans-650
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-87-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-651
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: For this device, the picasa.db was empty, but presumably the databases will
    contain useful information.
  id: totrans-652
  prefs: []
  type: TYPE_NORMAL
  zh: 对于这个设备，picasa.db是空的，但数据库可能包含有用的信息。
- en: Analyst Notes
  id: totrans-653
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.cooliris.media:'
  id: totrans-654
  prefs: []
  type: TYPE_NORMAL
  zh: 关于`/data/data/com.cooliris.media`的分析师笔记：
- en: • The real value in this app is that media discovered on the device is cached
    on the SD card in “/mnt/sdcard/Android/data/com.cooliris.media/cache” and should
    be examined closely.
  id: totrans-655
  prefs: []
  type: TYPE_NORMAL
  zh: • 这个应用真正的价值在于，在设备上发现的媒体会在SD卡上的“/mnt/sdcard/Android/data/com.cooliris.media/cache”目录中被缓存，应该仔细检查。
- en: Google Maps
  id: totrans-656
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Google Maps
- en: App Info
  id: totrans-657
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This is the built-in Google Maps application used to view maps, search for endpoints,
    and even provide directions.
  id: totrans-658
  prefs: []
  type: TYPE_NORMAL
  zh: 这是内置的Google Maps应用，用于查看地图、搜索终点，甚至提供导航。
- en: '• App Name: Google Maps'
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：Google Maps
- en: '• Package name: com.google.android.apps.maps'
  id: totrans-660
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名：com.google.android.apps.maps
- en: '• Version: 4.4.0'
  id: totrans-661
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：4.4.0
- en: '• Device: HTC Incredible'
  id: totrans-662
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Google'
  id: totrans-663
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Google
- en: Directories, Files, and File Types
  id: totrans-664
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.google.android.apps.maps:'
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
  zh: 在`/data/data/com.google.android.apps.maps`中：
- en: '![image](img/F10007Xu07-88a-9781597496513.jpg)'
  id: totrans-666
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-88a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-88b-9781597496513.jpg)'
  id: totrans-667
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-88b-9781597496513.jpg)'
- en: 'This app also stores data on the SD card:'
  id: totrans-668
  prefs: []
  type: TYPE_NORMAL
  zh: 这个应用还在SD卡上存储数据：
- en: '![image](img/F10007Xu07-89a-9781597496513.jpg)'
  id: totrans-669
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-89a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-89b-9781597496513.jpg)'
  id: totrans-670
  prefs: []
  type: TYPE_IMG
  zh: '![image](img/F10007Xu07-89b-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-671
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: While each database should be examined, on the HTC Incredible, two contained
    highly useful information. The first is the da_destination_history database as
    shown in [Table 7.13](#T0070) and the search_history database shown in [Table
    7.14](#T0075).
  id: totrans-672
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管每个数据库都应该被检查，但在HTC Incredible上，有两个数据库包含非常有用的信息。第一个是在[表7.13](#T0070)中显示的da_destination_history数据库，以及[表7.14](#T0075)中显示的search_history数据库。
- en: Table 7.13 Important Database Tables and Files from /data/data/com.google.android.apps.maps/databases/da_destination_history
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.13 /data/data/com.google.android.apps.maps/databases/da_destination_history的重要数据库表和文件
- en: '![Image](img/T10007XtabT0070.jpg)'
  id: totrans-674
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0070.jpg)'
- en: Table 7.14 Important Database Tables and Files from /data/data/com.google.android.apps.maps/databases/search_history.db
  id: totrans-675
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.14 /data/data/com.google.android.apps.maps/databases/search_history.db的重要数据库表和文件
- en: '![Image](img/T10007XtabT0075.jpg)'
  id: totrans-676
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0075.jpg)'
- en: 'The files directory also contains a significant amount of information. For
    example, the first part of the DATA_LAYER_24 file contains the following strings:'
  id: totrans-677
  prefs: []
  type: TYPE_NORMAL
  zh: files目录也包含大量信息。例如，DATA_LAYER_24文件的第一部分包含以下字符串：
- en: '![image](img/F10007Xu07-90-9781597496513.jpg)'
  id: totrans-678
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-90-9781597496513.jpg)'
- en: 'The data stored on the SD card is used for the turn-by-turn directions for
    the Google Maps Navigation and the turn-by-turn directions are time stamped:'
  id: totrans-679
  prefs: []
  type: TYPE_NORMAL
  zh: 存储在SD卡上的数据用于谷歌地图导航的逐向指引，且逐向指引都带有时间戳：
- en: '![image](img/F10007Xu07-91-9781597496513.jpg)'
  id: totrans-680
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-91-9781597496513.jpg)'
- en: Analyst Notes
  id: totrans-681
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.google.android.apps.maps:'
  id: totrans-682
  prefs: []
  type: TYPE_NORMAL
  zh: 关于/data/data/com.google.android.apps.maps的分析师笔记：
- en: • The app stores a significant amount of information about maps, tiles, searches,
    and more in the files directory and should be closely examined.
  id: totrans-683
  prefs: []
  type: TYPE_NORMAL
  zh: • 该应用在files目录中存储了大量关于地图、瓦片、搜索等信息，应仔细检查。
- en: • While each database may not contain information, both search_history.db and
    da_destination_history should be examined closely.
  id: totrans-684
  prefs: []
  type: TYPE_NORMAL
  zh: • 尽管每个数据库可能不包含信息，但应仔细检查search_history.db和da_destination_history。
- en: • While the shared_prefs direction contains some information, most is not useful
    to a forensic examination. However, the authentication token can be recovered,
    which may be of interest in a security review.
  id: totrans-685
  prefs: []
  type: TYPE_NORMAL
  zh: • 尽管shared_prefs目录包含一些信息，但大多数对法医检查来说并不有用。然而，可以恢复认证令牌，这在进行安全审查时可能是有趣的。
- en: • The Navigation function caches map data on the SD card, as well as .wav files
    of the actual directions. If you look at the time stamps on the file, which are
    prefaced with a “._speech_nav,” you can determine when the directions were provided
    and also hear the actual spoken directions.
  id: totrans-686
  prefs: []
  type: TYPE_NORMAL
  zh: • 导航功能在SD卡上缓存地图数据，以及实际指引的.wav文件。如果你查看文件的时间戳，它们以“._speech_nav”为前缀，你可以确定指引是在何时提供的，并且可以听到实际的语音指引。
- en: Gmail
  id: totrans-687
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Gmail
- en: App Info
  id: totrans-688
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: 'Google provides a native client for their Gmail service:'
  id: totrans-689
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌为他们的Gmail服务提供了一个本地客户端：
- en: '• App Name: Gmail (Google Mail)'
  id: totrans-690
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：Gmail（Google Mail）
- en: '• Package name: com.google.android.gm'
  id: totrans-691
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名称：com.google.android.gm
- en: '• Version: 2.2'
  id: totrans-692
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：2.2
- en: '• Device: HTC Incredible'
  id: totrans-693
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Google'
  id: totrans-694
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Google
- en: Directories, Files, and File Types
  id: totrans-695
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /mnt/sdcard/Android/data/com.google.android.apps.maps/:'
  id: totrans-696
  prefs: []
  type: TYPE_NORMAL
  zh: 在/mnt/sdcard/Android/data/com.google.android.apps.maps/：
- en: '![image](img/F10007Xu07-92a-9781597496513.jpg)'
  id: totrans-697
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-92a-9781597496513.jpg)'
- en: '![image](img/F10007Xu07-92b-9781597496513.jpg)'
  id: totrans-698
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-92b-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-699
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: The Gmail app stores a significant amount of information in SQLite databases
    and a sample of key tables is shown in [Table 7.15](#T0080).
  id: totrans-700
  prefs: []
  type: TYPE_NORMAL
  zh: Gmail应用在SQLite数据库中存储了大量信息，关键表的一个示例显示在[表7.15](#T0080)中。
- en: Table 7.15 Important Database Tables and Files from /data/data/com.google.android.gm/databases/mailstore.book@viaforensics.com.db
  id: totrans-701
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.15 /data/data/com.google.android.gm/databases/mailstore.book@viaforensics.com.db的重要数据库表和文件
- en: '![Image](img/T10007XtabT0080.jpg)'
  id: totrans-702
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0080.jpg)'
- en: '![Image](img/T10007XtabT0080a.jpg)'
  id: totrans-703
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0080a.jpg)'
- en: Analyst Notes
  id: totrans-704
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.google.android.gm:'
  id: totrans-705
  prefs: []
  type: TYPE_NORMAL
  zh: 关于/data/data/com.google.android.gm的分析师笔记：
- en: • Each configured Gmail account will have its own SQLite database, which will
    contain the entire e-mail content.
  id: totrans-706
  prefs: []
  type: TYPE_NORMAL
  zh: • 每个配置的Gmail账户将有自己的SQLite数据库，其中将包含全部电子邮件内容。
- en: • Other databases such as downloads.db, suggestions.db, and gmail.db contain
    additional information.
  id: totrans-707
  prefs: []
  type: TYPE_NORMAL
  zh: • 其他数据库如downloads.db、suggestions.db和gmail.db包含附加信息。
- en: • Some SQLite journal files may be recoverable.
  id: totrans-708
  prefs: []
  type: TYPE_NORMAL
  zh: • 一些SQLite日志文件可能可恢复。
- en: • The cache/download directory stores downloads.
  id: totrans-709
  prefs: []
  type: TYPE_NORMAL
  zh: • 缓存/下载目录存储下载内容。
- en: • The synced Gmail accounts are also referenced in the Gmail.xml in shared_prefs.
  id: totrans-710
  prefs: []
  type: TYPE_NORMAL
  zh: • 同步的Gmail账户也在shared_prefs中的Gmail.xml中引用。
- en: Facebook
  id: totrans-711
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Facebook
- en: App Info
  id: totrans-712
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This is the office Facebook app.
  id: totrans-713
  prefs: []
  type: TYPE_NORMAL
  zh: 这是官方的Facebook应用。
- en: '• App Name: Facebook'
  id: totrans-714
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：Facebook
- en: '• Package name: com.facebook.katana'
  id: totrans-715
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名称：com.facebook.katana
- en: '• Version: 1.2'
  id: totrans-716
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：1.2
- en: '• Device: HTC Incredible'
  id: totrans-717
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Facebook'
  id: totrans-718
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Facebook
- en: Directories, Files, and File Types
  id: totrans-719
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.facebook.katana:'
  id: totrans-720
  prefs: []
  type: TYPE_NORMAL
  zh: 在/data/data/com.facebook.katana中：
- en: '![image](img/F10007Xu07-93-9781597496513.jpg)'
  id: totrans-721
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-93-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-722
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: There is one primary database as shown in [Table 7.16](#T0085).
  id: totrans-723
  prefs: []
  type: TYPE_NORMAL
  zh: 如[表7.16](#T0085)所示，有一个主数据库。
- en: Table 7.16 Important Database Tables and Files from /data/data/com.facebook.katana/databases/fb.db
  id: totrans-724
  prefs: []
  type: TYPE_NORMAL
  zh: 表7.16 来自/data/data/com.facebook.katana/databases/fb.db的重要数据库表和文件
- en: '![Image](img/T10007XtabT0085.jpg)'
  id: totrans-725
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/T10007XtabT0085.jpg)'
- en: Analyst Notes
  id: totrans-726
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.facebook.katana:'
  id: totrans-727
  prefs: []
  type: TYPE_NORMAL
  zh: 对于/data/data/com.facebook.katana的分析师笔记：
- en: '• The fb.db contains nearly all of the information and only three of the tables
    were profiled above. Full table list includes the following:'
  id: totrans-728
  prefs: []
  type: TYPE_NORMAL
  zh: • fb.db几乎包含了所有信息，上面只分析了三个表。完整的表单列表包括以下内容：
- en: • albums
  id: totrans-729
  prefs: []
  type: TYPE_NORMAL
  zh: • albums
- en: • info_contacts
  id: totrans-730
  prefs: []
  type: TYPE_NORMAL
  zh: • info_contacts
- en: • notifications
  id: totrans-731
  prefs: []
  type: TYPE_NORMAL
  zh: • notifications
- en: • android_metadata
  id: totrans-732
  prefs: []
  type: TYPE_NORMAL
  zh: • android_metadata
- en: • key_value
  id: totrans-733
  prefs: []
  type: TYPE_NORMAL
  zh: • key_value
- en: • perf_sessions
  id: totrans-734
  prefs: []
  type: TYPE_NORMAL
  zh: • perf_sessions
- en: • chatconversations
  id: totrans-735
  prefs: []
  type: TYPE_NORMAL
  zh: • chatconversations
- en: • mailbox_messages
  id: totrans-736
  prefs: []
  type: TYPE_NORMAL
  zh: • mailbox_messages
- en: • photos
  id: totrans-737
  prefs: []
  type: TYPE_NORMAL
  zh: • photos
- en: • chatmessages
  id: totrans-738
  prefs: []
  type: TYPE_NORMAL
  zh: • chatmessages
- en: • mailbox_messages_display
  id: totrans-739
  prefs: []
  type: TYPE_NORMAL
  zh: • mailbox_messages_display
- en: • search_results
  id: totrans-740
  prefs: []
  type: TYPE_NORMAL
  zh: • search_results
- en: • default_user_images
  id: totrans-741
  prefs: []
  type: TYPE_NORMAL
  zh: • default_user_images
- en: • mailbox_profiles
  id: totrans-742
  prefs: []
  type: TYPE_NORMAL
  zh: • mailbox_profiles
- en: • stream_photos
  id: totrans-743
  prefs: []
  type: TYPE_NORMAL
  zh: • stream_photos
- en: • events
  id: totrans-744
  prefs: []
  type: TYPE_NORMAL
  zh: • events
- en: • mailbox_threads
  id: totrans-745
  prefs: []
  type: TYPE_NORMAL
  zh: • mailbox_threads
- en: • user_statuses
  id: totrans-746
  prefs: []
  type: TYPE_NORMAL
  zh: • user_statuses
- en: • friends
  id: totrans-747
  prefs: []
  type: TYPE_NORMAL
  zh: • friends
- en: • mailbox_users
  id: totrans-748
  prefs: []
  type: TYPE_NORMAL
  zh: • mailbox_users
- en: • user_values
  id: totrans-749
  prefs: []
  type: TYPE_NORMAL
  zh: • user_values
- en: • The files directory contains a significant number of images from the Facebook
    app.
  id: totrans-750
  prefs: []
  type: TYPE_NORMAL
  zh: • 文件目录包含了来自Facebook应用的大量图片。
- en: Adobe Reader
  id: totrans-751
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Adobe Reader
- en: App Info
  id: totrans-752
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 应用信息
- en: This is the official Abode Reader for PDF files
  id: totrans-753
  prefs: []
  type: TYPE_NORMAL
  zh: 这是官方的Adobe PDF文件阅读器
- en: '• App Name: Adobe Reader'
  id: totrans-754
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用名称：Adobe Reader
- en: '• Package name: com.adobe.reader'
  id: totrans-755
  prefs: []
  type: TYPE_NORMAL
  zh: • 包名称：com.adobe.reader
- en: '• Version: 9.0.1'
  id: totrans-756
  prefs: []
  type: TYPE_NORMAL
  zh: • 版本：9.0.1
- en: '• Device: HTC Incredible'
  id: totrans-757
  prefs: []
  type: TYPE_NORMAL
  zh: • 设备：HTC Incredible
- en: '• App developer: Adobe'
  id: totrans-758
  prefs: []
  type: TYPE_NORMAL
  zh: • 应用开发者：Adobe
- en: Directories, Files, and File Types
  id: totrans-759
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 目录、文件和文件类型
- en: 'In /data/data/com.adobe.reader:'
  id: totrans-760
  prefs: []
  type: TYPE_NORMAL
  zh: 在/data/data/com.adobe.reader中：
- en: '![image](img/F10007Xu07-94-9781597496513.jpg)'
  id: totrans-761
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-94-9781597496513.jpg)'
- en: Important Database Tables and Files
  id: totrans-762
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重要的数据库表和文件
- en: 'The com.adobe.reader.preferences.xml preferences file:'
  id: totrans-763
  prefs: []
  type: TYPE_NORMAL
  zh: com.adobe.reader.preferences.xml偏好文件：
- en: '![image](img/F10007Xu07-95-9781597496513.jpg)'
  id: totrans-764
  prefs: []
  type: TYPE_IMG
  zh: '![图像](img/F10007Xu07-95-9781597496513.jpg)'
- en: Analyst Notes
  id: totrans-765
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 分析师笔记
- en: 'Analyst notes for /data/data/com.adobe.reader:'
  id: totrans-766
  prefs: []
  type: TYPE_NORMAL
  zh: 对于/data/data/com.adobe.reader的分析师笔记：
- en: • Cached PDF files are stored in the cache directory.
  id: totrans-767
  prefs: []
  type: TYPE_NORMAL
  zh: • 缓存的PDF文件存储在缓存目录中。
- en: • A list of recent files is stored in cache/com.adobe.reader.preferences.xml.
  id: totrans-768
  prefs: []
  type: TYPE_NORMAL
  zh: • 最近文件列表存储在cache/com.adobe.reader.preferences.xml中。
- en: Summary
  id: totrans-769
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: While the acquisition of Android devices is the focus of much research, development,
    and discussion, it is really only half of the challenge of Android forensics.
    Analysis is needed with both logical and physical techniques. However, the amount
    of analysis needed after a physical acquisition is far greater. The goal of this
    chapter was to provide techniques that would allow a forensic analyst or security
    engineer to examine and extract data from acquisitions even if the file systems
    are not supported by forensic utilities. By leveraging existing forensic utilities,
    Linux commands and, at times, hex analysis, much of the data required for an investigation
    are available.
  id: totrans-770
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管获取Android设备是研究、开发和讨论的重点，但这实际上只是Android取证挑战的一半。需要使用逻辑和物理技术进行分析。然而，物理获取后所需的分析量要大得多。本章的目标是提供技术，使法医分析师或安全工程师能够检查并从获取的数据中提取信息，即使文件系统不受取证工具支持。通过利用现有的取证工具、Linux命令，有时还有十六进制分析，可以获取调查所需的大部分数据。
- en: References
  id: totrans-771
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参考文献
- en: 1\. *File times (Windows)*. (n.d.). Retrieved February 13, 2011, from [http://msdn.microsoft.com/en-us/library/ms724290%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms724290%28VS.85%29.aspx).
  id: totrans-772
  prefs: []
  type: TYPE_NORMAL
  zh: 1\. *文件时间（Windows）*。（未确定日期）。2011年2月13日检索自[http://msdn.microsoft.com/en-us/library/ms724290%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms724290%28VS.85%29.aspx)。
- en: 2\. Carrier, B. (n.d.). Mactime output—SleuthKitWiki. Retrieved February 13,
    2011, from [http://wiki.sleuthkit.org/index.php?title=Mactime_output](http://wiki.sleuthkit.org/index.php%3Ftitle%3DMactime_output).
  id: totrans-773
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. Carrier, B. （未确定日期）。Mactime输出—SleuthKitWiki。2011年2月13日检索自[http://wiki.sleuthkit.org/index.php?title=Mactime_output](http://wiki.sleuthkit.org/index.php%3Ftitle%3DMactime_output)。
- en: 3\. Casey, E. (n.d.). Misinterpretation of file system timestamps. Retrieved
    February 13, 2011, from [http://blog.cmdlabs.com/2009/05/08/misinterpretation-of-file-system-timestamps/](http://blog.cmdlabs.com/2009/05/08/misinterpretation-of-file-system-timestamps/).
  id: totrans-774
  prefs: []
  type: TYPE_NORMAL
  zh: 3\. Casey, E. （未确定日期）。文件系统时间戳的误解。2011年2月13日检索自[http://blog.cmdlabs.com/2009/05/08/misinterpretation-of-file-system-timestamps/](http://blog.cmdlabs.com/2009/05/08/misinterpretation-of-file-system-timestamps/)。
- en: 4\. *Debugging in Android with tombstones*. (n.d.). Retrieved March 14, 2011,
    from [http://crazydaks.com/debugging-in-android-with-tombstones.html](http://crazydaks.com/debugging-in-android-with-tombstones.html).
  id: totrans-775
  prefs: []
  type: TYPE_NORMAL
  zh: 4\. 《使用墓碑在Android中进行调试》. (未标明日期). 从 [http://crazydaks.com/debugging-in-android-with-tombstones.html](http://crazydaks.com/debugging-in-android-with-tombstones.html)
    检索于2011年3月14日。
- en: '5\. *Digital assembly: Adroit photo forensics—SmartCarving™*. (n.d.). Retrieved
    February 13, 2011, from [http://digital-assembly.com/products/adroit-photo-forensics/features/smartcarving.html](http://digital-assembly.com/products/adroit-photo-forensics/features/smartcarving.html).'
  id: totrans-776
  prefs: []
  type: TYPE_NORMAL
  zh: 5\. 《数字装配：Adroit照片取证—SmartCarving™》. (未标明日期). 从 [http://digital-assembly.com/products/adroit-photo-forensics/features/smartcarving.html](http://digital-assembly.com/products/adroit-photo-forensics/features/smartcarving.html)
    检索于2011年2月13日。
- en: 6\. *Digital Detective—DCode*. (n.d.). Retrieved February 14, 2011, from [http://www.digital-detective.co.uk/freetools/decode.asp](http://www.digital-detective.co.uk/freetools/decode.asp).
  id: totrans-777
  prefs: []
  type: TYPE_NORMAL
  zh: 6\. 《数字侦探—DCode》. (未标明日期). 从 [http://www.digital-detective.co.uk/freetools/decode.asp](http://www.digital-detective.co.uk/freetools/decode.asp)
    检索于2011年2月14日。
- en: 7\. *Epoch converter—epoch & unix timestamp conversion tools*. (n.d.). Retrieved
    February 14, 2011, from [http://www.epochconverter.com/](http://www.epochconverter.com/).
  id: totrans-778
  prefs: []
  type: TYPE_NORMAL
  zh: 7\. 《Epoch转换器—Epoch与Unix时间戳转换工具》. (未标明日期). 从 [http://www.epochconverter.com/](http://www.epochconverter.com/)
    检索于2011年2月14日。
- en: 8\. Grundy, B. (n.d.). Linux LEO. Retrieved February 19, 2011, from [http://www.linuxleo.com](http://www.linuxleo.com).
  id: totrans-779
  prefs: []
  type: TYPE_NORMAL
  zh: 8\. Grundy, B. (未标明日期). Linux LEO. 从 [http://www.linuxleo.com](http://www.linuxleo.com)
    检索于2011年2月19日。
- en: 9\. Kessler, G. (n.d.). File signatures table. Retrieved February 13, 2011,
    from [http://www.garykessler.net/library/file_sigs.html](http://www.garykessler.net/library/file_sigs.html).
  id: totrans-780
  prefs: []
  type: TYPE_NORMAL
  zh: 9\. Kessler, G. (未标明日期). 文件签名表. 从 [http://www.garykessler.net/library/file_sigs.html](http://www.garykessler.net/library/file_sigs.html)
    检索于2011年2月13日。
- en: '10\. Ross, A. (n.d.). digfor: Time and timestamps. Retrieved February 13, 2011,
    from [http://digfor.blogspot.com/2008/10/time-and-timestamps.html](http://digfor.blogspot.com/2008/10/time-and-timestamps.html).'
  id: totrans-781
  prefs: []
  type: TYPE_NORMAL
  zh: '10\. Ross, A. (未标明日期). digfor: 时间和时间戳. 从 [http://digfor.blogspot.com/2008/10/time-and-timestamps.html](http://digfor.blogspot.com/2008/10/time-and-timestamps.html)
    检索于2011年2月13日。'
- en: 11\. *Rovio—Angry Birds*. (n.d.). Retrieved February 15, 2011, from [http://www.rovio.com/index.php?page=angry-birds](http://www.rovio.com/index.php%3Fpage%3Dangry-birds).
  id: totrans-782
  prefs: []
  type: TYPE_NORMAL
  zh: 11\. 《愤怒的小鸟—Rovio》. (未标明日期). 从 [http://www.rovio.com/index.php?page=angry-birds](http://www.rovio.com/index.php%3Fpage%3Dangry-birds)
    检索于2011年2月15日。
- en: '12\. *Scalpel: a frugal, high performance file carver*. (n.d.). Retrieved February
    13, 2011, from [www.digitalforensicssolutions.com/Scalpel/](http://www.digitalforensicssolutions.com/Scalpel/).'
  id: totrans-783
  prefs: []
  type: TYPE_NORMAL
  zh: 12\. 《Scalpel：一个节俭、高性能的文件雕刻器》. (未标明日期). 从 [www.digitalforensicssolutions.com/Scalpel/](http://www.digitalforensicssolutions.com/Scalpel/)
    检索于2011年2月13日。
- en: 13\. *What is my IP address*. (n.d.). Retrieved February 19, 2011, from [http://www.whatismyip.com/](http://www.whatismyip.com/).
  id: totrans-784
  prefs: []
  type: TYPE_NORMAL
  zh: 13\. 《我的IP地址是什么》. (未标明日期). 从 [http://www.whatismyip.com/](http://www.whatismyip.com/)
    检索于2011年2月19日。
- en: 14\. *YAFFS debugging*. (n.d.). Retrieved February 17, 2011, from [http://www.yaffs.net/yaffs-debugging](http://www.yaffs.net/yaffs-debugging).
  id: totrans-785
  prefs: []
  type: TYPE_NORMAL
  zh: 14\. 《YAFFS调试》. (未标明日期). 从 [http://www.yaffs.net/yaffs-debugging](http://www.yaffs.net/yaffs-debugging)
    检索于2011年2月17日。
