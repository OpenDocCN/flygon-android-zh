# 第五章

# 安卓设备、数据及应用安全

### 本章节的信息

• 数据盗窃目标和攻击向量

• 安全考虑

• 个人安全策略

• 企业安全策略

• 应用开发安全策略

## 引言

在法医分析师和隐私倡导者之间保持微妙的平衡。如果设备的安全性达到 100%，那么对设备的法医调查将无法返回任何信息。另一方面，如果设备的安全措施完全缺失，法医专业知识几乎不需要从设备中提取有意义的数据。

移动取证的主要消费者是执法和政府部门。他们在移动设备上使用和保护许多类型的敏感数据，并且他们有调查犯罪的授权和权力。他们不仅依赖数字法医分析，还可以通过搜查令和传票行使权力，并迫使大多数组织提供所需的信息，如财务记录、电子邮件、互联网服务提供商日志等。

同样，企业需要保护其敏感数据，有时还会进行内部调查以确保安全。尽管他们的权力范围不超出公司，但在美国，企业可以在其拥有的设备上进行广泛的搜索权限。

最终，个人有权访问自己的数据。无论他们是在民事诉讼中这样做，还是其他事项，他们都有权在他们拥有的设备上进行操作。

在个人和企业的情况下，各方通常没有必要恢复他们在有权调查的设备上的敏感信息，如信用卡、银行信息或密码。企业在内部调查中不会寻求个人的信用卡数据，并且他们有能力访问企业电子邮件系统并更改密码。在个人情况下，他们已经可以访问自己的财务记录、电子邮件以及其他敏感数据。在执法和政府部门的情况下，他们可以利用传票和搜查令的权力获取他们所需的数据。

因此，最终可能从移动设备上存储的不安全高度敏感数据中受益的只有网络犯罪分子。在许多针对移动设备的个人、企业和犯罪调查过程中，我们发现了一些与案件无关的高度敏感个人信息。然而，如果网络犯罪分子能够访问该设备——无论是物理占有还是通过远程攻击——他们能够收集的数据将给消费者带来重大风险。

同样，企业也成为商业间谍、金融盗窃、知识产权盗窃以及其他各种攻击的目标。随着许多企业转向员工自有设备，对设备的控制和监管进一步减少，使得企业数据面临极大的风险。

最后，执法和政府机构也受到移动安全问题的不利影响。这些机构由个人组成，他们面临与消费者相同的数据暴露风险。与公司一样，机构本身也可能成为攻击的目标，这些攻击不仅寻求可能危及调查或使机构尴尬的敏感数据，还可能包括与国际间谍活动一样严重的攻击。而执法和政府机构面临的独特挑战是，许多涉及移动设备的犯罪必须进行调查，这给已经超负荷的刑事侦查部门和数字取证实验室带来了压力。

由于这些原因，移动设备安全成为了个人、企业和执法政府机构日益关注的问题。

## 数据盗窃的目标和攻击向量

在这一点上，任何还在继续阅读的人都很清楚，智能手机，尤其是安卓设备，包含了大量的信息，常常是个人和企业数据的混合体。安卓设备不仅是数据盗窃的目标，也可能成为盗窃发生的手段（攻击向量）。了解各种威胁和场景将使安全工程师和开发人员能够设计适当的控制措施来降低风险。虽然这一章节无法对如此广泛的主题提供详尽的覆盖，但将讨论具体的威胁和缓解策略，并应作为安全专业人员的强大起点。

### 安卓设备作为目标

移动安全研究、漏洞利用和文章的主要关注点一直是智能手机作为数据盗窃的目标，这是有道理的。对消费者、企业和机构的威胁是真实存在的，大多数安全专家认为，针对移动设备的恶意软件正在上升，并将继续成为网络犯罪分子的关注焦点。

移动设备以高度集中和便携的形式包含了大量的个人和企业数据。犯罪分子通常是务实的，网络犯罪分子也不例外。如果他们能够利用一个不仅包含个人用户名、密码和个人敏感信息，还包含雇主相同类型信息的设备，他们显然会瞄准这个机会。此外，尽管一个移动应用程序的数据可能不足以让犯罪分子达到目的，但结合从众多已安装应用程序中发现的信息通常会形成一个关于设备主人的惊人完整的资料。

移动设备不仅容易丢失且相对容易被盗，而且在消费者想要最新型号之前，其使用场景也相对较短。这两种情况都导致通过 eBay 和 Craigslist 等平台购买的手机数量增多，许多设备没有正确擦除，留下了完整的个人数据。此外，恶意代码、恶意软件和远程攻击越来越多地针对移动设备，历史表明它们将导致重大的数据盗窃。这些攻击的有效性只有在时间推移中才能确定；但考虑到操作系统（在本例中为 Android）的快速发展以及移动应用的迅速普及，可以合理预期许多攻击将会成功。

#### 静态数据

静态数据是指存储在非易失性内存中的数据，因此既不在 RAM 中也不通过网络（蜂窝、数据或其他网络）传输。静态数据一词常用于法律和规定中，定义了一个必须保护数据的关键状态。

在整本书中，我们强调了 Android 设备包含的不同数据示例。在这里，让我们考虑两个虚构的场景：一个关注企业客户，另一个关注个人用户。

对于个人用户而言，Android 设备用于个人通讯、个人理财、娱乐以及一般的信息浏览。检查手机可能会恢复以下内容：

• SMS/MMS：所有已分配（未删除）的 SMS 和 MMS 都可以恢复，以及大部分未分配（已删除但仍在 NAND 闪存上）的短信。恢复的信息将包括短信本身以及任何附件，如图片、视频、音频文件、手机联系人（.vcf 文件）、日历项目等。还有许多第三方 SMS/MMS 应用可能包括其他功能。

• 通话记录：尽管也可以从无线运营商那里获得，但完整的通话记录是可以恢复的。这些可能包括未能到达运营商的通话尝试以及我们可以与之相关联的其他元数据，如位置（这也可以根据蜂窝基站大致估计）以及通话拨打前设备上发生的其他活动。

• 语音邮件：在安装了语音邮件应用程序的情况下，如 Verizon 的可视语音邮件，通常可以恢复已分配的语音邮件消息作为音频文件（.OGG）。一些未分配的语音邮件消息也可能恢复。

• 金融应用：虽然它们各不相同，但大多数安装的金融应用会在本地存储一些数据或缓存网页。在某些情况下，可恢复的信息可能包括用户登录名、密码、账户号码和交易详情。例如，在我们的测试中，[Mint.com](http://Mint.com) 应用存储了用户名、访问本地应用的 PIN 码以及一些银行账户交易信息。

• 个人电子邮件：大多数安装的电子邮件应用以明文形式存储电子邮件消息的内容，包括电子邮件头（收/发电子邮件地址）。在某些情况下，还可以恢复包括用户登录名和密码在内的用户凭据。例如，标准的 Android 邮件应用在通过 POP3 连接到 Hotmail 时，被发现以明文形式存储密码。

• 网络历史：可恢复分配的网络历史记录，包括访问过的 URL、cookies 和缓存页面。未分配的空间可能包含额外的网络历史信息。

• 谷歌搜索历史：包括搜索词的谷歌 URL。

• YouTube：观看的视频的 URL。

• 图片和视频：用户拍摄的照片和视频，存储在设备上，与应用程序相关联以及其他内容。

• 地理位置信息：图片中的 GPS 坐标，其他遗迹。

• 游戏历史和互动记录。

在这个虚构的情况下，一个熟练的法医检查员可以恢复有关个人的大量信息。

在我们的企业示例中，它仅仅建立在个人之上，因为大多数设备将个人信息与企业信息混合在一起。以下是一些通常可以从企业设备上恢复的额外项目：

• 企业电子邮件和附件

• 通过电子邮件发送的语音邮件和传真

• 用户名、密码和域名信息

• Wi-Fi 接入点、信息及密码

• 日历项目

• 即时通讯或其他与员工的通信

• 为了方便存储在设备上的企业文件

如你所见，如果攻击者想要寻找有效的方法渗透企业，员工的设备（或更好几个员工的设备）可以提供许多洞察和攻击途径——更不用说直接从设备上恢复敏感的企业信息了。

一个可能引起企业安全经理高度警惕的具体例子是，Android 内置的电子邮件应用如何存储使用微软的 exchange ActiveSync（EAS）协议的电子邮件账户的凭据。用于对 EAS 进行身份验证的凭据是用户的活动目录域用户名和密码。许多企业将身份验证、授权和计费（AAA）服务集中到活动目录中，从而实现单点登录和简化管理。总的来说，简化带来了更有效的安全性。在 Android 邮件应用（com.android.mail）中，用户的 EAS 以明文形式存储在一个明确定义的位置。数据库存储在/data/data/com.android.email 中，以下是文件夹和文件的概览：

![图像](img/F100056u05-01-9781597496513.jpg)

密码位于 EmailProvider.db 中，在一个名为 HostAuth 的表中的 password 列中：

![图像](img/F100056u05-02-9781597496513.jpg)

除了账户的用户名、密码和域名外，电子邮件的全部主题和正文都存储在数据目录中，以及附件、偏好设置和其他信息。所有这些信息都以明文形式存储（这里想到了“银盘”一词）。

攻击者访问静止数据的主要技术有两种。第一种需要物理访问设备，并使用与法医检查员本质上相同的技术，这些技术将在第六章中进行探讨。虽然物理访问设备并不一定容易实现，但我们上面提到了一些可能的情况，包括丢失或被盗的手机以及更换新机型时没有安全擦除的手机。此外，国际旅行的人，尤其是公司高管，可能会发现他们在进入一个国家时，手机被海关官员暂时没收并检查。在这种情况下，官员可以无限制地物理访问设备。

攻击者访问静止数据的另一种主要技术是远程利用和恶意软件。在这些情况下，攻击者能够通过使用编程和社会工程学技术获得额外的权限。这些技术可能包括利用 Linux 内核和 Android 核心库中发现的漏洞、网络钓鱼攻击或利用应用程序中的漏洞。此外，用户可能会无意中安装应用程序并授予超出所需访问权限的权限，从而使恶意软件能够访问静止数据。最后，社会工程仍然是一种非常有效的系统破坏方式，移动设备对此并不免疫。用户习惯于安装各种应用程序，通常对应用程序提供商了解甚少，并且经常信任并在电子邮件和短信中随意点击呈现给他们的链接，从而为社会工程学攻击打开了途径。

#### 在传输中的数据

在传输中的数据（有时称为动态数据）是指通过网络（蜂窝、Wi-Fi 或其他网络）传输的数据，或位于 RAM 中的数据。在法律和规定中经常使用数据在传输中的术语，并定义了必须保护数据的另一个关键状态。

通常，设备上存储的大多数信息（如上所述）在某个时刻都曾通过网络传输。除了数据本身，还有大量从未持久化到设备的信息需要传输和保护。以下是一些例子：

• 密码：许多应用程序不在设备上存储密码，并要求用户每次打开应用程序时都进行身份验证。因此，密码只是传输，并不存储。

• 双因素认证

• 密码重置安全响应

• 在应用程序中显示但未保存或缓存到非易失性存储的数据（例如，账户号码和余额）

展示数据在网络中传输的一个好方法是举例说明。在这个例子中，一台运行 BackTrack 4（基于 Linux 的渗透测试套件）的计算机连接到一个网络集线器，该集线器还连接了一个 Wi-Fi 接入点。计算机上的网络接口设置为混杂模式，这使得设备可以看到网络集线器上的所有流量，即使流量并非发往该接口。运行 urlsnarf 程序，它拦截网络接口（eth0）上的流量，并检查是否有 URL。如果找到 URL，就会将其打印到屏幕上。请记住，所有网络流量都被拦截，因此任何未加密的数据，如用户名或密码，也可能被类似地捕获和查看。

![image](img/F100056u05-03a-9781597496513.jpg)

![image](img/F100056u05-03b-9781597496513.jpg)

攻击者用来在传输过程中破坏数据的几种已知技术，以及安全研究人员自己发现或在实际环境中揭露的新技术。一些已知的技术包括：

• 中间人（MITM）攻击

• MITM 安全套接字层（SSL）攻击

• DNS 欺骗攻击（包括/etc/hosts）

• TMSI 溢出基带攻击

基带攻击是一种非常新的技术，专注于蜂窝调制解调器（基带）固件。在 2010 年 DeepSec 会议上展示其攻击手段的 Ralf-Philipp Weinmann 表示，基带固件是 20 世纪 90 年代编写的代码。直到最近，GSM 网络背后的技术还鲜为人知。然而，随着时间的推移，研究人员揭开了协议和硬件的秘密，如今使用现成的硬件和开源软件可以创建一个恶意的 GSM 基站。控制了 GSM 网络，攻击者可以执行 TMSI 溢出攻击，该攻击会在 iOS 4.2 之前的苹果 iOS 设备的 GSM 基带堆栈中引起堆溢出。这种攻击可能导致基带处理器上的远程代码执行（Ralf-Philipp Weinmann, n.d.）。

虽然基带攻击是尖端的安全工作，但 MITM 攻击已经存在了很长时间，并且被充分理解且相对容易执行。通常，这些技术需要攻击者完全控制位于移动设备和设备试图与之通信的最终目的地之间的计算机。此外，攻击者可能控制关键网络服务或设备，如网络交换机、Wi-Fi 接入点或 DNS 服务器，从而促进攻击的进行。

一旦攻击者能够将他们的计算机定位在 Android 设备与最终目的地之间，他们就可以发起攻击。在这个场景中，让我们假设一个 Android 设备连接到一个 Wi-Fi 网络，却不知道一个恶意的攻击者控制了这个网络。用户开始上网冲浪，并最终决定检查他们的 Twitter 账户。为了简化示例，让我们假设他们使用的 Twitter 应用没有实现 SSL——大多数都没有，尽管最近官方应用开始朝这个方向发展。

当用户启动该应用时，它将连接到 Twitter 网站，进行身份验证，并引导用户进入他们的账户。当然，在此过程中，攻击者捕获了网络流量，现在拥有了 Twitter 的用户名和密码。如果应用确实使用了 SSL，但没有正确验证 SSL 证书，那么它们将容易受到 MITM SSL 攻击，如图 5.1 所示。

![image](img/F100056f05-01-9781597496513.jpg)

图 5.1 中间人 SSL 攻击。

尽管这种攻击可能只捕获一个密码，但大多数用户会在许多不同的网站上重复使用用户名和密码。一旦攻击者拥有了一个用户名和密码，他们就可以开始研究关于消费者的更多信息，并且通常能够找到他们可以访问的其他系统。

另一个非常著名的攻击手段是利用拦截 HTTP 会话 Cookie 来劫持网站上另一个用户的认证会话，并开始作为该用户行事。Eric Butler 的 Firefox 浏览器扩展 Firesheep（[`codebutler.com/firesheep`](http://codebutler.com/firesheep)）展示了这种攻击可以多么容易。尽管使用 Wi-Fi 上的 WPA 和其他本地措施等强加密可以使事情变得更加困难，但只要网站不要求全程使用 HTTPS，这种攻击仍然是有可能的。

### Android 设备作为攻击途径

尽管媒体和许多安全研究人员主要关注针对移动设备的攻击，但越来越令人担忧的是将 Android 设备作为攻击途径，特别是在存储敏感数据的环境中。最常见的场景是在拥有商业机密、知识产权或其他需要保护数据的公司中找到。公司通常实施复杂的系统，旨在防止或至少检测到数据被盗。这些系统不仅购买成本高昂，而且通常需要熟练的员工来维护、监控并根据它们提供的信息采取行动。

直到最近，大多数数据保护系统主要关注保护企业边界，以防止攻击者进入受保护区域。随着时间的推移，也开发出了旨在防止内部威胁的系统。最新的系统进一步深入到网络和基础设施中，试图挫败攻击。这些系统关注诸如数据丢失预防（DLP）、网络访问控制（NAC）和网络取证等领域。然而，目前可用的解决方案尚未完全解决移动设备带来的威胁。

智能手机显然很受欢迎，大多数人也是按照预期使用它们。它们通常是个人所有且使用频繁的设备，要求某人放弃他们的设备是一种侵扰性的请求。由于这些原因，Android 设备和其他智能手机最终会出现在存放敏感信息的地点，而没有人表示关注。相反，如果有人带入了数码相机、录音设备、摄像机、外接硬盘或他们自己的网络设备，可能会引起一些注意。当然，Android 设备实际上在一个紧凑且看似无害的设备中集成了所有这些功能及更多。

### 数据存储

也许是利用 Android 设备窃取信息的最简单例子就是将其作为 USB 大容量存储设备使用。直到最近，智能手机的数据存储空间还非常有限。然而，随着 NAND 闪存的成熟，制造商意识到他们可以成本效益地制造出可以存储许多吉字节数据的设备。现在的 Android 设备可以在 NAND 闪存上轻松存储 8 到 16 GB 的数据，并且许多设备还包括一个外部 SD 卡，可以存储额外的 16 GB 或更多数据。

### 录音设备

Android 设备也完全有能力记录它们周围几乎任何东西。它们可以轻松地拍摄敏感设备或文件的图片。它们还可以录制视频，捕捉穿越建筑物的路径，包括沿途的声音、安全站、窗户、楼梯井以及其他感兴趣的项目。最后，Android 设备还可以被动地录制音频。所有这些都可以在不引起任何注意的情况下完成。

#### 绕过网络控制

也许甚至更危险的功能是 Android 设备能够为计算机或具有无线功能的设备提供单独的网络连接。实现这一功能的方法有多种。在一种场景中，攻击者（可能是心怀不满的员工）可以将他们的 Android 设备连接到工作站。从表面上看，这并不会引起任何警觉，因为许多人工作时都会这样做以充电。然而，在 Android 设备和计算机上安装一个小程序后，将为计算机提供一个全新的网络连接。在这种情况下，从计算机路由出去并通过 Android 设备传输的流量完全不受环境控制。这个连接完全绕过了公司的防火墙、网络访问控制、数据丢失防护和其他安全控制措施。

最新的 Android 设备无需上述场景中的 USB 线和软件包。相反，Android 设备变成了一个完全功能的无线接入点，计算机可以通过它连接。这个场景同样有效地绕过了现有的网络安全控制，并且可以在将设备放在手提箱或口袋中时执行。

真正狡猾的技术

如果有人认为网络犯罪分子或其他攻击者不聪明、不具创造性，那么他们是在严重地判断失误。因此，让我们运用上述一些技术，跳出思维定势。

在这个场景中，攻击者是一家拥有重要商业机密和知识产权的公司的员工。（攻击者不一定需要在那里工作；然而，这使例子更简单。）许多可以访问这些信息的执行官也携带笔记本电脑和智能手机。这些执行官中的许多人在一家提供免费 Wi-Fi 的热门咖啡店喝咖啡。咖啡店的无线接入点名为“indigo”，由于他们不要求输入密码，接入点是开放的且未加密的。当执行官在咖啡店喝咖啡、用餐或开会时，他们会将智能手机和笔记本电脑连接到 Wi-Fi。

当他们回到办公室时，他们没有关闭智能手机和笔记本电脑上的无线功能。心怀不满的员工当然知道咖啡店的无线接入点，并决定在 Android 设备上启用接入点功能。自然，他在设备上拥有 root 权限，因此他还安装并运行了允许他捕获网络流量的软件。当一位高管靠近他的 Android 设备时，智能手机或笔记本电脑就会与他设置的接入点关联。然后，他能够拦截流量，捕获敏感文件和通信内容，或者可能捕获他可以用来访问关键网络资源的凭据。

尽管攻击者要实现这一场景必须克服一些障碍，但这是非常可能的，并且说明了当 Android 设备作为攻击载体时所呈现的独特风险。

## 安全考虑事项

安全与开发一样，是一门艺术。可能有人不同意这个说法，但那些人很少会阅读法医与安全方面的书籍。安全是一个艺术过程，因为艺术是“人类创造力的产物”以及“通过学习、实践和观察可以获得的高级技能”(WordNet Search, n.d.)。那么，这一切为何相关？成功的安全策略需要正确混合和平衡经验、判断、风险评估、创造力、观察、技能，甚至可能还需要一点运气。本节旨在介绍与 Android 和安全相关的一些广泛概念。

### 安全理念

安全几乎总是需要权衡的，即在攻击风险与缓解该风险的成本（财务或其他成本）之间进行权衡。理论上，一个完全安全的系统是可能的，但实际上几乎不可能实现，特别是当社会工程学攻击是可行的时候。即使安全专家控制了对设备的访问，包括物理和远程访问，确保一个系统的安全也是非常困难的。

移动设备比传统系统更难以保护。企业安全工程师对计算机系统的大部分控制措施在 Android 设备上不可能实现。首先，设备由一个庞大、复杂且多元化的参与者群体组装和维护的硬件和软件组成，包括核心 Android 团队、制造商的软硬件以及无线运营商的软硬件。此外，设备所有者有能力安装自定义应用程序，如果权限足够，甚至可以显著修改设备。最后，设备会穿越许多网络，没有一个可以完全信任。是的，保护移动设备是一个巨大的挑战。

尽管面临这些挑战，我们仍然可以在设备中设计一些安全控制措施。以下这个梗有助于总结整体的策略和理念：

*如果你保护好了它，他们就不会来。*

这个概念源自 1989 年环球影业的电影“梦幻球场”，其中有一个声音鼓励主角在他的爱荷华农场建造一个棒球场。电影中，这个声音反复说，“如果你建造了它，他就会来”(Ten, n.d.)。最终，主角确实建造了球场，实际上，神秘的客人也确实出现了。但完整的情节你还需要观看电影。

那么，这对移动安全有何影响？在理想情况下加密安全的系统与一个将所有信息以明文形式存储在良好组织和已知结构中的系统之间，存在着很大的差距，正如前面 com.android.email 的例子所描述的。由于移动设备面临许多不同的风险，即使是加密的数据也可能被攻破。然而，提供一定程度的混淆或加密将使攻击者攻破数据的过程变得复杂。尽管这种方法不是 100%安全，但攻击者往往实际并倾向于攻击容易获取的数据。

反对这种方法的观点之一是，一旦混淆或加密可以被攻破，它就会提供一个虚假的安全感，导致用户在认为他们的数据安全无懈可击的情况下，更随意地处理设备。而如果数据以明文存储，用户意识到风险，他们将更加谨慎地使用设备。

最终，移动设备的个人和企业消费者将通过他们的购买决策，引导移动安全生态系统向他们所重视的方向发展。这必然取决于教育。消费者必须充分了解数据安全风险和可能的解决方案。

有许多潜在的解决方案，虽然它们不能提供一个加密上安全的系统，但通过增加成功攻击的复杂性，确实提高了数据的安全性。以下列表说明了一些概念：

1. 要求用户在设备重启后首次运行应用程序时输入密码，并且只在内存中存储密码。在这种情况下，密码不会以明文形式存储在设备上。然而，它在内存中，拥有足够设备权限的攻击者可能会恢复密码。

2. 进一步，通过基于时间、伪随机数据等加密存储在内存中的密码，来加强上述概念。这样，攻击者现在必须拥有设备的 root 权限，而不仅仅是转储进程的内存，他们还必须找到加密密钥、加密密码以及组成密码的算法。

3. 进一步地，内存密码可能会在一定时间后过期，或者内存中使用的加密密钥可能会更改。

4. 如果密码存储在 NAND 闪存上，使用一个在设备重启后输入的密码短语对其进行加密。

尽管这些想法并不能提供一个完全安全的系统，但是要攻破数据所需付出的努力和权限比攻破以明文存储的敏感数据要高好几个数量级，因此这阻止了大多数攻击者。

### 美国联邦计算机犯罪法律和规定

美国有许多与静止数据和传输数据安全相关的联邦法律。本节的目标是简单列举几项较为相关的法律，并简要介绍它们。总共有超过 40 项联邦法规可用于起诉与计算机相关的犯罪行为（[国家，不详]）。此外，每个州通常都有针对计算机犯罪的法律和规定。

在联邦层面，美国司法部（DoJ）将计算机犯罪划分为三个不同的领域，其中两个领域与破坏移动设备时涉及的犯罪类型有广泛的应用。这两个领域是（[国家，不详]）：

1. 直接针对计算机网络或设备的犯罪，包括黑客攻击、病毒、蠕虫、恶意软件、嗅探器等。

2. 利用计算机网络或设备实施的犯罪，如欺诈、身份盗窃、企业间谍活动等。

计算机欺诈和滥用法（CFAA）专注于针对政府金融机构计算机或涉及州际或国际商务的计算机的攻击。该法案涵盖了狭窄的领域，如未经适当授权访问计算机以获取与国家安全问题相关的数据，以及更广泛的领域，如未经适当授权访问计算机以进行欺诈或获取有价值的东西。CFAA 经过国家信息基础设施保护法的修订，涵盖了新的滥用行为，并包括了那些打算犯罪的人。

电子通信隐私法（ECPA）是另一项涵盖计算机犯罪的法律，它规定未经授权截取存储或传输的电子通信是非法的。ECPA 包含几个关键领域：

• 在传输过程中的通信，包括口头、有线或电子通信（窃听）。

• 静止数据（存储通信法）保护存储在非易失性内存上的数据。

• 收集通信元数据，如电话号码、IP 地址以及其他用于路由通信（但不是消息本身）的数据。这被称为“笔式记录器和追踪设备”，指的是用于捕获信息的实际设备和技巧。

值得指出的是最后一项法律，即经济间谍法，该法于 1996 年通过，专注于商业秘密的盗窃。在法律实施之前，很难起诉经济或企业间谍活动。然而，通过定义商业秘密并要求信息所有者采取合理措施保护秘密，现在可以刑事化知识产权的盗窃。

本节只是简要触及了可以用于起诉计算机犯罪的大量法律工作。然而，应该清楚的是，有旨在保护传输中和静止状态下的数据的法律。

除了将计算机犯罪刑事化的联邦和州法律之外，许多监管机构还管理着在涉及敏感数据的行业中运营的公司。许多规定不仅提供了公司必须遵守的具体指导方针和要求，而且还规定了民事和刑事条款，包括经济处罚，在最为严重的情况下，甚至可能涉及监禁。一些较为知名的规定包括以下内容：

• 支付卡行业数据安全标准（PCI）

• 健康保险便携性与责任法案（HIPAA）

•HITECH 法案执行暂行最终规则（对 HIPAA 的补充）

• 联邦信息安全管理法案（FISMA）

• 1974 年家庭教育权利与隐私法案（FERPA）

• 1999 年 Gramm-Leach-Bliley 金融服务现代化法案（GLBA）

•萨班斯-奥克斯利法案（SOX）

显然，美国国会认识到了数据和计算机安全的重要性，并提供了一系列法律、法规和其他资源，以促使和强制执行成功运营对商业至关重要的系统所需的安全措施。

### 开源与闭源

网络上经常活跃地讨论开源软件是否比闭源软件更安全的问题。像许多长期存在的争论一样，每一方的坚定支持者都致力于他们的结论，争论仍在继续。

认为开源软件更安全的根本原因在于，可以检查代码中的缺陷并迅速修复。这种信念中隐含着两个假设：

1. 开发人员将对开源项目进行安全代码审查。

2. 软件的维护者将迅速修补安全漏洞。

当然，如果这两个步骤都没有采取，那么开源软件显然会包含安全漏洞，而且如果没有补丁，攻击者将准确获得他们利用漏洞所需的信息。然而，如果这两个步骤都得到了执行，那么代码的安全性将在众多人士检查代码及产生的补丁的好处下得到提升。

相比之下，闭源模式依赖于一个公司开发安全代码，彻底审查其代码中的安全漏洞，修补这些漏洞，并及时将更新分发给订阅者。对于任何负责保护运行微软 Windows 平台桌面的安全的人来说，他们都非常清楚每个月第二个星期二发布的连续不断的补丁流，这被称为“补丁星期二”。微软还会在预定补丁星期二之外发布针对严重漏洞的补丁。

在一个相当高调的发现中，微软承认（微软安全公告，未标明日期），安全研究员 Tavis Ormandy 在自 1993 年以来的每个 32 位版本的 Microsoft Windows 中都发现了一个 17 岁的安全漏洞（从 Windows NT 到 Windows 7。Johnston，未标明日期）。Ormandy 在通知微软该漏洞的六个月后，于 2009 年 6 月 12 日将漏洞利用的详细信息发布到了 Full Disclosure 邮件列表中([[Full-disclosure] Microsoft，未标明日期](#BIB9))。值得注意的是，在 Ormandy 发布披露信息之后，微软才向客户发布了官方公告，并在那之后的一天内承认了这一安全漏洞。

在另一个最近的例子中，安全公司 Matta Consulting 在 Cisco System 的统一视频会议平台上发现了许多关键安全漏洞。这些漏洞使得恶意第三方能够完全控制设备，获取用户密码，并可能对目标基础设施的其他部分发起攻击(Cisco Unified Video，未标明日期)。Cisco 在其公告中承认了这些漏洞，其中硬编码的密码代表了最令人担忧的漏洞：

Linux 阴影密码文件包含三个硬编码的用户名和密码。这些密码无法更改，账户也无法删除。攻击者可以利用这些账户通过允许的远程访问协议远程访问设备。

（Cisco 安全公告，未标明日期）

最终，软件开发是一项创造性的事业，尽管尽最大的努力和意图，软件或系统很可能仍会存在缺陷。软件或系统的整体安全性直接与发现和解决缺陷的速度相关。尽管大卫·A·惠勒的“Linux 和 Unix 安全编程指南”已有八年之久（从安全的角度来看这是一段很长的时间），但它对这场辩论的概述非常出色，并代表了双方的观点。他引用了 Elias Levy（又名 Aleph One，Bugtraq 完全披露列表的版主，同时也是 SecurityFocus 的首席技术官和联合创始人）的话说：

那么，所有这一切是否意味着开源软件在安全漏洞方面并不比闭源软件好呢？不是的。开源软件确实有可能比其闭源对手更安全。但不要误以为，仅仅因为是开源就能保证安全。

(安全编程，未标明日期)

在他的 HOWTO 的最后，惠勒总结说，如果以下情况发生，开源软件可以更加安全：

如果代码先闭源后开源，它起初的安全性可能会较低，但随着时间的推移将会得到改善。

• 人们必须审阅代码。

• 审阅者和开发者必须知道如何编写安全的代码。

• 一旦发现缺陷，就必须迅速修复并分发。

最终，每个人将不得不决定他们认为开源软件还是闭源软件更安全。由于 Android 系统的很大一部分确实是开源的，因此该软件最初可能会发现许多缺陷，但随着时间的推移，它们将被解决，从而使得系统更加安全。

### 加密 NAND 闪存

通常来说，用于保护传输中数据的技术和策略比用于保护静止存储数据的技术更为成熟、经过验证且安全。数据在传输中更容易得到保护的原因是因为必须保护信息的时间是短且明确的。数据在传输完成后，保护数据的密钥可以被丢弃。相比之下，静止数据是非易失性的，且必须随时可供用户访问。这意味着解密密钥必须在设备上可用（或者用户每次都必须输入，这实际上是不切实际的），因此它们可以被攻击者访问。

受尊敬的安全技术专家、密码学家和作家布鲁斯·施奈尔总结了使用加密保护静止数据的困难：

密码学是为了保护通信而发明的：即运动中的数据。这是密码学在历史上大部分时间内的使用方式，也是世界各国的军队发展该科学的方式。Alice 是发送者，Bob 是接收者，Eve 是窃听者。即使当密码学被用于保护存储的数据——静止数据时，它也被视为一种通信形式。在我的《应用密码学》一书中，我这样描述加密存储数据：“存储的消息是某人通过时间与自己通信的一种方式。”数据存储只是数据通信的一个子集。

在现代网络中，这种差异更为深刻。通信是即时和瞬时的。加密密钥可以是短暂的，像 STU-III 电话这样的系统可以设计成在通话开始时创建加密密钥，并在通话结束后立即销毁。而数据存储则是随时间发生的。任何加密密钥都必须与加密数据一样长存。存储这些密钥变得与存储未加密数据一样重要。在某种程度上，加密并没有减少必须安全存储的秘密数量；它只是使它们变得更小。

历史上，之所以能够对存储的数据进行密钥管理，是因为密钥可以被存储在一个安全的地方：人类的大脑。人们会记住密钥，除非人们本身受到物理和情感攻击，否则不会泄露密钥。在某种意义上，这些密钥被存储在一个未连接到任何网络的“计算机”中。在那里它们是安全的。

这个整个模型在互联网上崩溃了。互联网上存储的大部分数据只是间接打算供人使用；它主要是供其他计算机使用的。问题就在这里。密钥不能再存储在人们的大脑中。它们需要存储在存储数据的同一台计算机上，或者至少是网络上。这样风险要大得多。

（Schneier on, n.d.）

其他几个平台，特别是苹果 iPhone 的后期型号，在 NAND 闪存的用户部分实施了加密。然而，在苹果 iOS 3.x 版本的情况下，由于前面提到的原因，加密很快就被突破了。截至 2011 年 3 月，iOS 4.x 的加密尚未被破解。然而，随着时间的推移，这种情况很可能会发生。

针对加密 NAND 闪存的取证策略与未加密的有所不同。如果 NAND 闪存未加密，内存可以通过芯片脱焊或 JTAG 过程物理读取，然后再解码。然而，对于加密的 NAND 闪存，这种技术将不再有效。相反，要在设备运行时提取未加密数据，这个过程在设备上执行。在取证中，这被称为活体获取，并用于其他场景，例如加密硬盘或其他存储设备内容的工作站或服务器。

加密将在保护传输中和静止状态下的数据方面发挥越来越重要的作用。然而，静止状态下的数据几乎总是容易受到攻击。在这种情况下，安全设计师必须在加密安全系统与提供很少保护的系统之间找到平衡。这种妥协将导致一个在不妨碍用户使用设备的前提下，提供合理保护静止和传输中数据的系统。

## 个体安全策略

尽管这一章的大部分内容集中在移动设备和数据安全问题上，但用户的一些做法可以最小化被破坏的风险。像以前一样，这个列表并不是打算做到面面俱到。相反，它提供了一个保护设备安全的基础。

1. 始终使用您信任的数据网络。对于移动设备来说，这可能包括您的无线运营商的数据网络或在工作、家庭或其他可信任地点的 Wi-Fi 接入点。这确保了用于传输敏感数据的网络不是恶意的，也不会被攻击者用来损害您的敏感数据。尽管运营商的网络可能被攻破，但在大型公司中的安全性要远高于小型数据网络。此外，虽然建立一个恶意的 Wi-Fi 接入点很容易，但实施恶意的蜂窝数据连接要困难得多。因此，总的来说，无线运营商提供的蜂窝数据连接降低了遭受攻击的风险。

2. 应始终在 Android 设备上设置密码，以阻止随意攻击者获取你敏感数据的访问权限。理想情况下，如果输入的密码错误次数超过设定值，Android 设备应执行用户数据的完全擦除。这样攻击者就无法通过暴力破解来破解你的密码。此外，如果可能，使用字母数字密码选项而不要使用四位数的数字 PIN 码或图案锁。字母数字密码通过允许更复杂的密码提供了更高的安全性。将设备上的密码视为类似于你电脑上的密码。很难想象（或许仅对于安全研究人员来说）会有人拥有没有密码的电脑。

3. 访问[`viaforensics.com/appwatchdog/`](http://viaforensics.com/appwatchdog/)检查免费的 appWatchdog 服务，以确定你使用的应用程序是否通过了基本的安全测试。appWatchdog 审计移动应用，以确定它们是否安全地存储了你的用户名、密码和敏感的应用数据。该网站为每个测试区域提供通过、警告或失败的检测结果以及恢复的信息详情。目前，正在开发一个可以直接安装在 Android（或 iPhone）设备上的 appWatchdog 移动应用版本，以确定已安装应用的审计状态。它还将允许用户直接联系应用开发者，请求解决审计问题以及其他通知选项。

4. 绝不要点击短信中的链接，理想情况下也应避免点击电子邮件中的链接，尤其是像 bit.ly 或 goo.gl 这样的缩短链接。根据安全公司 Trusteer 的研究，智能手机和平板电脑用户比传统 PC 和笔记本电脑用户更容易受到电子邮件网络钓鱼诈骗的影响三倍(Donohue, n.d.)。研究发现，由于屏幕尺寸较小和缺乏保护用户免受钓鱼诈骗的软件，从智能手机上识别欺诈网站更加困难。确保访问有效网站的最佳方法是手动输入，或者（或许更好的方法）允许一个可信赖的搜索引擎代表你找到网站。这样用户可以输入（或误输）公司名称，并允许搜索引擎找到适当的网站。一些搜索引擎，如谷歌，现在试图阻止恶意或受损的网站，这为智能手机用户提供了额外的保护层。

5. 考虑在你的 Android 设备上使用替代的网页浏览器。如前所述，网络犯罪分子是务实的，这就是为什么多年来他们一直专注于攻击 Microsoft Windows，而基本忽略了像 Linux 和 Mac 这样的操作系统。在移动环境中，许多捆绑的浏览器基于开源的 WebKit 项目。因此，针对 Android 和其他智能手机设备的初始网络攻击可能会集中在使用 WebKit 的浏览器上。通过使用替代浏览器，你可能会发现针对你平台的攻击少得多。然而，这可能只提供名义上和暂时的安全性提升。

6. 从 Android Market 安装应用程序时，请确保应用程序只被授予其运行所必需的权限。如果你在安装一个增强型闹钟应用，而它请求访问你的短信和网页历史数据，你不应该授予它权限。尽管这不能保护你免受所有恶意应用程序的影响，但这对于 Android 的安全来说是一个重要的层次，用户必须承担起这个责任。

随着时间的推移，这个列表不仅会增长和演变，而且希望会引入新的安全控制措施，这将有助于保护移动设备和敏感数据。

## 企业安全策略

企业通常具有比个人更复杂的安全要求，因为它们需要保护整个公司免受内部和外部攻击的影响。此外，它们可能属于受监管的行业，需要按照本章前面列出的一些指导方针进行操作。基于这些原因，需要对资产进行更细致的控制，包括移动设备。

### 政策

在企业中，移动设备管理的一个重要方面是仔细评估现有政策，并确保针对移动设备带来的新情况对它们进行更新。大多数政策没有考虑到智能手机和平板电脑以及通过它们使用可能出现的状况。尽管需要对公司政策进行全面审查，但至少有几个政策肯定需要关注。它们包括以下内容：

• 可接受的使用（对公司资源，现在包括移动设备）

• 数据安全（显然需要围绕移动设备制定政策）

• 备份和数据保留（可能会受到影响，尤其是在电子发现的角度）

虽然更新政策并不能直接通过信息技术提高安全性，但它为员工、安全架构师以及参与内部调查和纪律的人员提供了关键指导。如果你有一项过时的政策，它可能会被用来对你不利。例如，如果你的可接受使用政策只是在受保护资源的描述中简单加入了移动设备，那么所有允许公司调查他们所拥有设备的规定现在都被明确规定了。否则，在激烈的法庭斗争中，对方律师很可能会主张移动设备并未被政策覆盖，因此设备上发现的证据（例如公司机密文件）不可采纳。虽然你的法律团队可能会反驳这一论点，但简单地更新政策以包括移动设备要便宜得多且更有效。

### 密码/图案/PIN 锁

安卓设备上的密码、图案和 PIN 锁并未得到一致且有效的实施，但它们确实提供了一定程度的保护。这些功能自首次出现以来已经有所改进，并且预计随着时间的推移将继续得到改进。随着处理能力的指数级增长和成本的同步降低，使用暴力破解技术来破解保护机制变得可行且每年越来越常见。然而，如果设备丢失或被盗，这些基本保护措施对于非技术型犯罪分子是有效的。

并非所有的密码都是平等的。最有效的密码是允许或要求使用字母数字组合的密码。尽管用户输入这些密码要麻烦得多，但它大大增加了破解密码所需的努力。接下来最有效的密码是在第一部安卓设备中出现并在许多后续设备中继续使用的图案锁。图案技术引入了一种新的锁定设备的方法，因此要求用户学习新技术，从而实现了更有效的锁定。用户不得不放弃重用旧方法（如 PIN），而想出一个新图案，因此攻击者很难利用个人信息来猜测图案锁。或许因为熟悉，许多安卓设备也包含了久经考验的 PIN 锁。虽然使用 PIN 锁比不锁手机要好，但 PIN 锁可能是最容易被破解的锁。它们通常有有限的数字位数（四个是最常见的），这危险地限制了总的组合数量。此外，PIN 锁已被用于保护许多其他系统，最著名的是自动柜员机（ATM）卡。人们倾向于重复使用 PIN 码，并且基于容易发现的个人信息来设置 PIN 码。

如前一部分个人策略所建议的，密码锁应该设置一个最大尝试次数，超过该次数后设备应执行工厂重置并对用户数据分区进行完全擦除。这将防止对更容易被破解的密码（例如，四位数的 PIN 码）进行暴力破解攻击，并提供额外的安全层。

### 设备的远程擦除

企业安全经理们最希望智能手机具备的安全功能之一是远程擦除设备的能力。毫无疑问，这一功能极其重要且强大。然而，这是一个非常脆弱的功能，它给安全经理们带来的信心可能过于高估了。

远程擦除背后的基本原理是公司可以向设备发出命令，使其擦除所有数据并执行工厂重置。许多智能手机平台正在其系统中构建钩子以允许这种控制。然而，这些功能并非从一开始就设计好，目前还不足以确保高安全性。

即使远程擦除钩子存在且有效，只需使用飞行模式、移除 SIM 卡或其他类似技巧，就可以轻松阻止远程擦除命令。实际上，一些公司可能首先禁用被解雇员工的手机账户，然后发送远程擦除命令。在大多数情况下，他们可能无意中移除了远程擦除设备的能力。尽管设备不再连接到网络，但仍然可以完全访问数据。对于有 root 权限的设备所有者来说，他们也可能研究过滤此类请求，简单地忽略它们。然而，最大的问题仅仅是远程擦除功能还不够成熟。

在摩托罗拉 Droid 手机的 Android 2.1 版本中，使用微软的 Exchange ActiveSync 触发的远程擦除功能并没有导致设备擦除数据。然而，在同样的功能在 Android 2.2 版本中测试时，远程擦除确实发生了。如果你依赖远程擦除功能来保障数据安全，你需要确保该远程擦除功能在安装了每个 Android 版本的每个 Android 硬件平台上都能正常工作。不幸的是，对于大多数 IT 部门来说，这是一项艰巨的任务，因为设备分布广泛且没有一个良好的中央管理工具（关于这一点稍后会详述）。

一种相当简单的技术，可以克服远程擦除的限制，就是在设备上安装一个应用程序，如果设备在特定时间后无法与企业系统检查联系，该程序将自动擦除设备。使用这种技术（通常称为看门狗或倒计时应用程序），可以显著提高数据安全性，因为如果设备在多次尝试后仍无法连接到企业系统，它将自动擦除。因此，即使设备离线，安全管理人员也可以确保所有企业数据在特定时间框架内被擦除。当然，如果用户因正当理由长时间将手机从网络中断开，这将导致手机被擦除，因此对这一功能进行用户教育非常重要。目前，支持此功能的应用程序非常少（如果有的话）。

另外还有一种技术，针对的是 NAND 闪存上的数据。可以开发一个应用程序（实际上已经有一些存在），定期擦除设备用户数据存储分区中未使用（未分配）的空间。这样做的好处是，（大多数）删除的数据将不再可恢复，即使进行物理镜像也是如此。这种擦除可以通过让应用程序简单地写入一个充满 0xFF 的文件，直到分区填满来实现。在那时，删除文件，从而覆盖了分配的空间。当然，这样的程序可能会带来很多副作用，包括缩短 NAND 闪存的寿命，在写入文件时导致设备响应缓慢，耗尽电池，或者如果其他应用程序在分区完全填满时尝试访问分区，可能会导致这些应用程序崩溃或丢失数据。

### 升级到最新软件

尽管智能手机市场创新迅速，但企业升级核心基础设施（如 Microsoft Exchange 环境）要困难得多。然而，最后两个版本的 Microsoft Exchange 提供了增强的移动管理和安全机制。当 Exchange 升级到最新版本（目前是 Exchange 2010）时，会有更多选项来安全地管理您的设备。确保企业基础设施保持最新，不仅会提高可管理性，也会提升连接的移动设备整体的安全性。

同样，移动设备本身也应该在可用时应用更新。虽然在某些情况下可能会引入新的错误或安全漏洞，但总体而言，更新后的软件不仅会修补之前发现的缺陷，还会增加额外的管理和安全功能。上面远程擦除部分提到的例子就很好地说明了这一点，因为摩托罗拉 Droid 上的 Android 2.1 并没有正确执行远程擦除命令，而 Android 2.2 则可以。

### 远程设备管理功能

企业客户对于管理连接到其基础设施的移动设备的需求日益增长。尽管不同公司的功能列表会有所不同，但一个通用的需求列表可能包括以下内容：

• 远程配置设备

• 远程擦除设备

• 强制执行 IT 政策，如密码、加密、最低操作系统版本、升级政策、允许/禁止的应用程序等

• 远程安装/升级应用

自从 Android 2.2 开始，引入了新的设备管理应用程序编程接口（API）。它们包括应用程序整合前面提到的策略管理类型的能力。具体来说，它们支持（设备管理，n.d.）以下能力。

• 启用密码：要求设备请求 PIN 码或密码。

• 最小密码长度：设置密码所需字符数。例如，你可以要求 PIN 码或密码至少有六个字符。

• 需要字母数字密码：要求密码必须包含字母和数字的组合。可能包括符号字符。

• 最大失败密码尝试次数：指定用户在设备擦除数据前可以输入错误密码的次数。设备管理 API 还允许管理员远程将设备重置为出厂设置。这样可以在设备丢失或被盗的情况下保护数据。

• 最大不活动时间锁定：设置用户上次触摸屏幕或按下按钮后，设备锁定屏幕的时间长度。发生这种情况时，用户需要再次输入他们的 PIN 码或密码才能使用设备并访问数据。该值可以在 1 到 60 分钟之间。

• 提示用户设置新密码。

• 立即锁定设备。

• 擦除设备数据（即，将设备恢复到出厂默认状态）。

在[developer.android.com](http://developer.android.com)的设备管理页面（设备管理，n.d.），演示了此 API 的几个示例，如图 5.2 所示。

![图像](img/F100056f05-02-9781597496513.jpg)

图 5.2 设备管理 API 示例。

当用户安装一个使用新管理 API 的应用程序时，他们会看到一个“启用设备管理员”的屏幕，如图 5.3 所示。

![图像](img/F100056f05-03-9781597496513.jpg)

图 5.3 启用设备管理员。

尽管这比没有设备管理有所改进，但它远远不能满足企业客户的需求和要求。此外，尽管 API 存在，但开发者必须将它们整合到他们的应用中。

几家公司正在尝试填补全功能设备管理的空白。然而，针对智能手机的解决方案也仍然相当不成熟。投资第三方解决方案可能满足短期需求。然而，随着时间的推移，Android、制造商和设备开发者将开发更复杂的管理功能和工具。同样，许多企业设备使用微软的 Exchange ActiveSync（EAS）协议与电子邮件系统同步，这个平台的管理功能也在不断成熟。因此，如果迫切需要更好的远程设备管理以提高安全性，企业可以考虑实施第三方工具以逐步提高安全性。然而，存在这样的风险：这些工具可能无法满足或超过制造商的工具，从而使得技术和人员的投资可能不值得。

由于移动设备上的企业数据大多围绕电子邮件，因此在这个领域集中安全努力可以取得良好效果。一些公司已经认识到这一需求，并开发了自己的电子邮件客户端，这些客户端实施包括双因素认证、加密数据存储和额外的管理界面在内的一系列附加安全机制。然而，注重安全的实体应该审计这些软件，以确保它们实际上实现了所声称的功能。

显然，远程设备管理对企业客户来说非常重要，尽管这些功能的支持还不够成熟，但预计在接下来几个 Android 版本中会有显著的改进。

### 应用程序和设备审计

如果你不完全了解哪些信息处于风险之中，就很难保护移动设备和其数据。企业可以启动移动安全和风险缓解审计，以评估移动设备上暴露的数据。通过分析公司实际使用的设备和操作系统，可以确定存储了哪些数据，数据可能在哪些地方处于风险中（在设备上、传输过程中、备份中等），并创建具体的策略、程序，甚至软件实施来最小化风险。

一个典型的审计可以包括评估许多标准，包括

• 可能存储在设备上的企业数据类型

• 数据存储的位置

• 可以安装哪些其他应用程序，以及它们可以访问企业数据

• 远程擦除和设备管理的有效性/能力

• 实施企业安全策略的能力

• 密码、认证信息和其他敏感数据的安全存储和传输

• 加密的有效性

一旦支持设备被充分理解，保护静止和传输中的数据任务就不再那么令人畏惧，可以制定具体策略来最小化不可接受的风险。

与信息安全的其他领域一样，需要策略和持续的过程来维持适当的安全措施和评估风险。

## 应用开发安全策略

对于移动安全来说，一个极其重要的最后领域是开发并安装的应用程序。这不仅包括第三方应用程序，还包括操作系统开发者（在这种情况下是 Android）、设备制造商和无线运营商分发的应用程序。应用程序是用户与其移动设备交互以访问他们感兴趣信息的主要机制。通常这些信息是敏感的，并且提供了关于用户的私人细节。

### 移动应用程序安全测试

在进行取证工作的过程中发现了许多移动应用程序的安全漏洞，作者和 viaForensics 的同事们开始对流行应用程序的数据安全性进行审计，并在我们的网站上公开披露他们的发现。名为 appWatchdog 的免费公共服务的目标是提高移动应用程序数据安全性，保护消费者。随着消费者对数据安全风险意识的提高，将鼓励开发者在发布前彻底审查他们的应用程序，并达到更高的安全水平。调查结果可以在[`viaforensics.com/appwatchdog/`](http://viaforensics.com/appwatchdog/)查看。viaForensics 计划发布一个移动应用程序，该程序将检查 Android 设备上安装的应用程序，并提供已审计应用程序的 appWatchdog 结果。它还将允许消费者建议审查某个应用程序，并在有疑虑时联系应用程序开发者。

appWatchdog 服务采用取证和安全评估技术来确定用户名、密码、信用卡号码或其他应用数据是否被不安全地存储。该过程包括安装应用程序，并以消费者使用该应用的方式运行它。然后对设备进行取证成像和分析，以获取个人信息和应用数据。首先将调查结果通知应用开发者，然后公开披露，以便直接向消费者提供此信息。用户可以据此做出是否继续使用该应用的明智决定，或者等待开发者发布更安全的版本。

每个应用程序都根据特定标准进行审查，这些标准取决于应用程序的具体用途。例如，对于移动支付应用，将分析用户名、密码、应用数据和信用卡号码。然而，对于其他应用程序，信用卡号码可能并不相关。以下标准将详细解释，其中前三项最适用于大多数应用程序：

• *是否安全存储密码？* 如果设备上以任何形式未加密存储密码，该应用程序将被评为“不合格”。

• *安全存储用户名？* 检查应用程序数据以确定用户名是否未加密存储在设备上。

• *安全存储应用程序数据？* 分析每个应用程序以查找与应用相关的数据。例如，金融应用会被搜索账户号码、余额和转账信息。其他应用程序可能会存储额外的个人信息，如电子邮件地址、电话号码或地址。

• *安全存储信用卡信息？* 对于处理信用卡信息的应用程序，将检查数据以确定设备上是否未加密存储了完整的信用卡号码以及与信用卡相关的任何支持数据，如有效期或卡片背面的安全号码。

• *附加安全测试：* 这些测试可能包括捕获移动设备发送的无线数据，并检查该流量中是否包含用户名、密码、PIN 码以及其他相关的应用程序数据。附加安全测试通常更耗时，因此只在深入的应用程序安全审查中执行。

appWatchdog 服务仅提供了一种基本指示，用以判断移动应用是否实现了安全措施。通过结合先进的移动取证和安全技术，对移动应用程序进行更深入的分析是可能的。以下列出的是一些应评估的标准，用以确定移动应用程序是否安全。

• 应用程序如何处理网页历史和缓存？

• 应用程序是否安全传输登录数据？

• 应用程序是否能够避免中间人攻击？

• 应用程序是否安全传输敏感数据？

• 应用程序是否能够防止会话劫持？

• 应用程序是否能够永久删除数据并阻止在设备上存储？

• 应用程序是否安全处理中断？

• 应用程序是否在备份中正确保护数据？

彻底的应用程序安全审计利用先进的取证和安全测试来揭示安全漏洞，保护开发者和用户。viaForensics 提供这些测试服务以及一个名为 appSecure 的认证。只要内部取证和安全团队拥有工具、专业知识、预算和时间来执行测试，他们可以有效地应用类似的测试方法。

### 应用安全策略

appWatchdog 和 appSecure 的结果导致了一些移动应用开发者应该考虑的一般性指南，这些指南涉及应用的设计、开发和测试阶段。这个列表和其他列表一样，并不一定详尽无遗，但提供了一些值得考虑的重要概念。

#### 用户名

避免在设备上以明文形式存储用户名。出于明显的可用性问题，你可能会决定在设备上缓存用户名，以便消费者不必每次都输入。但是，考虑对用户名的一部分进行掩码处理，为消费者提供足够的信息以识别他们的用户名，但不足以让攻击者获得整个用户名。用户名是登录账户所需的组成部分之一，攻击者知道得越少，他们就越无效。

例如，假设有一个访问敏感健康信息的应用程序需要用户名。消费者创建了一个名为“andrewhoog”的用户名。但是，在初次登录后，如果应用程序只存储“andr∗∗∗∗”并显示给用户，那么用户可以清楚地知道他们登录的是正确的账户。然而，攻击者可能只能获取前四个字符。此外，如果掩码（在这种情况下使用“∗”，但也可以以其他方式呈现）没有透露出用户名的总长度，这将使攻击者更难以猜测。

最后，越来越多的在线服务要求更复杂的用户名，必须具有一定长度且为字母数字组合。因此，一个用户名“andrewhoog”可能相对容易猜测，而“AndrewHoog6712”则要困难得多。一些网站甚至可能对用户名施加更多限制，比如不能包含你基本资料信息（如你的名字）的任何部分。

#### 密码

也许更令人担忧的是那些将密码以明文形式存储的应用程序。有几种策略可以避免这个严重的问题。首先，如“安全哲学”一节所述，你可以简单地要求用户每次运行应用程序时都输入密码。如果你考虑从家里电脑登录银行网站的情况，每次都必须登录。虽然你可以在当前会话中保持登录状态，但在一定时间的非活动期过后（或者你登出），如果没有重新输入用户名和密码，你就无法访问受保护的网站。

另一个可以考虑的方法是使用安全令牌来避免在移动设备上存储真实密码。如果用户安全地通过互联网认证到受保护的资源，可以生成一个安全令牌，该令牌不仅会在一定时间后过期，而且仅限于该设备。尽管拥有物理访问手机的人可以访问受保护的资源，但这仅持续到令牌过期为止，届时他们需要再次输入用户名和密码。此外，如果安全令牌特定于设备并且远程受到威胁，令牌将无法访问受限资源。使用安全令牌方法的技术也不会将互联网上的任何其他受保护资源置于风险之中，即使账户持有人使用相同的用户名和密码（这是相当常见的）。

实现基于令牌的认证方案比简单的用户名和密码更为复杂，这是一种开发者不太广泛使用或理解的 方法论。然而，许多提供此功能的 API 已经可用并日趋成熟。一个名为 OAuth 的框架得到了许多 Google 服务的支持。还有其他 API，但它们往往专注于特定服务。OAuth 网站描述了与其他服务的相似性和联系：

OAuth 是许多成熟行业协议的标准化和集体智慧的结晶。它与目前使用的其他协议（如 Google AuthSub、AOL OpenAuth、Yahoo BBAuth、Upcoming API、Flickr API、Amazon Web Services API 等）相似。每种协议都提供了一种专有的方法，用于交换用户凭证以获取访问令牌或票据。OAuth 是在仔细研究这些协议后，提取最佳实践和共性，以便新实现以及现有服务平滑过渡支持 OAuth。

OAuth 比其他一些协议和服务在处理非网站服务方面更为先进。OAuth 内置了对桌面应用程序、移动设备、机顶盒以及当然还有网站的支持。今天许多协议使用硬编码在软件中的共享密钥进行通信，当尝试访问你的私人数据的服务是开源的时候，这会带来问题。

（Introduction—OAuthn, n.d.）

由于 Google 正在向 OAuth 过渡，他们提供了关于 API 以及如何使用的详细信息。在 Google Code 网站上，他们提供了以下关于 OAuth 过程的基本概述（Default, n.d.）：

1. 你的应用程序请求访问，并从 Google 的授权服务器获取一个未经授权的请求令牌。

2. Google 要求用户授权你的应用程序访问所需数据。

3. 你的应用程序从授权服务器获取一个经过授权的请求令牌。

4. 你用经过授权的请求令牌交换访问令牌。

5. 你使用访问令牌从 Google 的服务访问服务器请求数据。

如你所见，实际的用户名和密码只发送到授权服务（在本例中为 Google），并且不会存储或与请求的应用程序共享。请求的应用程序通过协商过程获得各种令牌，并需要存储最终的访问令牌，但时间和范围都是有限的。

尽管典型的 OAuth 场景允许第三方服务（例如社交媒体网站）在时间和范围限制内，基于令牌对受保护信息（例如，你的 Gmail 联系人列表）进行认证，但有趣的是指出应用开发者可以使用 OAuth 服务对自己进行认证。采用这种方法，应用开发者不仅以标准化的方式提供安全的、基于令牌的服务访问，而且现在他们拥有允许经过批准的第三方应用访问数据的基础设施，前提是账户所有者授权访问。

有许多不同的方案和技术可以用来安全地认证用户，这些用户不需要移动应用在移动设备上以明文形式存储用户名和密码。应用开发者必须转向这些更安全的方法，以更好地保护他们的客户。

#### 信用卡数据

安全行业的多数人都熟悉支付卡行业（PCI）数据安全标准（DSS），它为保护信用卡数据提供了标准。在 PCI 安全标准委员会（SSC）成立之前，主要的信用卡供应商都有自己的信用卡数据保护标准。2006 年，以下支付品牌发起了 PCI SSC：

• 美国运通

• 发现金融服务

• JCB 国际

• 万事达卡全球

• Visa 公司

这些品牌在减少支付卡行业的欺诈行为方面有着既得利益。在 2010 年 10 月发布的 2.0 版“要求和安全评估程序”文件中，列出了 PCI DSS 的具体要求。以下是一小部分要求示例，涵盖了在移动应用中使用信用卡数据的情况（文档库，未注明日期）。

• 3.2 授权后不要存储敏感认证数据（即使已加密）。敏感认证数据包括 3.2.1 至 3.2.3 要求中引用的数据。

• 3.2.1 不要存储任何磁道（位于卡片背面的磁条，芯片中包含的等效数据或其他地方）的完整内容。这些数据也可以称为全磁道、磁道、磁道 1、磁道 2 和磁条数据。

• 3.2.2 不要存储用于验证非现场交易（卡不在场交易）的卡片验证码或值（打印在支付卡正面或背面的三位数或四位数）。

• 3.2.3 不要存储个人识别号码（PIN）或加密的 PIN 块。

• 3.3 显示时遮蔽 PAN（最多显示前六位和最后四位数字）。

• 3.4.1 如果使用磁盘加密（而不是文件或列级别的数据库加密），逻辑访问必须独立于本地操作系统访问控制机制进行管理（例如，不使用本地用户账户数据库）。解密密钥不得与用户账户绑定。

尽管 PCI DSS 并非没有受到批评，但它是一个相当成熟的标准，旨在保护数量惊人的金融交易。有趣的是，可以比较 PCI DSS 随时间发展起来的某些标准，如要求加密，限制存储敏感信息，以及在屏幕显示时屏蔽敏感信息。

无需多言，在移动设备上以明文形式存储信用卡信息不仅违反了 PCI DSS 标准，而且在设备受到威胁时也会使卡主面临极大风险。或许不足为奇，上面提到的 appWatchdog 服务会检查是否以明文形式存储信用卡数据，不幸的是，在一些应用程序中发现了这些信息。

如果一个应用程序需要处理支付，建议与成熟的在线服务如 PayPal 和 Google Checkout 集成，或者与支付提供商合作实现安全的支付应用程序。请注意，这是一个重大的任务，不仅从开发和测试的角度来看是这样，还需要进行持续的安全审计过程。

#### 敏感应用程序数据

许多移动应用程序包含消费者不希望失去控制的敏感数据。数据有不同的级别。以下是一个旨在说明级别的简单列表：

1. 不含敏感用户数据——例如，计算器应用程序不包含任何敏感用户数据。

2. 不含敏感用户数据但可能包含一些元数据——例如，天气应用程序不包含任何敏感用户数据；然而，它可能包含应用程序运行时的 GPS 坐标和日期/时间戳。

3. 包含用户数据但不是敏感的——一些应用程序旨在供公众使用，如人们在 Twitter 上分享的信息。如果用户知道他或她的所有 Twitter 消息都可以被全世界阅读，大多数人（除了那些保护自己消息的人）不会感到担忧。

4. 包含敏感用户数据——许多应用程序属于这一类，包含敏感用户数据，如您的完整电子邮件消息、短信和彩信、语音邮件、通话记录等等。

5. 高度敏感的用户数据——这是一个特殊级别，涵盖包含财务信息、医疗保健信息、密码保险库以及其他如果其安全性受到威胁会使消费者面临极大风险的应用程序。

识别应用程序包含的数据敏感性有助于提供适当级别的安全保护。如果一个计算器应用程序需要双因素认证和 AES-256 加密，用户显然会感到烦恼，可能会尝试在纸上计算 15%的小费（一旦写下，它将面临多种物理和社会工程攻击的风险，但这只是题外话）。

然而，appWatchdog 服务经常发现包含第 4 和第 5 级别敏感数据的应用程序，这些数据以明文形式存储在 NAND 闪存上。如果你开发的程序包含此级别的敏感数据，你应该以某种安全级别来保护这些数据。有许多选项包括……（此处原文未提供后续内容，故无法翻译后续部分）

1. 不要存储数据——这是最简单的做法，可以缓解任何授予访问 NAND 闪存的攻击。如前所述，用于保护传输中数据的加密算法比任何保护静态数据的方法（至少在移动设备上）都更有效。大多数移动设备与互联网高度连接，因此无需缓存数据。当然，缓存数据也有其优势，包括即使设备离线也能提供访问，以及提高应用程序响应性。

2. 加密数据——如前所述，在移动设备上对静态数据进行加密需要将密钥也存储在设备上，因此它不能提供完美的安全性。然而，如果密钥足够难以找到，它提供的保护级别比明文要高得多。此外，随着针对移动设备的远程攻击增加，它们可能获得对 NAND 闪存的访问，但无法访问存储加密密钥的其他区域，如内存。如果数据是明文，它们将处于风险之中；而如果数据被加密，在这种情况下消费者将得到保护。

保护敏感数据对于保护消费者至关重要，行业必须成熟并考虑将此作为应用程序的要求。

#### SSL/TLS

最后一个需要讨论的领域是安全套接字层（SSL）和传输层安全（TLS）的实施，它们保护传输中的数据。应用程序开发人员正确实施 SSL/TLS 至关重要，包括对数字证书进行完全验证，以防止 MITM 攻击。尽管 SSL/TLS 在保护传输中的数据方面很有效，但如果没有正确实施，它会让用户面临极高的攻击风险。在为 appWatchdog 服务测试应用程序时，测试攻击机器通常会显示不在范围内的应用程序的用户名和密码，因为它会自动执行（即，一些应用程序会定期登录以检查新消息）并遭受妥协。

除了确保在移动应用程序中正确实施和验证 SSL/TLS 之外，SSL/TLS 还必须在服务器上安全配置。自 20 世纪 90 年代以来，SSL 就已经可用，用于在不可信网络上保护数据传输。早期 SSL 的实现包含了一些必须解决的安全缺陷，以确保安全传输。随着时间的推移，算法得到了改进，以降低暴力攻击的风险。这项技术的最新版本被称为 TLS，通常与 SSL 以相同的方式工作，因此许多人仍然简单地将两者都称为 SSL。

一个普遍问题是，负责在服务器上实施 SSL/TLS 的人员不一定是安全工程师，因此他们倾向于关注服务器基础设施。他们可能会实施并测试 SSL/TLS，表面上看起来很安全；但是，可能存在漏洞。例如，MD5 是一种广泛使用了超过 10 年的常见加密算法。尽管仍然被认为在文件完整性检查等应用中有用，但权威机构已将其从保护通信的使用中退役。美国国土安全部 CERT 小组在漏洞注释 #836068 中指出：“软件开发者、认证机构、网站所有者和用户应避免在任何情况下使用 MD5 算法。如先前研究所示，它应被视为在加密上已破坏，不适宜进一步使用”（US-CERT 漏洞注释 VU#836068, n.d.）。这种加密的实时破解仍然不切实际，但所有主流网页浏览器和移动设备都支持更强大的加密。

更大的问题是服务器 SSL/TLS 设置中接受 NULL 密码（无加密）或较弱的出口级加密。多年来，美国限制出口具有密码学技术的设备和软件，因此为出口软件实施了较弱的加密算法。出口密码使用只有 40 位的短密钥长度，比具有 128 或 256 位长密钥的现代密码更容易受到攻击。

SSL/TLS 使用中的另一个问题是实施的版本。TLSv1 已经有 10 多年历史，在 2009 年被发现容易受到“重新协商攻击”的攻击。在这种攻击中，服务器将客户端的初始 TLS 握手视为重新协商，因此认为攻击者最初传输的数据与后续客户端数据来自同一实体（US-CERT 漏洞注释 VU#120541, n.d.）。安全顾问 Thierry Zoller (2009 年 11 月) 提供了一个关于涉及步骤的视觉描述的很好总结。尽管解释了许多不同的攻击，但 图 5.4 是本总结中提供的第一个示例，有助于说明这种攻击。

![图像](img/F100056f05-04-9781597496513.jpg)

图 5.4 通用 TLS 重新协商前缀注入漏洞。

大多数使用 TLSv1 的服务器已经打补丁来关闭这个漏洞。然而，TLSv1 协议已经更新，更现代的 TLSv1.2 提供了最新的技术和最强的加密密码。包括 SSLv2 和 SSLv3 在内的旧规范仍然被广泛使用，并且如果使用足够的密码和密钥长度，它们可以是相当安全的，但它们不如 TLS 安全。

保护移动设备传输敏感数据需要协调、勤奋，以及对 SSL/TLS 的彻底理解，这不仅仅需要应用程序开发者的努力，还需要维护参与安全通信的服务器团队的努力。尽管 SSL/TLS 已经存在了一段时间，可能被认为是理所当然的，但重要的是，必须对系统的正确实现和彻底的安全测试进行认真对待。

## 摘要

安卓设备既可能是恶意攻击的目标，也可能被用作执行此类攻击的工具。个人用户和公司都必须意识到这些风险，并应采取一定措施来防止恶意滥用。应用程序开发者也必须更加关注安全问题，并承担保护用户数据的责任。尽管本章讨论的基本安全措施不能提供完全保护，但至少可以作为阻止大多数攻击的威慑。

## 参考文献

1\. *国家*。（未注明日期）。计算机犯罪法—计算机犯罪法指南。《computer-crime.html》于 2011 年 2 月 10 日检索自 [`www.hg.org/computer-crime.html`](http://www.hg.org/computer-crime.html)。

2\. *思科统一视频会议多个漏洞*。（未注明日期）。Matta 咨询。《MATTA-2010-001.txt》于 2011 年 2 月 11 日检索自 [www.trustmatta.com/advisories/MATTA-2010-001.txt](http://www.trustmatta.com/advisories/MATTA-2010-001.txt)。

3\. *思科安全公告：思科统一视频会议产品中存在多个漏洞—思科系统*。（未注明日期）。《products_security_advisory09186a0080》于 2011 年 2 月 10 日检索自 [`www.cisco.com/en/US/products/products_security_advisory09186a0080`](http://www.cisco.com/en/US/products/products_security_advisory09186a0080)。

4\. *默认*。（未注明日期）。为安装的应用程序提供 OAuth 认证和授权—Google APIs—Google 代码。《OAuthForInstalledApps.htm》于 2011 年 2 月 12 日检索自 [`code.google.com/apis/accounts/docs/OAuthForInstalledApps.htm`](http://code.google.com/apis/accounts/docs/OAuthForInstalledApps.htm)。

5\. *设备管理*。（未注明日期）。安卓开发者。《device-admin.html》于 2011 年 2 月 11 日检索自 [`developer.android.com/guide/topics/admin/device-admin.html`](http://developer.android.com/guide/topics/admin/device-admin.html)。

6\. Donohue, B.（未注明日期）。移动设备用户更容易受到网络钓鱼的攻击。《mobile-device-users-more-susceptible-phishing-scams-010511》于 2011 年 2 月 10 日检索自 [`threatpost.com/en_us/blogs/mobile-device-users-more-susceptible-phishing-scams-010511`](http://threatpost.com/en_us/blogs/mobile-device-users-more-susceptible-phishing-scams-010511)。

7\. *文档库*。（未注明日期）。PCI 安全标准文档：PCI DSS、PA-DSS、PED 标准、合规指南等。《documents.php?agreements=pcidss&assocation=PCI%20DSS》于 2011 年 2 月 12 日检索自 [`www.pcisecuritystandards.org/security_standards/documents.php?agreements=pcidss&assocation=PCI%20DSS`](https://www.pcisecuritystandards.org/security_standards/documents.php?agreements=pcidss&assocation=PCI%20DSS)。

*[完全披露] Microsoft Windows NT #GP 陷阱处理程序允许用户切换内核堆栈*。(未注明日期)。2011 年 2 月 10 日检索。

[OAuth 介绍](http://oauth.net/about/)。(未注明日期)。OAuth 社区网站。2011 年 2 月 12 日检索。

Johnston, S. J. (未注明日期)。微软警告一个 17 岁的 Windows 漏洞。2011 年 2 月 10 日检索。

[Microsoft 安全公告(979682)：Windows 内核中的漏洞可能允许提升权限](http://www.microsoft.com/technet/security/advisory/979682.mspx)。(未注明日期)。2011 年 2 月 10 日检索。

Ralf-Philipp Weinmann。(未注明日期)。CryptoLUX。2011 年 2 月 10 日检索。

[Schneier 谈安全：静态数据与动态数据](http://www.schneier.com/blog/archives/2010/06/data_at_rest_vs.html)。(未注明日期)。2011 年 2 月 9 日检索。

[Linux 和 Unix 安全编程 HOWTO](http://www.dwheeler.com/secure-programs/Secure-Programs-HOWTO/open-source-security.html)。(未注明日期)。David A. Wheeler 的个人主页。2011 年 2 月 10 日检索。

Ten, T. T. (未注明日期)。*梦幻之地*(1989)—难忘的台词。互联网电影数据库（IMDb）。2011 年 2 月 10 日检索。

[US-CERT 漏洞注释 VU#836068](http://www.kb.cert.org/vuls/id/836068)。(未注明日期)。CERT 知识库。2011 年 2 月 13 日检索。

[US-CERT 漏洞注释 VU#120541](http://www.kb.cert.org/vuls/id/120541)。(未注明日期)。CERT 知识库。2011 年 2 月 13 日检索。

[WordNet 搜索](http://wordnetweb.princeton.edu/perl/webwn?s=art)—3.0。(未注明日期)。2011 年 2 月 10 日检索。

Zoller T. *TLS & SSLv3 重协商漏洞解释 SANS 互联网风暴中心；合作网络安全社区—互联网安全*。2009 年；2011 年 2 月 13 日从*[`isc.sans.edu/diary.html?storyid=7582`](http://isc.sans.edu/diary.html?storyid=7582)*检索。
